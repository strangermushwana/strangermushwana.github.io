import{A as RT,B as MT,C as Mn,D as Ii,E as mh,F as ul,G as Vy,H as NT,I as PT,J as se,K as ln,L as _t,M as jy,N as kT,O as dl,P as Ee,Q as pn,R as yh,S as Uy,T as Nn,U as Ci,V as Ss,W as vh,X as OT,Y as zn,Z as Ct,a as B,b as xe,c as ET,d as Oy,e as x,f as IT,g as dh,h as CT,i as DT,j,k as Lo,l as hh,m as bT,n as TT,o as It,p as fh,q as ll,r as Fy,s as ST,t as ur,u as Ly,v as ph,w as AT,x as xT,y as gh,z as ht}from"./chunk-F2A7JWNJ.js";var FT=null;var By=1,LT=Symbol("SIGNAL");function Pe(t){let e=FT;return FT=t,e}var VT={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function WV(t){if(!(Hy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===By)){if(!t.producerMustRecompute(t)&&!$y(t)){t.dirty=!1,t.lastCleanEpoch=By;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=By}}function jT(t){return t&&(t.nextProducerIndex=0),Pe(t)}function UT(t,e){if(Pe(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Hy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)qy(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function $y(t){_h(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(WV(n),r!==n.version))return!0}return!1}function BT(t){if(_h(t),Hy(t))for(let e=0;e<t.producerNode.length;e++)qy(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function qy(t,e){if(KV(t),_h(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)qy(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];_h(i),i.producerIndexOfThis[r]=e}}function Hy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function _h(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function KV(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function QV(){throw new Error}var YV=QV;function $T(t){YV=t}function ae(t){return typeof t=="function"}function Vo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var wh=Vo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function As(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var it=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(ae(r))try{r()}catch(s){e=s instanceof wh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{qT(s)}catch(o){e=e??[],o instanceof wh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new wh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)qT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&As(n,e)}remove(e){let{_finalizers:n}=this;n&&As(n,e),e instanceof t&&e._removeParent(this)}};it.EMPTY=(()=>{let t=new it;return t.closed=!0,t})();var Gy=it.EMPTY;function Eh(t){return t instanceof it||t&&"closed"in t&&ae(t.remove)&&ae(t.add)&&ae(t.unsubscribe)}function qT(t){ae(t)?t():t.unsubscribe()}var Wn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var jo={setTimeout(t,e,...n){let{delegate:r}=jo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=jo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Ih(t){jo.setTimeout(()=>{let{onUnhandledError:e}=Wn;if(e)e(t);else throw t})}function xs(){}var HT=zy("C",void 0,void 0);function GT(t){return zy("E",void 0,t)}function zT(t){return zy("N",t,void 0)}function zy(t,e,n){return{kind:t,value:e,error:n}}var Rs=null;function Uo(t){if(Wn.useDeprecatedSynchronousErrorHandling){let e=!Rs;if(e&&(Rs={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Rs;if(Rs=null,n)throw r}}else t()}function WT(t){Wn.useDeprecatedSynchronousErrorHandling&&Rs&&(Rs.errorThrown=!0,Rs.error=t)}var Ms=class extends it{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Eh(e)&&e.add(this)):this.destination=XV}static create(e,n,r){return new zr(e,n,r)}next(e){this.isStopped?Ky(zT(e),this):this._next(e)}error(e){this.isStopped?Ky(GT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Ky(HT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},ZV=Function.prototype.bind;function Wy(t,e){return ZV.call(t,e)}var Qy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Ch(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Ch(r)}else Ch(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Ch(n)}}},zr=class extends Ms{constructor(e,n,r){super();let i;if(ae(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Wn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Wy(e.next,s),error:e.error&&Wy(e.error,s),complete:e.complete&&Wy(e.complete,s)}):i=e}this.destination=new Qy(i)}};function Ch(t){Wn.useDeprecatedSynchronousErrorHandling?WT(t):Ih(t)}function JV(t){throw t}function Ky(t,e){let{onStoppedNotification:n}=Wn;n&&jo.setTimeout(()=>n(t,e))}var XV={closed:!0,next:xs,error:JV,complete:xs};var Bo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Nt(t){return t}function Yy(...t){return Zy(t)}function Zy(t){return t.length===0?Nt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var pe=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=t2(n)?n:new zr(n,r,i);return Uo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=KT(r),new r((i,s)=>{let o=new zr({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Bo](){return this}pipe(...n){return Zy(n)(this)}toPromise(n){return n=KT(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function KT(t){var e;return(e=t??Wn.Promise)!==null&&e!==void 0?e:Promise}function e2(t){return t&&ae(t.next)&&ae(t.error)&&ae(t.complete)}function t2(t){return t&&t instanceof Ms||e2(t)&&Eh(t)}function Jy(t){return ae(t?.lift)}function le(t){return e=>{if(Jy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ce(t,e,n,r,i){return new Xy(t,e,n,r,i)}var Xy=class extends Ms{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function $o(){return le((t,e)=>{let n=null;t._refCount++;let r=ce(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var qo=class extends pe{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Jy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new it;let n=this.getSubject();e.add(this.source.subscribe(ce(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=it.EMPTY)}return e}refCount(){return $o()(this)}};var QT=Vo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ke=(()=>{class t extends pe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Dh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new QT}next(n){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){Uo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Gy:(this.currentObservers=null,s.push(n),new it(()=>{this.currentObservers=null,As(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new pe;return n.source=this,n}}return t.create=(e,n)=>new Dh(e,n),t})(),Dh=class extends Ke{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Gy}};var Pt=class extends Ke{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var hl={now(){return(hl.delegate||Date).now()},delegate:void 0};var bh=class extends Ke{constructor(e=1/0,n=1/0,r=hl){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var Th=class extends it{constructor(e,n){super()}schedule(e,n=0){return this}};var fl={setInterval(t,e,...n){let{delegate:r}=fl;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=fl;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var Ho=class extends Th{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return fl.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&fl.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,As(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Go=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Go.now=hl.now;var zo=class extends Go{constructor(e,n=Go.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Ns=new zo(Ho);var Sh=class extends Ho{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Ah=class extends zo{};var ev=new Ah(Sh);var Yt=new pe(t=>t.complete());function YT(t){return t&&ae(t.schedule)}function tv(t){return t[t.length-1]}function Wo(t){return ae(tv(t))?t.pop():void 0}function dr(t){return YT(tv(t))?t.pop():void 0}function ZT(t,e){return typeof tv(t)=="number"?t.pop():e}var xh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Rh(t){return ae(t?.then)}function Mh(t){return ae(t[Bo])}function Nh(t){return Symbol.asyncIterator&&ae(t?.[Symbol.asyncIterator])}function Ph(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function n2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var kh=n2();function Oh(t){return ae(t?.[kh])}function Fh(t){return CT(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield dh(n.read());if(i)return yield dh(void 0);yield yield dh(r)}}finally{n.releaseLock()}})}function Lh(t){return ae(t?.getReader)}function Ve(t){if(t instanceof pe)return t;if(t!=null){if(Mh(t))return r2(t);if(xh(t))return i2(t);if(Rh(t))return s2(t);if(Nh(t))return JT(t);if(Oh(t))return o2(t);if(Lh(t))return a2(t)}throw Ph(t)}function r2(t){return new pe(e=>{let n=t[Bo]();if(ae(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function i2(t){return new pe(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function s2(t){return new pe(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Ih)})}function o2(t){return new pe(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function JT(t){return new pe(e=>{c2(t,e).catch(n=>e.error(n))})}function a2(t){return JT(Fh(t))}function c2(t,e){var n,r,i,s;return IT(this,void 0,void 0,function*(){try{for(n=DT(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function un(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function Pn(t,e=0){return le((n,r)=>{n.subscribe(ce(r,i=>un(r,t,()=>r.next(i),e),()=>un(r,t,()=>r.complete(),e),i=>un(r,t,()=>r.error(i),e)))})}function Kn(t,e=0){return le((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function XT(t,e){return Ve(t).pipe(Kn(e),Pn(e))}function eS(t,e){return Ve(t).pipe(Kn(e),Pn(e))}function tS(t,e){return new pe(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function nS(t,e){return new pe(n=>{let r;return un(n,e,()=>{r=t[kh](),un(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>ae(r?.return)&&r.return()})}function Vh(t,e){if(!t)throw new Error("Iterable cannot be null");return new pe(n=>{un(n,e,()=>{let r=t[Symbol.asyncIterator]();un(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function rS(t,e){return Vh(Fh(t),e)}function iS(t,e){if(t!=null){if(Mh(t))return XT(t,e);if(xh(t))return tS(t,e);if(Rh(t))return eS(t,e);if(Nh(t))return Vh(t,e);if(Oh(t))return nS(t,e);if(Lh(t))return rS(t,e)}throw Ph(t)}function De(t,e){return e?iS(t,e):Ve(t)}function ee(...t){let e=dr(t);return De(t,e)}function Ko(t,e){let n=ae(t)?t:()=>t,r=i=>i.error(n());return new pe(e?i=>e.schedule(r,0,i):r)}function nv(t){return!!t&&(t instanceof pe||ae(t.lift)&&ae(t.subscribe))}var Wr=Vo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function J(t,e){return le((n,r)=>{let i=0;n.subscribe(ce(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:l2}=Array;function u2(t,e){return l2(e)?t(...e):t(e)}function jh(t){return J(e=>u2(t,e))}var{isArray:d2}=Array,{getPrototypeOf:h2,prototype:f2,keys:p2}=Object;function Uh(t){if(t.length===1){let e=t[0];if(d2(e))return{args:e,keys:null};if(g2(e)){let n=p2(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function g2(t){return t&&typeof t=="object"&&h2(t)===f2}function Bh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function pl(...t){let e=dr(t),n=Wo(t),{args:r,keys:i}=Uh(t);if(r.length===0)return De([],e);let s=new pe(m2(r,e,i?o=>Bh(i,o):Nt));return n?s.pipe(jh(n)):s}function m2(t,e,n=Nt){return r=>{sS(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)sS(e,()=>{let u=De(t[c],e),d=!1;u.subscribe(ce(r,h=>{s[c]=h,d||(d=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function sS(t,e,n){t?un(n,t,e):e()}function oS(t,e,n,r,i,s,o,a){let c=[],u=0,d=0,h=!1,g=()=>{h&&!c.length&&!u&&e.complete()},y=D=>u<r?E(D):c.push(D),E=D=>{s&&e.next(D),u++;let S=!1;Ve(n(D,d++)).subscribe(ce(e,k=>{i?.(k),s?y(k):e.next(k)},()=>{S=!0},void 0,()=>{if(S)try{for(u--;c.length&&u<r;){let k=c.shift();o?un(e,o,()=>E(k)):E(k)}g()}catch(k){e.error(k)}}))};return t.subscribe(ce(e,y,()=>{h=!0,g()})),()=>{a?.()}}function ft(t,e,n=1/0){return ae(e)?ft((r,i)=>J((s,o)=>e(r,s,i,o))(Ve(t(r,i))),n):(typeof e=="number"&&(n=e),le((r,i)=>oS(r,i,t,n)))}function Di(t=1/0){return ft(Nt,t)}function aS(){return Di(1)}function Qo(...t){return aS()(De(t,dr(t)))}function $h(t){return new pe(e=>{Ve(t()).subscribe(e)})}function rv(...t){let e=Wo(t),{args:n,keys:r}=Uh(t),i=new pe(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let d=0;d<o;d++){let h=!1;Ve(n[d]).subscribe(ce(s,g=>{h||(h=!0,u--),a[d]=g},()=>c--,void 0,()=>{(!c||!h)&&(u||s.next(r?Bh(r,a):a),s.complete())}))}});return e?i.pipe(jh(e)):i}function Yo(...t){let e=dr(t),n=ZT(t,1/0),r=t;return r.length?r.length===1?Ve(r[0]):Di(n)(De(r,e)):Yt}function Dt(t,e){return le((n,r)=>{let i=0;n.subscribe(ce(r,s=>t.call(e,s,i++)&&r.next(s)))})}function bi(t){return le((e,n)=>{let r=null,i=!1,s;r=e.subscribe(ce(n,void 0,void 0,o=>{s=Ve(t(o,bi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function cS(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(ce(o,d=>{let h=u++;c=a?t(c,d,h):(a=!0,d),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function Ti(t,e){return ae(e)?ft(t,e,1):ft(t,1)}function Si(t){return le((e,n)=>{let r=!1;e.subscribe(ce(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Kr(t){return t<=0?()=>Yt:le((e,n)=>{let r=0;e.subscribe(ce(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function iv(t){return J(()=>t)}function gl(t,e=Nt){return t=t??y2,le((n,r)=>{let i,s=!0;n.subscribe(ce(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function y2(t,e){return t===e}function qh(t=v2){return le((e,n)=>{let r=!1;e.subscribe(ce(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function v2(){return new Wr}function Zo(t){return le((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function gn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Dt((i,s)=>t(i,s,r)):Nt,Kr(1),n?Si(e):qh(()=>new Wr))}function Jo(t){return t<=0?()=>Yt:le((e,n)=>{let r=[];e.subscribe(ce(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function sv(t,e){let n=arguments.length>=2;return r=>r.pipe(t?Dt((i,s)=>t(i,s,r)):Nt,Jo(1),n?Si(e):qh(()=>new Wr))}function ml(){return le((t,e)=>{let n,r=!1;t.subscribe(ce(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function hr(t,e){return le(cS(t,e,arguments.length>=2,!0))}function yl(t={}){let{connector:e=()=>new Ke,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,d=!1,h=!1,g=()=>{a?.unsubscribe(),a=void 0},y=()=>{g(),o=c=void 0,d=h=!1},E=()=>{let D=o;y(),D?.unsubscribe()};return le((D,S)=>{u++,!h&&!d&&g();let k=c=c??e();S.add(()=>{u--,u===0&&!h&&!d&&(a=ov(E,i))}),k.subscribe(S),!o&&u>0&&(o=new zr({next:q=>k.next(q),error:q=>{h=!0,g(),a=ov(y,n,q),k.error(q)},complete:()=>{d=!0,g(),a=ov(y,r),k.complete()}}),Ve(D).subscribe(o))})(s)}}function ov(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new zr({next:()=>{r.unsubscribe(),t()}});return Ve(e(...n)).subscribe(r)}function Hh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,yl({connector:()=>new bh(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function av(t){return le((e,n)=>{let r=!1,i=0;e.subscribe(ce(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Ps(...t){let e=dr(t);return le((n,r)=>{(e?Qo(t,n,e):Qo(t,n)).subscribe(r)})}function ze(t,e){return le((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(ce(r,c=>{i?.unsubscribe();let u=0,d=s++;Ve(t(c,d)).subscribe(i=ce(r,h=>r.next(e?e(c,h,d,u++):h),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Gh(t,e){return ae(e)?ze(()=>t,e):ze(()=>t)}function Xo(t){return le((e,n)=>{Ve(t).subscribe(ce(n,()=>n.complete(),xs)),!n.closed&&e.subscribe(n)})}function $e(t,e,n){let r=ae(t)||e||n?{next:t,error:e,complete:n}:t;return r?le((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(ce(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):Nt}function cv(...t){let e=Wo(t);return le((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Ve(t[c]).subscribe(ce(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(Nt))&&(o=null))},xs));n.subscribe(ce(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var zS="https://g.co/ng/security#xss",re=class extends Error{constructor(e,n){super(Tf(e,n)),this.code=e}};function Tf(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function Ml(t){return{toString:t}.toString()}var zh="__parameters__";function _2(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function WS(t,e,n){return Ml(()=>{let r=_2(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,d){let h=c.hasOwnProperty(zh)?c[zh]:Object.defineProperty(c,zh,{value:[]})[zh];for(;h.length<=d;)h.push(null);return(h[d]=h[d]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var ks=globalThis;function je(t){for(let e in t)if(t[e]===je)return e;throw Error("Could not find renamed property on target object.")}function w2(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Jt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Jt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function lS(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var E2=je({__forward_ref__:je});function pa(t){return t.__forward_ref__=pa,t.toString=function(){return Jt(this())},t}function Zt(t){return KS(t)?t():t}function KS(t){return typeof t=="function"&&t.hasOwnProperty(E2)&&t.__forward_ref__===pa}function Z(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Xt(t){return{providers:t.providers||[],imports:t.imports||[]}}function Sf(t){return uS(t,YS)||uS(t,ZS)}function QS(t){return Sf(t)!==null}function uS(t,e){return t.hasOwnProperty(e)?t[e]:null}function I2(t){let e=t&&(t[YS]||t[ZS]);return e||null}function dS(t){return t&&(t.hasOwnProperty(hS)||t.hasOwnProperty(C2))?t[hS]:null}var YS=je({\u0275prov:je}),hS=je({\u0275inj:je}),ZS=je({ngInjectableDef:je}),C2=je({ngInjectorDef:je}),W=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=Z({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function JS(t){return t&&!!t.\u0275providers}var D2=je({\u0275cmp:je}),b2=je({\u0275dir:je}),T2=je({\u0275pipe:je}),S2=je({\u0275mod:je}),rf=je({\u0275fac:je}),_l=je({__NG_ELEMENT_ID__:je}),fS=je({__NG_ENV_ID__:je});function d_(t){return typeof t=="string"?t:t==null?"":String(t)}function A2(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():d_(t)}function x2(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new re(-200,t)}function h_(t,e){throw new re(-201,!1)}var _e=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(_e||{}),Tv;function XS(){return Tv}function kn(t){let e=Tv;return Tv=t,e}function eA(t,e,n){let r=Sf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&_e.Optional)return null;if(e!==void 0)return e;h_(t,"Injector")}var R2={},wl=R2,Sv="__NG_DI_FLAG__",sf="ngTempTokenPath",M2="ngTokenPath",N2=/\n/gm,P2="\u0275",pS="__source",ia;function k2(){return ia}function Ai(t){let e=ia;return ia=t,e}function O2(t,e=_e.Default){if(ia===void 0)throw new re(-203,!1);return ia===null?eA(t,void 0,e):ia.get(t,e&_e.Optional?null:void 0,e)}function L(t,e=_e.Default){return(XS()||O2)(Zt(t),e)}function U(t,e=_e.Default){return L(t,Af(e))}function Af(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Av(t){let e=[];for(let n=0;n<t.length;n++){let r=Zt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new re(900,!1);let i,s=_e.Default;for(let o=0;o<r.length;o++){let a=r[o],c=F2(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(L(i,s))}else e.push(L(r))}return e}function tA(t,e){return t[Sv]=e,t.prototype[Sv]=e,t}function F2(t){return t[Sv]}function L2(t,e,n,r){let i=t[sf];throw e[pS]&&i.unshift(e[pS]),t.message=V2(`
`+t.message,i,n,r),t[M2]=i,t[sf]=null,t}function V2(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==P2?t.slice(2):t;let i=Jt(e);if(Array.isArray(e))i=e.map(Jt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Jt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(N2,`
  `)}`}var Nl=tA(WS("Optional"),8);var nA=tA(WS("SkipSelf"),4);function oa(t,e){let n=t.hasOwnProperty(rf);return n?t[rf]:null}function f_(t,e){t.forEach(n=>Array.isArray(n)?f_(n,e):e(n))}function rA(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function of(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function j2(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function U2(t,e,n){let r=Pl(t,e);return r>=0?t[r|1]=n:(r=~r,j2(t,r,e,n)),r}function lv(t,e){let n=Pl(t,e);if(n>=0)return t[n|1]}function Pl(t,e){return B2(t,e,1)}function B2(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var aa={},mn=[],Fs=new W(""),iA=new W("",-1),sA=new W(""),af=class{get(e,n=wl){if(n===wl){let r=new Error(`NullInjectorError: No provider for ${Jt(e)}!`);throw r.name="NullInjectorError",r}return n}},oA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(oA||{}),gr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(gr||{}),kt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(kt||{});function $2(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function xv(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];q2(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function aA(t){return t===3||t===4||t===6}function q2(t){return t.charCodeAt(0)===64}function El(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?gS(t,n,i,null,e[++r]):gS(t,n,i,null,null))}}return t}function gS(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var cA="ng-template";function H2(t,e,n,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&$2(e[i+1].toLowerCase(),n,0)!==-1)return!0}else if(p_(t))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===n)return!0}return!1}function p_(t){return t.type===4&&t.value!==cA}function G2(t,e,n){let r=t.type===4&&!n?cA:t.value;return e===r}function z2(t,e,n){let r=4,i=t.attrs,s=i!==null?Q2(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!Qn(r)&&!Qn(c))return!1;if(o&&Qn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!G2(t,c,n)||c===""&&e.length===1){if(Qn(r))return!1;o=!0}}else if(r&8){if(i===null||!H2(t,i,c,n)){if(Qn(r))return!1;o=!0}}else{let u=e[++a],d=W2(c,i,p_(t),n);if(d===-1){if(Qn(r))return!1;o=!0;continue}if(u!==""){let h;if(d>s?h="":h=i[d+1].toLowerCase(),r&2&&u!==h){if(Qn(r))return!1;o=!0}}}}return Qn(r)||o}function Qn(t){return(t&1)===0}function W2(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return Y2(e,t)}function K2(t,e,n=!1){for(let r=0;r<e.length;r++)if(z2(t,e[r],n))return!0;return!1}function Q2(t){for(let e=0;e<t.length;e++){let n=t[e];if(aA(n))return e}return t.length}function Y2(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function mS(t,e){return t?":not("+e.trim()+")":e}function Z2(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!Qn(o)&&(e+=mS(s,i),i=""),r=o,s=s||!Qn(r);n++}return i!==""&&(e+=mS(s,i)),e}function J2(t){return t.map(Z2).join(",")}function X2(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!Qn(i))break;i=s}r++}return{attrs:e,classes:n}}function qt(t){return Ml(()=>{let e=fA(t),n=xe(B({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===oA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||gr.Emulated,styles:t.styles||mn,_:null,schemas:t.schemas||null,tView:null,id:""});pA(n);let r=t.dependencies;return n.directiveDefs=vS(r,!1),n.pipeDefs=vS(r,!0),n.id=nj(n),n})}function ej(t){return Ri(t)||lA(t)}function tj(t){return t!==null}function en(t){return Ml(()=>({type:t.type,bootstrap:t.bootstrap||mn,declarations:t.declarations||mn,imports:t.imports||mn,exports:t.exports||mn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function yS(t,e){if(t==null)return aa;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=kt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==kt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function tn(t){return Ml(()=>{let e=fA(t);return pA(e),e})}function Ri(t){return t[D2]||null}function lA(t){return t[b2]||null}function uA(t){return t[T2]||null}function dA(t){let e=Ri(t)||lA(t)||uA(t);return e!==null?e.standalone:!1}function hA(t,e){let n=t[S2]||null;if(!n&&e===!0)throw new Error(`Type ${Jt(t)} does not have '\u0275mod' property.`);return n}function fA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||aa,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||mn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:yS(t.inputs,e),outputs:yS(t.outputs),debugInfo:null}}function pA(t){t.features?.forEach(e=>e(t))}function vS(t,e){if(!t)return null;let n=e?uA:ej;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(tj)}function nj(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function qs(t){return{\u0275providers:t}}function g_(...t){return{\u0275providers:gA(!0,t),\u0275fromNgModule:!0}}function gA(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return f_(e,o=>{let a=o;Rv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&mA(i,s),n}function mA(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];m_(i,s=>{e(s,r)})}}function Rv(t,e,n,r){if(t=Zt(t),!t)return!1;let i=null,s=dS(t),o=!s&&Ri(t);if(!s&&!o){let c=t.ngModule;if(s=dS(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)Rv(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{f_(s.imports,d=>{Rv(d,e,n,r)&&(u||=[],u.push(d))})}finally{}u!==void 0&&mA(u,e)}if(!a){let u=oa(i)||(()=>new i);e({provide:i,useFactory:u,deps:mn},i),e({provide:sA,useValue:i,multi:!0},i),e({provide:Fs,useValue:()=>L(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;m_(c,d=>{e(d,u)})}}else return!1;return i!==t&&t.providers!==void 0}function m_(t,e){for(let n of t)JS(n)&&(n=n.\u0275providers),Array.isArray(n)?m_(n,e):e(n)}var rj=je({provide:String,useValue:je});function yA(t){return t!==null&&typeof t=="object"&&rj in t}function ij(t){return!!(t&&t.useExisting)}function sj(t){return!!(t&&t.useFactory)}function ca(t){return typeof t=="function"}function oj(t){return!!t.useClass}var xf=new W(""),Jh={},aj={},uv;function y_(){return uv===void 0&&(uv=new af),uv}var dn=class{},Il=class extends dn{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Nv(e,o=>this.processProvider(o)),this.records.set(iA,ea(void 0,this)),i.has("environment")&&this.records.set(dn,ea(void 0,this));let s=this.records.get(xf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(sA,mn,_e.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Pe(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Pe(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Ai(this),r=kn(void 0),i;try{return e()}finally{Ai(n),kn(r)}}get(e,n=wl,r=_e.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(fS))return e[fS](this);r=Af(r);let i,s=Ai(this),o=kn(void 0);try{if(!(r&_e.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=hj(e)&&Sf(e);u&&this.injectableDefInScope(u)?c=ea(Mv(e),Jh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&_e.Self?y_():this.parent;return n=r&_e.Optional&&n===wl?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[sf]=a[sf]||[]).unshift(Jt(e)),s)throw a;return L2(a,e,"R3InjectorError",this.source)}else throw a}finally{kn(o),Ai(s)}}resolveInjectorInitializers(){let e=Pe(null),n=Ai(this),r=kn(void 0),i;try{let s=this.get(Fs,mn,_e.Self);for(let o of s)o()}finally{Ai(n),kn(r),Pe(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Jt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new re(205,!1)}processProvider(e){e=Zt(e);let n=ca(e)?e:Zt(e&&e.provide),r=lj(e);if(!ca(e)&&e.multi===!0){let i=this.records.get(n);i||(i=ea(void 0,Jh,!0),i.factory=()=>Av(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Pe(null);try{return n.value===Jh&&(n.value=aj,n.value=n.factory()),typeof n.value=="object"&&n.value&&dj(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Pe(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Zt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Mv(t){let e=Sf(t),n=e!==null?e.factory:oa(t);if(n!==null)return n;if(t instanceof W)throw new re(204,!1);if(t instanceof Function)return cj(t);throw new re(204,!1)}function cj(t){if(t.length>0)throw new re(204,!1);let n=I2(t);return n!==null?()=>n.factory(t):()=>new t}function lj(t){if(yA(t))return ea(void 0,t.useValue);{let e=vA(t);return ea(e,Jh)}}function vA(t,e,n){let r;if(ca(t)){let i=Zt(t);return oa(i)||Mv(i)}else if(yA(t))r=()=>Zt(t.useValue);else if(sj(t))r=()=>t.useFactory(...Av(t.deps||[]));else if(ij(t))r=()=>L(Zt(t.useExisting));else{let i=Zt(t&&(t.useClass||t.provide));if(uj(t))r=()=>new i(...Av(t.deps));else return oa(i)||Mv(i)}return r}function ea(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function uj(t){return!!t.deps}function dj(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function hj(t){return typeof t=="function"||typeof t=="object"&&t instanceof W}function Nv(t,e){for(let n of t)Array.isArray(n)?Nv(n,e):n&&JS(n)?Nv(n.\u0275providers,e):e(n)}function yr(t,e){t instanceof Il&&t.assertNotDestroyed();let n,r=Ai(t),i=kn(void 0);try{return e()}finally{Ai(r),kn(i)}}function _A(){return XS()!==void 0||k2()!=null}function fj(t){if(!_A())throw new re(-203,!1)}function pj(t){return typeof t=="function"}var vn=0,Ie=1,oe=2,Ot=3,Yn=4,tr=5,Zn=6,Cl=7,Jn=8,la=9,Xn=10,tt=11,Dl=12,_S=13,ga=14,On=15,Rf=16,ta=17,ua=18,Mf=19,wA=20,xi=21,dv=22,Ls=23,_n=25,EA=1,bl=6,Yr=7,cf=8,lf=9,yn=10,v_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(v_||{});function Qr(t){return Array.isArray(t)&&typeof t[EA]=="object"}function vr(t){return Array.isArray(t)&&t[EA]===!0}function IA(t){return(t.flags&4)!==0}function kl(t){return t.componentOffset>-1}function __(t){return(t.flags&1)===1}function Mi(t){return!!t.template}function CA(t){return(t[oe]&512)!==0}var Pv=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function DA(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Pi(){return bA}function bA(t){return t.type.prototype.ngOnChanges&&(t.setInput=mj),gj}Pi.ngInherit=!0;function gj(){let t=SA(this),e=t?.current;if(e){let n=t.previous;if(n===aa)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function mj(t,e,n,r,i){let s=this.declaredInputs[r],o=SA(t)||yj(t,{previous:aa,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new Pv(u&&u.currentValue,n,c===aa),DA(t,e,i,n)}var TA="__ngSimpleChanges__";function SA(t){return t[TA]||null}function yj(t,e){return t[TA]=e}var wS=null;var fr=function(t,e,n){wS?.(t,e,n)},AA="svg",vj="math",_j=!1;function wj(){return _j}function er(t){for(;Array.isArray(t);)t=t[vn];return t}function Ej(t,e){return er(e[t])}function wn(t,e){return er(e[t.index])}function xA(t,e){return t.data[e]}function ki(t,e){let n=e[t];return Qr(n)?n:n[vn]}function w_(t){return(t[oe]&128)===128}function Ij(t){return vr(t[Ot])}function uf(t,e){return e==null?null:t[e]}function RA(t){t[ta]=0}function Cj(t){t[oe]&1024||(t[oe]|=1024,w_(t)&&Tl(t))}function Dj(t,e){for(;t>0;)e=e[ga],t--;return e}function E_(t){return!!(t[oe]&9216||t[Ls]?.dirty)}function kv(t){t[Xn].changeDetectionScheduler?.notify(1),E_(t)?Tl(t):t[oe]&64&&(wj()?(t[oe]|=1024,Tl(t)):t[Xn].changeDetectionScheduler?.notify())}function Tl(t){t[Xn].changeDetectionScheduler?.notify();let e=Sl(t);for(;e!==null&&!(e[oe]&8192||(e[oe]|=8192,!w_(e)));)e=Sl(e)}function MA(t,e){if((t[oe]&256)===256)throw new re(911,!1);t[xi]===null&&(t[xi]=[]),t[xi].push(e)}function bj(t,e){if(t[xi]===null)return;let n=t[xi].indexOf(e);n!==-1&&t[xi].splice(n,1)}function Sl(t){let e=t[Ot];return vr(e)?e[Ot]:e}var ge={lFrame:$A(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Tj(){return ge.lFrame.elementDepthCount}function Sj(){ge.lFrame.elementDepthCount++}function Aj(){ge.lFrame.elementDepthCount--}function NA(){return ge.bindingsEnabled}function Ol(){return ge.skipHydrationRootTNode!==null}function xj(t){return ge.skipHydrationRootTNode===t}function Rj(t){ge.skipHydrationRootTNode=t}function Mj(){ge.skipHydrationRootTNode=null}function Qe(){return ge.lFrame.lView}function nr(){return ge.lFrame.tView}function PA(t){return ge.lFrame.contextLView=t,t[Jn]}function kA(t){return ge.lFrame.contextLView=null,t}function En(){let t=OA();for(;t!==null&&t.type===64;)t=t.parent;return t}function OA(){return ge.lFrame.currentTNode}function Nj(){let t=ge.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Fl(t,e){let n=ge.lFrame;n.currentTNode=t,n.isParent=e}function FA(){return ge.lFrame.isParent}function Pj(){ge.lFrame.isParent=!1}function LA(){let t=ge.lFrame,e=t.bindingRootIndex;return e===-1&&(e=t.bindingRootIndex=t.tView.bindingStartIndex),e}function kj(t){return ge.lFrame.bindingIndex=t}function VA(){return ge.lFrame.bindingIndex++}function Oj(t){let e=ge.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function Fj(){return ge.lFrame.inI18n}function Lj(t,e){let n=ge.lFrame;n.bindingIndex=n.bindingRootIndex=t,Ov(e)}function Vj(){return ge.lFrame.currentDirectiveIndex}function Ov(t){ge.lFrame.currentDirectiveIndex=t}function jj(t){let e=ge.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function jA(t){ge.lFrame.currentQueryIndex=t}function Uj(t){let e=t[Ie];return e.type===2?e.declTNode:e.type===1?t[tr]:null}function UA(t,e,n){if(n&_e.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&_e.Host);)if(i=Uj(s),i===null||(s=s[ga],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=ge.lFrame=BA();return r.currentTNode=e,r.lView=t,!0}function I_(t){let e=BA(),n=t[Ie];ge.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function BA(){let t=ge.lFrame,e=t===null?null:t.child;return e===null?$A(t):e}function $A(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function qA(){let t=ge.lFrame;return ge.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var HA=qA;function C_(){let t=qA();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Bj(t){return(ge.lFrame.contextLView=Dj(t,ge.lFrame.contextLView))[Jn]}function Ll(){return ge.lFrame.selectedIndex}function Vs(t){ge.lFrame.selectedIndex=t}function GA(){let t=ge.lFrame;return xA(t.tView,t.selectedIndex)}function _r(){ge.lFrame.currentNamespace=AA}function wr(){$j()}function $j(){ge.lFrame.currentNamespace=null}function zA(){return ge.lFrame.currentNamespace}var WA=!0;function D_(){return WA}function Er(t){WA=t}function qj(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=bA(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function b_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:d}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),d!=null&&(t.destroyHooks??=[]).push(n,d)}}function Xh(t,e,n){KA(t,e,3,n)}function ef(t,e,n,r){(t[oe]&3)===n&&KA(t,e,n,r)}function hv(t,e){let n=t[oe];(n&3)===e&&(n&=16383,n+=1,t[oe]=n)}function KA(t,e,n,r){let i=r!==void 0?t[ta]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[ta]+=65536),(a<s||s==-1)&&(Hj(t,n,e,c),t[ta]=(t[ta]&4294901760)+c+2),c++}function ES(t,e){fr(4,t,e);let n=Pe(null);try{e.call(t)}finally{Pe(n),fr(5,t,e)}}function Hj(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[oe]>>14<t[ta]>>16&&(t[oe]&3)===e&&(t[oe]+=16384,ES(a,s)):ES(a,s)}var sa=-1,js=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function Gj(t){return t instanceof js}function zj(t){return(t.flags&8)!==0}function Wj(t){return(t.flags&16)!==0}function QA(t){return t!==sa}function df(t){return t&32767}function Kj(t){return t>>16}function hf(t,e){let n=Kj(t),r=e;for(;n>0;)r=r[ga],n--;return r}var Fv=!0;function IS(t){let e=Fv;return Fv=t,e}var Qj=256,YA=Qj-1,ZA=5,Yj=0,pr={};function Zj(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(_l)&&(r=n[_l]),r==null&&(r=n[_l]=Yj++);let i=r&YA,s=1<<i;e.data[t+(i>>ZA)]|=s}function ff(t,e){let n=JA(t,e);if(n!==-1)return n;let r=e[Ie];r.firstCreatePass&&(t.injectorIndex=e.length,fv(r.data,t),fv(e,null),fv(r.blueprint,null));let i=T_(t,e),s=t.injectorIndex;if(QA(i)){let o=df(i),a=hf(i,e),c=a[Ie].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function fv(t,e){t.push(0,0,0,0,0,0,0,0,e)}function JA(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function T_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=rx(i),r===null)return sa;if(n++,i=i[ga],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return sa}function Lv(t,e,n){Zj(t,e,n)}function Jj(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(aA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function XA(t,e,n){if(n&_e.Optional||t!==void 0)return t;h_(e,"NodeInjector")}function ex(t,e,n,r){if(n&_e.Optional&&r===void 0&&(r=null),!(n&(_e.Self|_e.Host))){let i=t[la],s=kn(void 0);try{return i?i.get(e,r,n&_e.Optional):eA(e,r,n&_e.Optional)}finally{kn(s)}}return XA(r,e,n)}function tx(t,e,n,r=_e.Default,i){if(t!==null){if(e[oe]&2048&&!(r&_e.Self)){let o=rU(t,e,n,r,pr);if(o!==pr)return o}let s=nx(t,e,n,r,pr);if(s!==pr)return s}return ex(e,n,r,i)}function nx(t,e,n,r,i){let s=tU(n);if(typeof s=="function"){if(!UA(e,t,r))return r&_e.Host?XA(i,n,r):ex(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&_e.Optional))h_(n);else return o}finally{HA()}}else if(typeof s=="number"){let o=null,a=JA(t,e),c=sa,u=r&_e.Host?e[On][tr]:null;for((a===-1||r&_e.SkipSelf)&&(c=a===-1?T_(t,e):e[a+8],c===sa||!DS(r,!1)?a=-1:(o=e[Ie],a=df(c),e=hf(c,e)));a!==-1;){let d=e[Ie];if(CS(s,a,d.data)){let h=Xj(a,e,n,o,r,u);if(h!==pr)return h}c=e[a+8],c!==sa&&DS(r,e[Ie].data[a+8]===u)&&CS(s,a,e)?(o=d,a=df(c),e=hf(c,e)):a=-1}}return i}function Xj(t,e,n,r,i,s){let o=e[Ie],a=o.data[t+8],c=r==null?kl(a)&&Fv:r!=o&&(a.type&3)!==0,u=i&_e.Host&&s===a,d=eU(a,o,n,c,u);return d!==null?da(e,o,d,a):pr}function eU(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,d=s>>20,h=r?a:a+d,g=i?a+d:u;for(let y=h;y<g;y++){let E=o[y];if(y<c&&n===E||y>=c&&E.type===n)return y}if(i){let y=o[c];if(y&&Mi(y)&&y.type===n)return c}return null}function da(t,e,n,r){let i=t[n],s=e.data;if(Gj(i)){let o=i;o.resolving&&x2(A2(s[n]));let a=IS(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?kn(o.injectImpl):null,d=UA(t,r,_e.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&qj(n,s[n],e)}finally{u!==null&&kn(u),IS(a),o.resolving=!1,HA()}}return i}function tU(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(_l)?t[_l]:void 0;return typeof e=="number"?e>=0?e&YA:nU:e}function CS(t,e,n){let r=1<<t;return!!(n[e+(t>>ZA)]&r)}function DS(t,e){return!(t&_e.Self)&&!(t&_e.Host&&e)}var Os=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return tx(this._tNode,this._lView,e,Af(r),n)}};function nU(){return new Os(En(),Qe())}function Vl(t){return Ml(()=>{let e=t.prototype.constructor,n=e[rf]||Vv(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[rf]||Vv(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Vv(t){return KS(t)?()=>{let e=Vv(Zt(t));return e&&e()}:oa(t)}function rU(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[oe]&2048&&!(o[oe]&512);){let a=nx(s,o,n,r|_e.Self,pr);if(a!==pr)return a;let c=s.parent;if(!c){let u=o[wA];if(u){let d=u.get(n,pr,r);if(d!==pr)return d}c=rx(o),o=o[ga]}s=c}return i}function rx(t){let e=t[Ie],n=e.type;return n===2?e.declTNode:n===1?t[tr]:null}function S_(t){return Jj(En(),t)}function bS(t,e=null,n=null,r){let i=ix(t,e,n,r);return i.resolveInjectorInitializers(),i}function ix(t,e=null,n=null,r,i=new Set){let s=[n||mn,g_(t)];return r=r||(typeof t=="object"?void 0:Jt(t)),new Il(s,e||y_(),r||null,i)}var Ir=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return bS({name:""},i,r,"");{let s=r.name??"";return bS({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=wl,e.NULL=new af,e.\u0275prov=Z({token:e,providedIn:"any",factory:()=>L(iA)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var iU="ngOriginalError";function pv(t){return t[iU]}var mr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&pv(e);for(;n&&pv(n);)n=pv(n);return n||null}},sx=new W("",{providedIn:"root",factory:()=>U(mr).handleError.bind(void 0)}),A_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=sU,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),jv=class extends A_{constructor(e){super(),this._lView=e}onDestroy(e){return MA(this._lView,e),()=>bj(this._lView,e)}};function sU(){return new jv(Qe())}function oU(){return Nf(En(),Qe())}function Nf(t,e){return new Xr(wn(t,e))}var Xr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=oU;let t=e;return t})();var Uv=class extends Ke{constructor(e=!1){super(),this.destroyRef=void 0,this.__isAsync=e,_A()&&(this.destroyRef=U(A_,{optional:!0})??void 0)}emit(e){let n=Pe(null);try{super.next(e)}finally{Pe(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=gv(s),i&&(i=gv(i)),o&&(o=gv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof it&&e.add(a),a}};function gv(t){return e=>{setTimeout(t,void 0,e)}}var $t=Uv;var aU="ngSkipHydration",cU="ngskiphydration";function ox(t){let e=t.mergedAttrs;if(e===null)return!1;for(let n=0;n<e.length;n+=2){let r=e[n];if(typeof r=="number")return!1;if(typeof r=="string"&&r.toLowerCase()===cU)return!0}return!1}function ax(t){return t.hasAttribute(aU)}function pf(t){return(t.flags&128)===128}function lU(t){if(pf(t))return!0;let e=t.parent;for(;e;){if(pf(t)||ox(e))return!0;e=e.parent}return!1}var cx=new Map,uU=0;function dU(){return uU++}function hU(t){cx.set(t[Mf],t)}function fU(t){cx.delete(t[Mf])}var TS="__ngContext__";function Us(t,e){Qr(e)?(t[TS]=e[Mf],hU(e)):t[TS]=e}function lx(t){return dx(t[Dl])}function ux(t){return dx(t[Yn])}function dx(t){for(;t!==null&&!vr(t);)t=t[Yn];return t}var Bv;function hx(t){Bv=t}function Pf(){if(Bv!==void 0)return Bv;if(typeof document<"u")return document;throw new re(210,!1)}var kf=new W("",{providedIn:"root",factory:()=>pU}),pU="ng",x_=new W(""),st=new W("",{providedIn:"platform",factory:()=>"unknown"});var R_=new W("",{providedIn:"root",factory:()=>Pf().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function gU(){let t=new Hs;return U(st)==="browser"&&(t.store=mU(Pf(),U(kf))),t}var Hs=(()=>{let e=class e{constructor(){this.store={},this.onSerializeCallbacks={}}get(r,i){return this.store[r]!==void 0?this.store[r]:i}set(r,i){this.store[r]=i}remove(r){delete this.store[r]}hasKey(r){return this.store.hasOwnProperty(r)}get isEmpty(){return Object.keys(this.store).length===0}onSerialize(r,i){this.onSerializeCallbacks[r]=i}toJson(){for(let r in this.onSerializeCallbacks)if(this.onSerializeCallbacks.hasOwnProperty(r))try{this.store[r]=this.onSerializeCallbacks[r]()}catch(i){console.warn("Exception in onSerialize callback: ",i)}return JSON.stringify(this.store).replace(/</g,"\\u003C")}};e.\u0275prov=Z({token:e,providedIn:"root",factory:gU});let t=e;return t})();function mU(t,e){let n=t.getElementById(e+"-state");if(n?.textContent)try{return JSON.parse(n.textContent)}catch(r){console.warn("Exception while restoring TransferState for app "+e,r)}return{}}var fx="h",px="b",$v=function(t){return t.FirstChild="f",t.NextSibling="n",t}($v||{}),yU="e",vU="t",M_="c",gx="x",gf="r",_U="i",wU="n",EU="d",IU="__nghData__",mx=IU,mv="ngh",CU="nghm",yx=()=>null;function DU(t,e,n=!1){let r=t.getAttribute(mv);if(r==null)return null;let[i,s]=r.split("|");if(r=n?s:i,!r)return null;let o=s?`|${s}`:"",a=n?i:o,c={};if(r!==""){let d=e.get(Hs,null,{optional:!0});d!==null&&(c=d.get(mx,[])[Number(r)])}let u={data:c,firstChild:t.firstChild??null};return n&&(u.firstChild=t,Of(u,0,t.nextSibling)),a?t.setAttribute(mv,a):t.removeAttribute(mv),u}function bU(){yx=DU}function N_(t,e,n=!1){return yx(t,e,n)}function TU(t){let e=t._lView;return e[Ie].type===2?null:(CA(e)&&(e=e[_n]),e)}function SU(t){return t.textContent?.replace(/\s/gm,"")}function AU(t){let e=Pf(),n=e.createNodeIterator(t,NodeFilter.SHOW_COMMENT,{acceptNode(s){let o=SU(s);return o==="ngetn"||o==="ngtns"?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),r,i=[];for(;r=n.nextNode();)i.push(r);for(let s of i)s.textContent==="ngetn"?s.replaceWith(e.createTextNode("")):s.remove()}function Of(t,e,n){t.segmentHeads??={},t.segmentHeads[e]=n}function qv(t,e){return t.segmentHeads?.[e]??null}function xU(t,e){let n=t.data,r=n[yU]?.[e]??null;return r===null&&n[M_]?.[e]&&(r=P_(t,e)),r}function vx(t,e){return t.data[M_]?.[e]??null}function P_(t,e){let n=vx(t,e)??[],r=0;for(let i of n)r+=i[gf]*(i[gx]??1);return r}function Ff(t,e){if(typeof t.disconnectedNodes>"u"){let n=t.data[EU];t.disconnectedNodes=n?new Set(n):null}return!!t.disconnectedNodes?.has(e)}var Wh=new W(""),_x=!1,wx=new W("",{providedIn:"root",factory:()=>_x}),RU=new W("");var Kh;function MU(){if(Kh===void 0&&(Kh=null,ks.trustedTypes))try{Kh=ks.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Kh}function SS(t){return MU()?.createScriptURL(t)||t}var mf=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${zS})`}};function jl(t){return t instanceof mf?t.changingThisBreaksApplicationSecurity:t}function k_(t,e){let n=NU(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${zS})`)}return n===e}function NU(t){return t instanceof mf&&t.getTypeName()||null}var PU=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Ex(t){return t=String(t),t.match(PU)?t:"unsafe:"+t}var Lf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Lf||{});function kU(t){let e=Cx();return e?e.sanitize(Lf.URL,t)||"":k_(t,"URL")?jl(t):Ex(d_(t))}function OU(t){let e=Cx();if(e)return SS(e.sanitize(Lf.RESOURCE_URL,t)||"");if(k_(t,"ResourceURL"))return SS(jl(t));throw new re(904,!1)}function FU(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?OU:kU}function Ix(t,e,n){return FU(e,n)(t)}function Cx(){let t=Qe();return t&&t[Xn].sanitizer}var LU=/^>|^->|<!--|-->|--!>|<!-$/g,VU=/(<|>)/g,jU="\u200B$1\u200B";function UU(t){return t.replace(LU,e=>e.replace(VU,jU))}function BU(t){return t.ownerDocument.body}function Dx(t){return t instanceof Function?t():t}function vl(t){return(t??U(Ir)).get(st)==="browser"}var Zr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Zr||{}),$U;function O_(t,e){return $U(t,e)}function na(t,e,n,r,i){if(r!=null){let s,o=!1;vr(r)?s=r:Qr(r)&&(o=!0,r=r[vn]);let a=er(r);t===0&&n!==null?i==null?Ax(e,n,a):yf(e,n,a,i||null,!0):t===1&&n!==null?yf(e,n,a,i||null,!0):t===2?U_(e,a,o):t===3&&e.destroyNode(a),s!=null&&iB(e,t,s,n,i)}}function F_(t,e){return t.createText(e)}function L_(t,e){return t.createComment(UU(e))}function Vf(t,e,n){return t.createElement(e,n)}function qU(t,e){bx(t,e),e[vn]=null,e[tr]=null}function HU(t,e,n,r,i,s){r[vn]=i,r[tr]=e,jf(t,r,n,1,i,s)}function bx(t,e){e[Xn].changeDetectionScheduler?.notify(1),jf(t,e,e[tt],2,null,null)}function GU(t){let e=t[Dl];if(!e)return yv(t[Ie],t);for(;e;){let n=null;if(Qr(e))n=e[Dl];else{let r=e[yn];r&&(n=r)}if(!n){for(;e&&!e[Yn]&&e!==t;)Qr(e)&&yv(e[Ie],e),e=e[Ot];e===null&&(e=t),Qr(e)&&yv(e[Ie],e),n=e&&e[Yn]}e=n}}function zU(t,e,n,r){let i=yn+r,s=n.length;r>0&&(n[i-1][Yn]=e),r<s-yn?(e[Yn]=n[i],rA(n,yn+r,e)):(n.push(e),e[Yn]=null),e[Ot]=n;let o=e[Rf];o!==null&&n!==o&&WU(o,e);let a=e[ua];a!==null&&a.insertView(t),kv(e),e[oe]|=128}function WU(t,e){let n=t[lf],i=e[Ot][Ot][On];e[On]!==i&&(t[oe]|=v_.HasTransplantedViews),n===null?t[lf]=[e]:n.push(e)}function Tx(t,e){let n=t[lf],r=n.indexOf(e);n.splice(r,1)}function Hv(t,e){if(t.length<=yn)return;let n=yn+e,r=t[n];if(r){let i=r[Rf];i!==null&&i!==t&&Tx(i,r),e>0&&(t[n-1][Yn]=r[Yn]);let s=of(t,yn+e);qU(r[Ie],r);let o=s[ua];o!==null&&o.detachView(s[Ie]),r[Ot]=null,r[Yn]=null,r[oe]&=-129}return r}function Sx(t,e){if(!(e[oe]&256)){let n=e[tt];n.destroyNode&&jf(t,e,n,3,null,null),GU(e)}}function yv(t,e){if(e[oe]&256)return;let n=Pe(null);try{e[oe]&=-129,e[oe]|=256,e[Ls]&&BT(e[Ls]),QU(t,e),KU(t,e),e[Ie].type===1&&e[tt].destroy();let r=e[Rf];if(r!==null&&vr(e[Ot])){r!==e[Ot]&&Tx(r,e);let i=e[ua];i!==null&&i.detachView(t)}fU(e)}finally{Pe(n)}}function KU(t,e){let n=t.cleanup,r=e[Cl];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Cl]=null);let i=e[xi];if(i!==null){e[xi]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function QU(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof js)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];fr(4,a,c);try{c.call(a)}finally{fr(5,a,c)}}else{fr(4,i,s);try{s.call(i)}finally{fr(5,i,s)}}}}}function YU(t,e,n){return ZU(t,e.parent,n)}function ZU(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[vn];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===gr.None||s===gr.Emulated)return null}return wn(r,n)}}function yf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function Ax(t,e,n){t.appendChild(e,n)}function AS(t,e,n,r,i){r!==null?yf(t,e,n,r,i):Ax(t,e,n)}function JU(t,e,n,r){t.removeChild(e,n,r)}function V_(t,e){return t.parentNode(e)}function XU(t,e){return t.nextSibling(e)}function eB(t,e,n){return nB(t,e,n)}function tB(t,e,n){return t.type&40?wn(t,n):null}var nB=tB,xS;function j_(t,e,n,r){let i=YU(t,r,e),s=e[tt],o=r.parent||e[tr],a=eB(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)AS(s,i,n[c],a,!1);else AS(s,i,n,a,!1);xS!==void 0&&xS(s,r,e,n,i)}function tf(t,e){if(e!==null){let n=e.type;if(n&3)return wn(e,t);if(n&4)return Gv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return tf(t,r);{let i=t[e.index];return vr(i)?Gv(-1,i):er(i)}}else{if(n&32)return O_(e,t)()||er(t[e.index]);{let r=xx(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Sl(t[On]);return tf(i,r)}else return tf(t,e.next)}}}return null}function xx(t,e){if(e!==null){let r=t[On][tr],i=e.projection;return r.projection[i]}return null}function Gv(t,e){let n=yn+t+1;if(n<e.length){let r=e[n],i=r[Ie].firstChild;if(i!==null)return tf(r,i)}return e[Yr]}function U_(t,e,n){let r=V_(t,e);r&&JU(t,r,e,n)}function Rx(t){t.textContent=""}function B_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Us(er(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)B_(t,e,n.child,r,i,s,!1),na(e,t,i,a,s);else if(c&32){let u=O_(n,r),d;for(;d=u();)na(e,t,i,d,s);na(e,t,i,a,s)}else c&16?rB(t,e,r,n,i,s):na(e,t,i,a,s);n=o?n.projectionNext:n.next}}function jf(t,e,n,r,i,s){B_(n,r,t.firstChild,e,i,s,!1)}function rB(t,e,n,r,i,s){let o=n[On],c=o[tr].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let d=c[u];na(e,t,i,d,s)}else{let u=c,d=o[Ot];pf(r)&&(u.flags|=128),B_(t,e,u,d,i,s,!0)}}function iB(t,e,n,r,i){let s=n[Yr],o=er(n);s!==o&&na(e,t,r,s,i);for(let a=yn;a<n.length;a++){let c=n[a];jf(c[Ie],c,t,e,r,s)}}function sB(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Zr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Zr.Important),t.setStyle(n,r,i,s))}}function oB(t,e,n){t.setAttribute(e,"style",n)}function Mx(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function Nx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&xv(t,e,r),i!==null&&Mx(t,e,i),s!==null&&oB(t,e,s)}var ma={};function wt(t=1){Px(nr(),Qe(),Ll()+t,!1)}function Px(t,e,n,r){if(!r)if((e[oe]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Xh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&ef(e,s,0,n)}Vs(n)}function me(t,e=_e.Default){let n=Qe();if(n===null)return L(t,e);let r=En();return tx(r,n,Zt(t),e)}function kx(){let t="invalid";throw new Error(t)}function Ox(t,e,n,r,i,s){let o=Pe(null);try{let a=null;i&kt.SignalBased&&(a=e[r][LT]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&kt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):DA(e,a,r,s)}finally{Pe(o)}}function aB(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)Vs(~i);else{let s=i,o=n[++r],a=n[++r];Lj(o,s);let c=e[s];a(2,c)}}}finally{Vs(-1)}}function Uf(t,e,n,r,i,s,o,a,c,u,d){let h=e.blueprint.slice();return h[vn]=i,h[oe]=r|4|128|8|64,(u!==null||t&&t[oe]&2048)&&(h[oe]|=2048),RA(h),h[Ot]=h[ga]=t,h[Jn]=n,h[Xn]=o||t&&t[Xn],h[tt]=a||t&&t[tt],h[la]=c||t&&t[la]||null,h[tr]=s,h[Mf]=dU(),h[Zn]=d,h[wA]=u,h[On]=e.type==2?t[On]:h,h}function Bf(t,e,n,r,i){let s=t.data[e];if(s===null)s=cB(t,e,n,r,i),Fj()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=Nj();s.injectorIndex=o===null?-1:o.injectorIndex}return Fl(s,!0),s}function cB(t,e,n,r,i){let s=OA(),o=FA(),a=o?s:s&&s.parent,c=t.data[e]=pB(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function Fx(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function Lx(t,e,n,r,i){let s=Ll(),o=r&2;try{Vs(-1),o&&e.length>_n&&Px(t,e,_n,!1),fr(o?2:0,i),n(r,i)}finally{Vs(s),fr(o?3:1,i)}}function Vx(t,e,n){if(IA(e)){let r=Pe(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{Pe(r)}}}function jx(t,e,n){NA()&&(EB(t,e,n,wn(n,e)),(n.flags&64)===64&&Gx(t,e,n))}function Ux(t,e,n=wn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function Bx(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=$_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function $_(t,e,n,r,i,s,o,a,c,u,d){let h=_n+r,g=h+i,y=lB(h,g),E=typeof u=="function"?u():u;return y[Ie]={type:t,blueprint:y,template:n,queries:null,viewQuery:a,declTNode:e,data:y.slice().fill(null,h),bindingStartIndex:h,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:E,incompleteFirstPass:!1,ssrId:d}}function lB(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:ma);return n}function uB(t,e,n,r){let s=r.get(wx,_x)||n===gr.ShadowDom,o=t.selectRootElement(e,s);return dB(o),o}function dB(t){$x(t)}var $x=()=>null;function hB(t){ax(t)?Rx(t):AU(t)}function fB(){$x=hB}function pB(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Ol()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function RS(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=kt.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?MS(r,n,u,a,c):MS(r,n,u,a)}return r}function MS(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function gB(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let d=r;d<i;d++){let h=s[d],g=n?n.get(h):null,y=g?g.inputs:null,E=g?g.outputs:null;c=RS(0,h.inputs,d,c,y),u=RS(1,h.outputs,d,u,E);let D=c!==null&&o!==null&&!p_(e)?NB(c,d,o):null;a.push(D)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function mB(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function yB(t,e,n,r,i,s,o,a){let c=wn(e,n),u=e.inputs,d;!a&&u!=null&&(d=u[r])?(q_(t,n,d,r,i),kl(e)&&vB(n,e.index)):e.type&3?(r=mB(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function vB(t,e){let n=ki(e,t);n[oe]&16||(n[oe]|=64)}function qx(t,e,n,r){if(NA()){let i=r===null?null:{"":-1},s=CB(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&Hx(t,e,n,o,i,a),i&&DB(n,r,i)}n.mergedAttrs=El(n.mergedAttrs,n.attrs)}function Hx(t,e,n,r,i,s){for(let u=0;u<r.length;u++)Lv(ff(n,e),t,r[u].type);TB(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let d=r[u];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,c=Fx(t,e,r.length,null);for(let u=0;u<r.length;u++){let d=r[u];n.mergedAttrs=El(n.mergedAttrs,d.hostAttrs),SB(t,n,e,c,d),bB(c,d,i),d.contentQueries!==null&&(n.flags|=4),(d.hostBindings!==null||d.hostAttrs!==null||d.hostVars!==0)&&(n.flags|=64);let h=d.type.prototype;!o&&(h.ngOnChanges||h.ngOnInit||h.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(h.ngOnChanges||h.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}gB(t,n,s)}function _B(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;wB(o)!=a&&o.push(a),o.push(n,r,s)}}function wB(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function EB(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;kl(n)&&AB(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||ff(n,e),Us(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=da(e,t,a,n);if(Us(u,e),o!==null&&MB(e,a-i,u,c,n,o),Mi(c)){let d=ki(n.index,e);d[Jn]=da(e,t,a,n)}}}function Gx(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=Vj();try{Vs(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];Ov(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&IB(c,u)}}finally{Vs(-1),Ov(o)}}function IB(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function CB(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(K2(e,o.selectors,!1))if(r||(r=[]),Mi(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;zv(t,e,c)}else r.unshift(o),zv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function zv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function DB(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new re(-301,!1);r.push(e[i],s)}}}function bB(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Mi(e)&&(n[""]=t)}}function TB(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function SB(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=oa(i.type,!0)),o=new js(s,Mi(i),me);t.blueprint[r]=o,n[r]=o,_B(t,e,r,Fx(t,n,i.hostVars,ma),i)}function AB(t,e,n){let r=wn(e,t),i=Bx(n),s=t[Xn].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=$f(t,Uf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function xB(t,e,n,r,i,s){let o=wn(t,e);RB(e[tt],o,s,t.value,n,r,i)}function RB(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?d_(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function MB(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],d=o[a++],h=o[a++];Ox(r,n,c,u,d,h)}}function NB(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function zx(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function Wx(t,e){let n=t.contentQueries;if(n!==null){let r=Pe(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];jA(s),a.contentQueries(2,e[o],o)}}}finally{Pe(r)}}}function $f(t,e){return t[Dl]?t[_S][Yn]=e:t[Dl]=e,t[_S]=e,e}function Wv(t,e,n){jA(0);let r=Pe(null);try{e(t,n)}finally{Pe(r)}}function PB(t){return t[Cl]||(t[Cl]=[])}function kB(t){return t.cleanup||(t.cleanup=[])}function Kx(t,e){let n=t[la],r=n?n.get(mr,null):null;r&&r.handleError(e)}function q_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],d=t.data[o];Ox(d,u,r,a,c,i)}}function OB(t,e){let n=ki(e,t),r=n[Ie];FB(r,n);let i=n[vn];i!==null&&n[Zn]===null&&(n[Zn]=N_(i,n[la])),H_(r,n,n[Jn])}function FB(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function H_(t,e,n){I_(e);try{let r=t.viewQuery;r!==null&&Wv(1,r,n);let i=t.template;i!==null&&Lx(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[ua]?.finishViewCreation(t),t.staticContentQueries&&Wx(t,e),t.staticViewQueries&&Wv(2,t.viewQuery,n);let s=t.components;s!==null&&LB(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[oe]&=-5,C_()}}function LB(t,e){for(let n=0;n<e.length;n++)OB(t,e[n])}function VB(t,e,n,r){let i=Pe(null);try{let s=e.tView,a=t[oe]&4096?4096:16,c=Uf(t,s,n,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),u=t[e.index];c[Rf]=u;let d=t[ua];return d!==null&&(c[ua]=d.createEmbeddedView(s)),H_(s,c,n),c}finally{Pe(i)}}function NS(t,e){return!e||e.firstChild===null||pf(t)}function jB(t,e,n,r=!0){let i=e[Ie];if(zU(i,e,t,n),r){let o=Gv(n,t),a=e[tt],c=V_(a,t[Yr]);c!==null&&HU(i,t[tr],a,e,c,o)}let s=e[Zn];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function vf(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(er(s)),vr(s)&&UB(s,r);let o=n.type;if(o&8)vf(t,e,n.child,r);else if(o&32){let a=O_(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=xx(e,n);if(Array.isArray(a))r.push(...a);else{let c=Sl(e[On]);vf(c[Ie],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function UB(t,e){for(let n=yn;n<t.length;n++){let r=t[n],i=r[Ie].firstChild;i!==null&&vf(r[Ie],r,i,e)}t[Yr]!==t[vn]&&e.push(t[Yr])}var Qx=[];function BB(t){return t[Ls]??$B(t)}function $B(t){let e=Qx.pop()??Object.create(HB);return e.lView=t,e}function qB(t){t.lView[Ls]!==t&&(t.lView=null,Qx.push(t))}var HB=xe(B({},VT),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Tl(t.lView)},consumerOnSignalRead(){this.lView[Ls]=this}}),Yx=100;function Zx(t,e=!0,n=0){let r=t[Xn],i=r.rendererFactory,s=!1;s||i.begin?.();try{GB(t,n)}catch(o){throw e&&Kx(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function GB(t,e){Kv(t,e);let n=0;for(;E_(t);){if(n===Yx)throw new re(103,!1);n++,Kv(t,1)}}function zB(t,e,n,r){let i=e[oe];if((i&256)===256)return;let s=!1;!s&&e[Xn].inlineEffectRunner?.flush(),I_(e);let o=null,a=null;!s&&WB(t)&&(a=BB(e),o=jT(a));try{RA(e),kj(t.bindingStartIndex),n!==null&&Lx(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let h=t.preOrderCheckHooks;h!==null&&Xh(e,h,null)}else{let h=t.preOrderHooks;h!==null&&ef(e,h,0,null),hv(e,0)}if(KB(e),Jx(e,0),t.contentQueries!==null&&Wx(t,e),!s)if(c){let h=t.contentCheckHooks;h!==null&&Xh(e,h)}else{let h=t.contentHooks;h!==null&&ef(e,h,1),hv(e,1)}aB(t,e);let u=t.components;u!==null&&eR(e,u,0);let d=t.viewQuery;if(d!==null&&Wv(2,d,r),!s)if(c){let h=t.viewCheckHooks;h!==null&&Xh(e,h)}else{let h=t.viewHooks;h!==null&&ef(e,h,2),hv(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[dv]){for(let h of e[dv])h();e[dv]=null}s||(e[oe]&=-73)}catch(c){throw Tl(e),c}finally{a!==null&&(UT(a,o),qB(a)),C_()}}function WB(t){return t.type!==2}function Jx(t,e){for(let n=lx(t);n!==null;n=ux(n))for(let r=yn;r<n.length;r++){let i=n[r];Xx(i,e)}}function KB(t){for(let e=lx(t);e!==null;e=ux(e)){if(!(e[oe]&v_.HasTransplantedViews))continue;let n=e[lf];for(let r=0;r<n.length;r++){let i=n[r],s=i[Ot];Cj(i)}}}function QB(t,e,n){let r=ki(e,t);Xx(r,n)}function Xx(t,e){w_(t)&&Kv(t,e)}function Kv(t,e){let r=t[Ie],i=t[oe],s=t[Ls],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&$y(s)),s&&(s.dirty=!1),t[oe]&=-9217,o)zB(r,t,r.template,t[Jn]);else if(i&8192){Jx(t,1);let a=r.components;a!==null&&eR(t,a,1)}}function eR(t,e,n){for(let r=0;r<e.length;r++)QB(t,e[r],n)}function G_(t){for(t[Xn].changeDetectionScheduler?.notify();t;){t[oe]|=64;let e=Sl(t);if(CA(t)&&!e)return t;t=e}return null}var Bs=class{get rootNodes(){let e=this._lView,n=e[Ie];return vf(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Jn]}set context(e){this._lView[Jn]=e}get destroyed(){return(this._lView[oe]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Ot];if(vr(e)){let n=e[cf],r=n?n.indexOf(this):-1;r>-1&&(Hv(e,r),of(n,r))}this._attachedToViewContainer=!1}Sx(this._lView[Ie],this._lView)}onDestroy(e){MA(this._lView,e)}markForCheck(){G_(this._cdRefInjectingView||this._lView)}detach(){this._lView[oe]&=-129}reattach(){kv(this._lView),this._lView[oe]|=128}detectChanges(){this._lView[oe]|=1024,Zx(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new re(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,bx(this._lView[Ie],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new re(902,!1);this._appRef=e,kv(this._lView)}},z_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=JB;let t=e;return t})(),YB=z_,ZB=class extends YB{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=VB(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:n,dehydratedView:r});return new Bs(i)}};function JB(){return XB(En(),Qe())}function XB(t,e){return t.type&4?new ZB(e,t,Nf(t,e)):null}function tR(t){let e=t[bl]??[],r=t[Ot][tt];for(let i of e)e$(i,r);t[bl]=mn}function e$(t,e){let n=0,r=t.firstChild;if(r){let i=t.data[gf];for(;n<i;){let s=r.nextSibling;U_(e,r,!1),r=s,n++}}}function nR(t){tR(t);for(let e=yn;e<t.length;e++)_f(t[e])}function t$(t){let e=t[Zn]?.i18nNodes;if(e){let n=t[tt];for(let r of e.values())U_(n,r,!1);t[Zn].i18nNodes=void 0}}function _f(t){t$(t);let e=t[Ie];for(let n=_n;n<e.bindingStartIndex;n++)if(vr(t[n])){let r=t[n];nR(r)}else Qr(t[n])&&_f(t[n])}function n$(t){let e=t._views;for(let n of e){let r=TU(n);if(r!==null&&r[vn]!==null)if(Qr(r))_f(r);else{let i=r[vn];_f(i),nR(r)}}}var r$=new RegExp(`^(\\d+)*(${px}|${fx})*(.*)`);function i$(t){let e=t.match(r$),[n,r,i,s]=e,o=r?parseInt(r,10):i,a=[];for(let[c,u,d]of s.matchAll(/(f|n)(\d*)/g)){let h=parseInt(d,10)||1;a.push(u,h)}return[o,...a]}function s$(t){return!t.prev&&t.parent?.type===8}function vv(t){return t.index-_n}function o$(t,e){let n=t.i18nNodes;if(n){let r=n.get(e);return r&&n.delete(e),r}return null}function qf(t,e,n,r){let i=vv(r),s=o$(t,i);if(!s){let o=t.data[wU];if(o?.[i])s=c$(o[i],n);else if(e.firstChild===r)s=t.firstChild;else{let a=r.prev===null,c=r.prev??r.parent;if(s$(r)){let u=vv(r.parent);s=qv(t,u)}else{let u=wn(c,n);if(a)s=u.firstChild;else{let d=vv(c),h=qv(t,d);if(c.type===2&&h){let y=P_(t,d)+1;s=Hf(y,h)}else s=u.nextSibling}}}}return s}function Hf(t,e){let n=e;for(let r=0;r<t;r++)n=n.nextSibling;return n}function a$(t,e){let n=t;for(let r=0;r<e.length;r+=2){let i=e[r],s=e[r+1];for(let o=0;o<s;o++)switch(i){case $v.FirstChild:n=n.firstChild;break;case $v.NextSibling:n=n.nextSibling;break}}return n}function c$(t,e){let[n,...r]=i$(t),i;if(n===fx)i=e[On][vn];else if(n===px)i=BU(e[On][vn]);else{let s=Number(n);i=er(e[s+_n])}return a$(i,r)}function l$(t,e){let n=[];for(let r of e)for(let i=0;i<(r[gx]??1);i++){let s={data:r,firstChild:null};r[gf]>0&&(s.firstChild=t,t=Hf(r[gf],t)),n.push(s)}return[t,n]}var rR=()=>null;function u$(t,e){let n=t[bl];return!e||n===null||n.length===0?null:n[0].data[_U]===e?n.shift():(tR(t),null)}function d$(){rR=u$}function PS(t,e){return rR(t,e)}var wf=class{},Qv=class{},Ef=class{};function h$(t){let e=Error(`No component factory found for ${Jt(t)}.`);return e[f$]=t,e}var f$="ngComponent";var Yv=class{resolveComponentFactory(e){throw h$(e)}},Gf=(()=>{let e=class e{};e.NULL=new Yv;let t=e;return t})(),Al=class{},Oi=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>p$();let t=e;return t})();function p$(){let t=Qe(),e=En(),n=ki(e.index,t);return(Qr(n)?n:t)[tt]}var g$=(()=>{let e=class e{};e.\u0275prov=Z({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),_v={};var kS=new Set;function ya(t){kS.has(t)||(kS.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function OS(...t){}function m$(){let t=typeof ks.requestAnimationFrame=="function",e=ks[t?"requestAnimationFrame":"setTimeout"],n=ks[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var be=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $t(!1),this.onMicrotaskEmpty=new $t(!1),this.onStable=new $t(!1),this.onError=new $t(!1),typeof Zone>"u")throw new re(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=m$().nativeRequestAnimationFrame,_$(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new re(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new re(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,y$,OS,OS);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},y$={};function W_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function v$(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ks,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Zv(t),t.isCheckStableRunning=!0,W_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Zv(t))}function _$(t){let e=()=>{v$(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(w$(a))return n.invokeTask(i,s,o,a);try{return FS(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),LS(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return FS(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),LS(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Zv(t),W_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Zv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function FS(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function LS(t){t._nesting--,W_(t)}function w$(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}var ra=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(ra||{}),E$={destroy(){}};function zf(t,e){!e&&fj(zf);let n=e?.injector??U(Ir);if(!vl(n))return E$;ya("NgAfterNextRender");let r=n.get(K_),i=r.handler??=new Xv,s=e?.phase??ra.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(A_).onDestroy(o),c=yr(n,()=>new Jv(s,()=>{o(),t()}));return i.register(c),{destroy:o}}var Jv=class{constructor(e,n){this.phase=e,this.callbackFn=n,this.zone=U(be),this.errorHandler=U(mr,{optional:!0}),U(wf,{optional:!0})?.notify(1)}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Xv=class{constructor(){this.executingCallbacks=!1,this.buckets={[ra.EarlyRead]:new Set,[ra.Write]:new Set,[ra.MixedReadWrite]:new Set,[ra.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},K_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=Z({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function e_(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=lS(i,a);else if(s==2){let c=a,u=e[++o];r=lS(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var If=class extends Gf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Ri(e);return new ha(n,this.ngModule)}};function VS(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function I$(t){let e=t.toLowerCase();return e==="svg"?AA:e==="math"?vj:null}var t_=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Af(r);let i=this.injector.get(e,_v,r);return i!==_v||n===_v?i:this.parentInjector.get(e,n,r)}},ha=class extends Ef{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=VS(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return VS(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=J2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=Pe(null);try{i=i||this.ngModule;let o=i instanceof dn?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new t_(e,o):e,c=a.get(Al,null);if(c===null)throw new re(407,!1);let u=a.get(g$,null),d=a.get(K_,null),h=a.get(wf,null),g={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:d,changeDetectionScheduler:h},y=c.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",D=r?uB(y,r,this.componentDef.encapsulation,a):Vf(y,E,I$(E)),S=512;this.componentDef.signals?S|=4096:this.componentDef.onPush||(S|=16);let k=null;D!==null&&(k=N_(D,a,!0));let q=$_(0,null,null,1,0,null,null,null,null,null,null),F=Uf(null,q,null,S,null,null,g,y,a,null,k);I_(F);let Y,ie;try{let ne=this.componentDef,I,v=null;ne.findHostDirectiveDefs?(I=[],v=new Map,ne.findHostDirectiveDefs(ne,I,v),I.push(ne)):I=[ne];let w=C$(F,D),C=D$(w,D,ne,I,F,g,y);ie=xA(q,_n),D&&S$(y,ne,D,r),n!==void 0&&A$(ie,this.ngContentSelectors,n),Y=T$(C,ne,I,v,F,[x$]),H_(q,F,null)}finally{C_()}return new n_(this.componentType,Y,Nf(ie,F),F,ie)}finally{Pe(s)}}},n_=class extends Qv{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Bs(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;q_(s[Ie],s,i,e,n),this.previousInputValues.set(e,n);let o=ki(this._tNode.index,s);G_(o)}}get injector(){return new Os(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function C$(t,e){let n=t[Ie],r=_n;return t[r]=e,Bf(n,r,2,"#host",null)}function D$(t,e,n,r,i,s,o){let a=i[Ie];b$(r,t,e,o);let c=null;e!==null&&(c=N_(e,i[la]));let u=s.rendererFactory.createRenderer(e,n),d=16;n.signals?d=4096:n.onPush&&(d=64);let h=Uf(i,Bx(n),null,d,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&zv(a,t,r.length-1),$f(i,h),i[t.index]=h}function b$(t,e,n,r){for(let i of t)e.mergedAttrs=El(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(e_(e,e.mergedAttrs,!0),n!==null&&Nx(r,n,e))}function T$(t,e,n,r,i,s){let o=En(),a=i[Ie],c=wn(o,i);Hx(a,i,o,n,null,r);for(let d=0;d<n.length;d++){let h=o.directiveStart+d,g=da(i,a,h,o);Us(g,i)}Gx(a,i,o),c&&Us(c,i);let u=da(i,a,o.directiveStart+o.componentOffset,o);if(t[Jn]=i[Jn]=u,s!==null)for(let d of s)d(u,e);return Vx(a,o,i),u}function S$(t,e,n,r){if(r)xv(t,n,["ng-version","17.3.10"]);else{let{attrs:i,classes:s}=X2(e.selectors[0]);i&&xv(t,n,i),s&&s.length>0&&Mx(t,n,s.join(" "))}}function A$(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function x$(){let t=En();b_(Qe()[Ie],t)}var Ul=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=R$;let t=e;return t})();function R$(){let t=En();return N$(t,Qe())}var M$=Ul,iR=class extends M${constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Nf(this._hostTNode,this._hostLView)}get injector(){return new Os(this._hostTNode,this._hostLView)}get parentInjector(){let e=T_(this._hostTNode,this._hostLView);if(QA(e)){let n=hf(e,this._hostLView),r=df(e),i=n[Ie].data[r+8];return new Os(i,n)}else return new Os(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=jS(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-yn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=PS(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,NS(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!pj(e),a;if(o)a=n;else{let E=n||{};a=E.index,r=E.injector,i=E.projectableNodes,s=E.environmentInjector||E.ngModuleRef}let c=o?e:new ha(Ri(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let D=(o?u:this.parentInjector).get(dn,null);D&&(s=D)}let d=Ri(c.componentType??{}),h=PS(this._lContainer,d?.id??null),g=h?.firstChild??null,y=c.create(u,i,g,s);return this.insertImpl(y.hostView,a,NS(this._hostTNode,h)),y}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(Ij(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[Ot],u=new iR(c,c[tr],c[Ot]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return jB(o,i,s,r),e.attachToViewContainerRef(),rA(wv(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=jS(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Hv(this._lContainer,n);r&&(of(wv(this._lContainer),n),Sx(r[Ie],r))}detach(e){let n=this._adjustIndex(e,-1),r=Hv(this._lContainer,n);return r&&of(wv(this._lContainer),n)!=null?new Bs(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function jS(t){return t[cf]}function wv(t){return t[cf]||(t[cf]=[])}function N$(t,e){let n,r=e[t.index];return vr(r)?n=r:(n=zx(r,e,null,t),e[t.index]=n,$f(e,n)),sR(n,e,t,r),new iR(n,t,e)}function P$(t,e){let n=t[tt],r=n.createComment(""),i=wn(e,t),s=V_(n,i);return yf(n,s,r,XU(n,i),!1),r}var sR=oR,Q_=()=>!1;function k$(t,e,n){return Q_(t,e,n)}function oR(t,e,n,r){if(t[Yr])return;let i;n.type&8?i=er(r):i=P$(e,n),t[Yr]=i}function O$(t,e,n){if(t[Yr]&&t[bl])return!0;let r=n[Zn],i=e.index-_n;if(!r||lU(e)||Ff(r,i))return!1;let o=qv(r,i),a=r.data[M_]?.[i],[c,u]=l$(o,a);return t[Yr]=c,t[bl]=u,!0}function F$(t,e,n,r){Q_(t,n,e)||oR(t,e,n,r)}function L$(){sR=F$,Q_=O$}function V$(t){return Object.getPrototypeOf(t.prototype).constructor}function Fi(t){let e=V$(t.type),n=!0,r=[t];for(;e;){let i;if(Mi(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new re(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Qh(t.inputs),o.inputTransforms=Qh(t.inputTransforms),o.declaredInputs=Qh(t.declaredInputs),o.outputs=Qh(t.outputs);let a=i.hostBindings;a&&q$(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&B$(t,c),u&&$$(t,u),j$(t,i),w2(t.outputs,i.outputs),Mi(i)&&i.data.animation){let d=t.data;d.animation=(d.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Fi&&(n=!1)}}e=Object.getPrototypeOf(e)}U$(r)}function j$(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function U$(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=El(i.hostAttrs,n=El(n,i.hostAttrs))}}function Qh(t){return t===aa?{}:t===mn?[]:t}function B$(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function $$(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function q$(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function Y_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ni=class{},xl=class{};var r_=class extends Ni{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new If(this);let i=hA(e);this._bootstrapComponents=Dx(i.bootstrap),this._r3Injector=ix(e,n,[{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver},...r],Jt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},i_=class extends xl{constructor(e){super(),this.moduleType=e}create(e){return new r_(this.moduleType,e,[])}};var Cf=class extends Ni{constructor(e){super(),this.componentFactoryResolver=new If(this),this.instance=null;let n=new Il([...e.providers,{provide:Ni,useValue:this},{provide:Gf,useValue:this.componentFactoryResolver}],e.parent||y_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Wf(t,e,n=null){return new Cf({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Bl=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Pt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function aR(t,e,n){return t[e]=n}function H$(t,e){return t[e]}function Kf(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function $l(t){return(t.flags&32)===32}function G$(t,e,n,r,i,s,o,a,c){let u=e.consts,d=Bf(e,t,4,o||null,uf(u,a));qx(e,n,d,uf(u,c)),b_(e,d);let h=d.tView=$_(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,d),h.queries=e.queries.embeddedTView(d)),d}function va(t,e,n,r,i,s,o,a){let c=Qe(),u=nr(),d=t+_n,h=u.firstCreatePass?G$(d,u,c,e,n,r,i,s,o):u.data[d];Fl(h,!1);let g=cR(u,c,h,t);D_()&&j_(u,c,g,h),Us(g,c);let y=zx(g,c,g,h);return c[d]=y,$f(c,y),k$(y,h,c),__(h)&&jx(u,c,h),o!=null&&Ux(c,h,a),va}var cR=lR;function lR(t,e,n,r){return Er(!0),e[tt].createComment("")}function z$(t,e,n,r){let i=e[Zn],s=!i||Ol()||$l(n)||Ff(i,r);if(Er(s),s)return lR(t,e,n,r);let o=i.data[vU]?.[r]??null;o!==null&&n.tView!==null&&n.tView.ssrId===null&&(n.tView.ssrId=o);let a=qf(i,t,e,n);Of(i,r,a);let c=P_(i,r);return Hf(c,a)}function W$(){cR=z$}function Qf(t,e,n,r){let i=Qe(),s=VA();if(Kf(i,s,e)){let o=nr(),a=GA();xB(a,i,t,e,n,r)}return Qf}function Yh(t,e){return t<<17|e<<2}function $s(t){return t>>17&32767}function K$(t){return(t&2)==2}function Q$(t,e){return t&131071|e<<17}function s_(t){return t|2}function fa(t){return(t&131068)>>2}function Ev(t,e){return t&-131069|e<<2}function Y$(t){return(t&1)===1}function o_(t){return t|1}function Z$(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=$s(o),c=fa(o);t[r]=n;let u=!1,d;if(Array.isArray(n)){let h=n;d=h[1],(d===null||Pl(h,d)>0)&&(u=!0)}else d=n;if(i)if(c!==0){let g=$s(t[a+1]);t[r+1]=Yh(g,a),g!==0&&(t[g+1]=Ev(t[g+1],r)),t[a+1]=Q$(t[a+1],r)}else t[r+1]=Yh(a,0),a!==0&&(t[a+1]=Ev(t[a+1],r)),a=r;else t[r+1]=Yh(c,0),a===0?a=r:t[c+1]=Ev(t[c+1],r),c=r;u&&(t[r+1]=s_(t[r+1])),US(t,d,r,!0),US(t,d,r,!1),J$(e,d,t,r,s),o=Yh(a,c),s?e.classBindings=o:e.styleBindings=o}function J$(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Pl(s,e)>=0&&(n[r+1]=o_(n[r+1]))}function US(t,e,n,r){let i=t[n+1],s=e===null,o=r?$s(i):fa(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];X$(c,e)&&(a=!0,t[o+1]=r?o_(u):s_(u)),o=r?$s(u):fa(u)}a&&(t[n+1]=r?s_(i):o_(i))}function X$(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Pl(t,e)>=0:!1}function ot(t,e,n){let r=Qe(),i=VA();if(Kf(r,i,e)){let s=nr(),o=GA();yB(s,o,r,t,e,r[tt],n,!1)}return ot}function BS(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";q_(t,n,s[o],o,r)}function Yf(t,e){return e4(t,e,null,!0),Yf}function e4(t,e,n,r){let i=Qe(),s=nr(),o=Oj(2);if(s.firstUpdatePass&&n4(s,t,o,r),e!==ma&&Kf(i,o,e)){let a=s.data[Ll()];a4(s,a,i,i[tt],t,i[o+1]=c4(e,n),r,o)}}function t4(t,e){return e>=t.expandoStartIndex}function n4(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[Ll()],o=t4(t,n);l4(s,r)&&e===null&&!o&&(e=!1),e=r4(i,s,e,r),Z$(i,s,e,n,o,r)}}function r4(t,e,n,r){let i=jj(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=Iv(null,t,e,n,r),n=Rl(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=Iv(i,t,e,n,r),s===null){let c=i4(t,e,r);c!==void 0&&Array.isArray(c)&&(c=Iv(null,t,e,c[1],r),c=Rl(c,e.attrs,r),s4(t,e,r,c))}else s=o4(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function i4(t,e,n){let r=n?e.classBindings:e.styleBindings;if(fa(r)!==0)return t[$s(r)]}function s4(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[$s(i)]=r}function o4(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Rl(r,o,n)}return Rl(r,e.attrs,n)}function Iv(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Rl(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Rl(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),U2(t,o,n?!0:e[++s]))}return t===void 0?null:t}function a4(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],d=Y$(u)?$S(c,e,n,i,fa(u),o):void 0;if(!Df(d)){Df(s)||K$(u)&&(s=$S(c,null,n,i,a,o));let h=Ej(Ll(),n);sB(r,o,h,i,s)}}function $S(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),d=u?c[1]:c,h=d===null,g=n[i+1];g===ma&&(g=h?mn:void 0);let y=h?lv(g,r):d===r?g:void 0;if(u&&!Df(y)&&(y=lv(c,r)),Df(y)&&(a=y,o))return a;let E=t[i+1];i=o?$s(E):fa(E)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=lv(c,r))}return a}function Df(t){return t!==void 0}function c4(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Jt(jl(t)))),t}function l4(t,e){return(t.flags&(e?8:16))!==0}function u4(t,e,n,r,i,s){let o=e.consts,a=uf(o,i),c=Bf(e,t,2,r,a);return qx(e,n,c,uf(o,s)),c.attrs!==null&&e_(c,c.attrs,!1),c.mergedAttrs!==null&&e_(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function V(t,e,n,r){let i=Qe(),s=nr(),o=_n+t,a=i[tt],c=s.firstCreatePass?u4(o,s,i,e,n,r):s.data[o],u=uR(s,i,c,a,e,t);i[o]=u;let d=__(c);return Fl(c,!0),Nx(a,u,c),!$l(c)&&D_()&&j_(s,i,u,c),Tj()===0&&Us(u,i),Sj(),d&&(jx(s,i,c),Vx(s,c,i)),r!==null&&Ux(i,c),V}function $(){let t=En();FA()?Pj():(t=t.parent,Fl(t,!1));let e=t;xj(e)&&Mj(),Aj();let n=nr();return n.firstCreatePass&&(b_(n,t),IA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&zj(e)&&BS(n,e,Qe(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&Wj(e)&&BS(n,e,Qe(),e.stylesWithoutHost,!1),$}function ke(t,e,n,r){return V(t,e,n,r),$(),ke}var uR=(t,e,n,r,i,s)=>(Er(!0),Vf(r,i,zA()));function d4(t,e,n,r,i,s){let o=e[Zn],a=!o||Ol()||$l(n)||Ff(o,s);if(Er(a),a)return Vf(r,i,zA());let c=qf(o,t,e,n);return vx(o,s)&&Of(o,s,c.nextSibling),o&&(ox(n)||ax(c))&&kl(n)&&(Rj(n),Rx(c)),c}function h4(){uR=d4}var f4=(t,e,n,r)=>(Er(!0),L_(e[tt],""));function p4(t,e,n,r){let i,s=e[Zn],o=!s||Ol()||$l(n);if(Er(o),o)return L_(e[tt],"");let a=qf(s,t,e,n),c=xU(s,r);return Of(s,r,a),i=Hf(c,a),i}function g4(){f4=p4}function dR(){return Qe()}var bf="en-US";var m4=bf;function y4(t){typeof t=="string"&&(m4=t.toLowerCase().replace(/_/g,"-"))}function hR(t,e,n){let r=t[tt];switch(n){case Node.COMMENT_NODE:return L_(r,e);case Node.TEXT_NODE:return F_(r,e);case Node.ELEMENT_NODE:return Vf(r,e,null)}}var v4=(t,e,n,r)=>(Er(!0),hR(t,n,r));function _4(t,e,n,r){return Er(!0),hR(t,n,r)}function w4(){v4=_4}function Cr(t,e,n,r){let i=Qe(),s=nr(),o=En();return I4(s,i,i[tt],o,t,e,r),Cr}function E4(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Cl],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function I4(t,e,n,r,i,s,o){let a=__(r),u=t.firstCreatePass&&kB(t),d=e[Jn],h=PB(e),g=!0;if(r.type&3||o){let D=wn(r,e),S=o?o(D):D,k=h.length,q=o?Y=>o(er(Y[r.index])):r.index,F=null;if(!o&&a&&(F=E4(t,e,i,r.index)),F!==null){let Y=F.__ngLastListenerFn__||F;Y.__ngNextListenerFn__=s,F.__ngLastListenerFn__=s,g=!1}else{s=HS(r,e,d,s,!1);let Y=n.listen(S,i,s);h.push(s,Y),u&&u.push(i,q,k,k+1)}}else s=HS(r,e,d,s,!1);let y=r.outputs,E;if(g&&y!==null&&(E=y[i])){let D=E.length;if(D)for(let S=0;S<D;S+=2){let k=E[S],q=E[S+1],ie=e[k][q].subscribe(s),ne=h.length;h.push(s,ie),u&&u.push(i,r.index,ne,-(ne+1))}}}function qS(t,e,n,r){let i=Pe(null);try{return fr(6,e,n),n(r)!==!1}catch(s){return Kx(t,s),!1}finally{fr(7,e,n),Pe(i)}}function HS(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?ki(t.index,e):e;G_(a);let c=qS(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=qS(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function Z_(t=1){return Bj(t)}function Q(t,e=""){let n=Qe(),r=nr(),i=t+_n,s=r.firstCreatePass?Bf(r,i,1,e,null):r.data[i],o=fR(r,n,s,e,t);n[i]=o,D_()&&j_(r,n,o,s),Fl(s,!1)}var fR=(t,e,n,r,i)=>(Er(!0),F_(e[tt],r));function C4(t,e,n,r,i){let s=e[Zn],o=!s||Ol()||$l(n)||Ff(s,i);return Er(o),o?F_(e[tt],r):qf(s,t,e,n)}function D4(){fR=C4}function b4(t,e,n){let r=nr();if(r.firstCreatePass){let i=Mi(t);a_(n,r.data,r.blueprint,i,!0),a_(e,r.data,r.blueprint,i,!1)}}function a_(t,e,n,r,i){if(t=Zt(t),Array.isArray(t))for(let s=0;s<t.length;s++)a_(t[s],e,n,r,i);else{let s=nr(),o=Qe(),a=En(),c=ca(t)?t:Zt(t.provide),u=vA(t),d=a.providerIndexes&1048575,h=a.directiveStart,g=a.providerIndexes>>20;if(ca(t)||!t.multi){let y=new js(u,i,me),E=Dv(c,e,i?d:d+g,h);E===-1?(Lv(ff(a,o),s,c),Cv(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(y),o.push(y)):(n[E]=y,o[E]=y)}else{let y=Dv(c,e,d+g,h),E=Dv(c,e,d,d+g),D=y>=0&&n[y],S=E>=0&&n[E];if(i&&!S||!i&&!D){Lv(ff(a,o),s,c);let k=A4(i?S4:T4,n.length,i,r,u);!i&&S&&(n[E].providerFactory=k),Cv(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(k),o.push(k)}else{let k=pR(n[i?E:y],u,!i&&r);Cv(s,t,y>-1?y:E,k)}!i&&r&&S&&n[E].componentProviders++}}}function Cv(t,e,n,r){let i=ca(e),s=oj(e);if(i||s){let c=(s?Zt(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let d=u.indexOf(n);d===-1?u.push(n,[r,c]):u[d+1].push(r,c)}else u.push(n,c)}}}function pR(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function Dv(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function T4(t,e,n,r){return c_(this.multi,[])}function S4(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=da(n,n[Ie],this.providerFactory.index,r);s=a.slice(0,o),c_(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],c_(i,s);return s}function c_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function A4(t,e,n,r,i){let s=new js(t,n,me);return s.multi=[],s.index=e,s.componentProviders=0,pR(s,i,r&&!n),s}function Zf(t,e=[]){return n=>{n.providersResolver=(r,i)=>b4(r,i?i(t):t,e)}}var x4=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=gA(!1,r.type),s=i.length>0?Wf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=Z({token:e,providedIn:"environment",factory:()=>new e(L(dn))});let t=e;return t})();function Ht(t){ya("NgStandalone"),t.getStandaloneInjector=e=>e.get(x4).getOrCreateStandaloneInjector(t)}function Dr(t,e,n){let r=LA()+t,i=Qe();return i[r]===ma?aR(i,r,n?e.call(n):e()):H$(i,r)}function _a(t,e,n,r){return M4(Qe(),LA(),t,e,n,r)}function R4(t,e){let n=t[e];return n===ma?void 0:n}function M4(t,e,n,r,i,s){let o=e+n;return Kf(t,o,i)?aR(t,o+1,s?r.call(s,i):r(i)):R4(t,o+1)}var Jr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},gR=new Jr("17.3.10"),Jf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var mR=new W("");function Gs(t){return!!t&&typeof t.then=="function"}function yR(t){return!!t&&typeof t.subscribe=="function"}var Xf=new W(""),vR=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=U(Xf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Gs(o))r.push(o);else if(yR(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),zs=new W("");function N4(){$T(()=>{throw new re(600,!1)})}function P4(t){return t.isBoundToModule}function k4(t,e,n){try{let r=n();return Gs(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}var Li=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=U(sx),this.afterRenderEffectManager=U(K_),this.externalTestViews=new Set,this.beforeRender=new Ke,this.afterTick=new Ke,this.componentTypes=[],this.components=[],this.isStable=U(Bl).hasPendingTasks.pipe(J(r=>!r)),this._injector=U(dn)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof Ef;if(!this._injector.get(vR).done){let y=!s&&dA(r),E=!1;throw new re(405,E)}let a;s?a=r:a=this._injector.get(Gf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=P4(a)?void 0:this._injector.get(Ni),u=i||a.selector,d=a.create(Ir.NULL,[],u,c),h=d.location.nativeElement,g=d.injector.get(mR,null);return g?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),bv(this.components,d),g?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this._tick(!0)}_tick(r){if(this._runningTick)throw new re(101,!1);let i=Pe(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(r)}catch(s){this.internalErrorHandler(s)}finally{this.afterTick.next(),this._runningTick=!1,Pe(i)}}detectChangesInAttachedViews(r){let i=0,s=this.afterRenderEffectManager;for(;;){if(i===Yx)throw new re(103,!1);if(r){let o=i===0;this.beforeRender.next(o);for(let{_lView:a,notifyErrorHandler:c}of this._views)O4(a,o,c)}if(i++,s.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>l_(o))&&(s.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>l_(o))))break}}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;bv(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(zs,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>bv(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new re(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function bv(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var Zh;function J_(t){Zh??=new WeakMap;let e=Zh.get(t);if(e)return e;let n=t.isStable.pipe(gn(r=>r)).toPromise().then(()=>{});return Zh.set(t,n),t.onDestroy(()=>Zh?.delete(t)),n}function O4(t,e,n){!e&&!l_(t)||F4(t,n,e)}function l_(t){return E_(t)}function F4(t,e,n){let r;n?(r=0,t[oe]|=1024):t[oe]&64?r=0:r=1,Zx(t,e,r)}var u_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},ep=(()=>{let e=class e{compileModuleSync(r){return new i_(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=hA(r),o=Dx(s.declarations).reduce((a,c)=>{let u=Ri(c);return u&&a.push(new ha(u)),a},[]);return new u_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var L4=(()=>{let e=class e{constructor(){this.zone=U(be),this.applicationRef=U(Li)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function V4(t){return[{provide:be,useFactory:t},{provide:Fs,multi:!0,useFactory:()=>{let e=U(L4,{optional:!0});return()=>e.initialize()}},{provide:Fs,multi:!0,useFactory:()=>{let e=U($4);return()=>{e.initialize()}}},{provide:sx,useFactory:j4}]}function j4(){let t=U(be),e=U(mr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function U4(t){let e=V4(()=>new be(B4(t)));return qs([[],e])}function B4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var $4=(()=>{let e=class e{constructor(){this.subscription=new it,this.initialized=!1,this.zone=U(be),this.pendingTasks=U(Bl)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{be.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{be.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function q4(){return typeof $localize<"u"&&$localize.locale||bf}var X_=new W("",{providedIn:"root",factory:()=>U(X_,_e.Optional|_e.SkipSelf)||q4()});var _R=new W("");var nf=null;function H4(t=[],e){return Ir.create({name:e,providers:[{provide:xf,useValue:"platform"},{provide:_R,useValue:new Set([()=>nf=null])},...t]})}function G4(t=[]){if(nf)return nf;let e=H4(t);return nf=e,N4(),z4(e),e}function z4(t){t.get(x_,null)?.forEach(n=>n())}function ew(){return!1}var wa=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=W4;let t=e;return t})();function W4(t){return K4(En(),Qe(),(t&16)===16)}function K4(t,e,n){if(kl(t)&&!n){let r=ki(t.index,e);return new Bs(r,r)}else if(t.type&47){let r=e[On];return new Bs(r,e)}return null}function wR(t){try{let{rootComponent:e,appProviders:n,platformProviders:r}=t,i=G4(r),s=[U4(),...n||[]],a=new Cf({providers:s,parent:i,debugName:"",runEnvironmentInitializers:!1}).injector,c=a.get(be);return c.run(()=>{a.resolveInjectorInitializers();let u=a.get(mr,null),d;c.runOutsideAngular(()=>{d=c.onError.subscribe({next:y=>{u.handleError(y)}})});let h=()=>a.destroy(),g=i.get(_R);return g.add(h),a.onDestroy(()=>{d.unsubscribe(),g.delete(h)}),k4(u,c,()=>{let y=a.get(vR);return y.runInitializers(),y.donePromise.then(()=>{let E=a.get(X_,bf);y4(E||bf);let D=a.get(Li);return e!==void 0&&D.bootstrap(e),D})})})}catch(e){return Promise.reject(e)}}var GS=!1,Q4=!1;function Y4(){GS||(GS=!0,bU(),h4(),D4(),g4(),W$(),L$(),d$(),fB(),w4())}function Z4(t,e){return J_(t)}function ER(){return qs([{provide:Wh,useFactory:()=>{let t=!0;return vl()&&(t=!!U(Hs,{optional:!0})?.get(mx,null)),t&&ya("NgHydration"),t}},{provide:Fs,useValue:()=>{Q4=!!U(RU,{optional:!0}),vl()&&U(Wh)&&(J4(),Y4())},multi:!0},{provide:wx,useFactory:()=>vl()&&U(Wh)},{provide:zs,useFactory:()=>{if(vl()&&U(Wh)){let t=U(Li),e=U(Ir);return()=>{Z4(t,e).then(()=>{n$(t)})}}return()=>{}},multi:!0}])}function J4(){let t=Pf(),e;for(let n of t.body.childNodes)if(n.nodeType===Node.COMMENT_NODE&&n.textContent?.trim()===CU){e=n;break}if(!e)throw new re(-507,!1)}function Ea(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function IR(t){let e=Ri(t);if(!e)return null;let n=new ha(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var SR=null;function ti(){return SR}function AR(t){SR??=t}var tp=class{};var Ft=new W(""),sw=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(X4),providedIn:"platform"});let t=e;return t})(),xR=new W(""),X4=(()=>{let e=class e extends sw{constructor(){super(),this._doc=U(Ft),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ti().getBaseHref(this._doc)}onPopState(r){let i=ti().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=ti().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function ow(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function CR(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function ei(t){return t&&t[0]!=="?"?"?"+t:t}var ni=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(aw),providedIn:"root"});let t=e;return t})(),RR=new W(""),aw=(()=>{let e=class e extends ni{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??U(Ft).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return ow(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+ei(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ei(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ei(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(L(sw),L(RR,8))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),MR=(()=>{let e=class e extends ni{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=ow(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+ei(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+ei(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(L(sw),L(RR,8))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),Ia=(()=>{let e=class e{constructor(r){this._subject=new $t,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=nq(CR(DR(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+ei(i))}normalize(r){return e.stripTrailingSlash(tq(this._basePath,DR(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ei(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+ei(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=ei,e.joinWithSlash=ow,e.stripTrailingSlash=CR,e.\u0275fac=function(i){return new(i||e)(L(ni))},e.\u0275prov=Z({token:e,factory:()=>eq(),providedIn:"root"});let t=e;return t})();function eq(){return new Ia(L(ni))}function tq(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function DR(t){return t.replace(/\/index.html$/,"")}function nq(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function cw(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var tw=/\s+/,bR=[],NR=(()=>{let e=class e{constructor(r,i){this._ngEl=r,this._renderer=i,this.initialClasses=bR,this.stateMap=new Map}set klass(r){this.initialClasses=r!=null?r.trim().split(tw):bR}set ngClass(r){this.rawClass=typeof r=="string"?r.trim().split(tw):r}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let r=this.rawClass;if(Array.isArray(r)||r instanceof Set)for(let i of r)this._updateState(i,!0);else if(r!=null)for(let i of Object.keys(r))this._updateState(i,!!r[i]);this._applyStateDiff()}_updateState(r,i){let s=this.stateMap.get(r);s!==void 0?(s.enabled!==i&&(s.changed=!0,s.enabled=i),s.touched=!0):this.stateMap.set(r,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let r of this.stateMap){let i=r[0],s=r[1];s.changed?(this._toggleClass(i,s.enabled),s.changed=!1):s.touched||(s.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),s.touched=!1}}_toggleClass(r,i){r=r.trim(),r.length>0&&r.split(tw).forEach(s=>{i?this._renderer.addClass(this._ngEl.nativeElement,s):this._renderer.removeClass(this._ngEl.nativeElement,s)})}};e.\u0275fac=function(i){return new(i||e)(me(Xr),me(Oi))},e.\u0275dir=tn({type:e,selectors:[["","ngClass",""]],inputs:{klass:[kt.None,"class","klass"],ngClass:"ngClass"},standalone:!0});let t=e;return t})();var PR=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new nw,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){TR("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){TR("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(me(Ul),me(z_))},e.\u0275dir=tn({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),nw=class{constructor(){this.$implicit=null,this.ngIf=null}};function TR(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${Jt(e)}'.`)}var ri=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=en({type:e}),e.\u0275inj=Xt({});let t=e;return t})(),lw="browser",rq="server";function uw(t){return t===lw}function ii(t){return t===rq}var kR=(()=>{let e=class e{};e.\u0275prov=Z({token:e,providedIn:"root",factory:()=>uw(U(st))?new rw(U(Ft),window):new iw});let t=e;return t})(),rw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=iq(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function iq(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var iw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},np=class{};var ip=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var $R=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}($R||{}),hw=class{constructor(e,n=qR.Ok,r="OK"){this.headers=e.headers||new ip,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}};var sp=class t extends hw{constructor(e={}){super(e),this.type=$R.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}};var qR=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(qR||{});var oq=new W("");var OR="b",FR="h",LR="s",VR="st",jR="u",UR="rt",rp=new W(""),aq=["GET","HEAD"];function cq(t,e){let h=U(rp),{isCacheActive:n}=h,r=ET(h,["isCacheActive"]),{transferCache:i,method:s}=t;if(!n||s==="POST"&&!r.includePostRequests&&!i||s!=="POST"&&!aq.includes(s)||i===!1||r.filter?.(t)===!1)return e(t);let o=U(Hs),a=uq(t),c=o.get(a,null),u=r.includeHeaders;if(typeof i=="object"&&i.includeHeaders&&(u=i.includeHeaders),c){let{[OR]:g,[UR]:y,[FR]:E,[LR]:D,[VR]:S,[jR]:k}=c,q=g;switch(y){case"arraybuffer":q=new TextEncoder().encode(g).buffer;break;case"blob":q=new Blob([g]);break}let F=new ip(E);return ee(new sp({body:q,headers:F,status:D,statusText:S,url:k}))}let d=ii(U(st));return e(t).pipe($e(g=>{g instanceof sp&&d&&o.set(a,{[OR]:g.body,[FR]:lq(g.headers,u),[LR]:g.status,[VR]:g.statusText,[jR]:g.url||"",[UR]:t.responseType})}))}function lq(t,e){if(!e)return{};let n={};for(let r of e){let i=t.getAll(r);i!==null&&(n[r]=i)}return n}function BR(t){return[...t.keys()].sort().map(e=>`${e}=${t.getAll(e)}`).join("&")}function uq(t){let{params:e,method:n,responseType:r,url:i}=t,s=BR(e),o=t.serializeBody();o instanceof URLSearchParams?o=BR(o):typeof o!="string"&&(o="");let a=[n,r,i,o,s].join("|"),c=dq(a);return c}function dq(t){let e=0;for(let n of t)e=Math.imul(31,e)+n.charCodeAt(0)<<0;return e+=2147483648,e.toString()}function HR(t){return[{provide:rp,useFactory:()=>(ya("NgHttpTransferCache"),B({isCacheActive:!0},t))},{provide:oq,useValue:cq,multi:!0,deps:[Hs,rp]},{provide:zs,multi:!0,useFactory:()=>{let e=U(Li),n=U(rp);return()=>{J_(e).then(()=>{n.isCacheActive=!1})}}}]}var gw=class extends tp{constructor(){super(...arguments),this.supportsDOMEvents=!0}},mw=class t extends gw{static makeCurrent(){AR(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=hq();return n==null?null:fq(n)}resetBaseElement(){ql=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return cw(document.cookie,e)}},ql=null;function hq(){return ql=ql||document.querySelector("base"),ql?ql.getAttribute("href"):null}function fq(t){return new URL(t,document.baseURI).pathname}var pq=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),yw=new W(""),KR=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new re(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(L(yw),L(be))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),op=class{constructor(e){this._doc=e}},fw="ng-app-id",QR=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=ii(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${fw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(fw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(fw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(L(Ft),L(kf),L(R_,8),L(st))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),pw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},ww=/%COMP%/g,YR="%COMP%",gq=`_nghost-${YR}`,mq=`_ngcontent-${YR}`,yq=!0,vq=new W("",{providedIn:"root",factory:()=>yq});function _q(t){return mq.replace(ww,t)}function wq(t){return gq.replace(ww,t)}function ZR(t,e){return e.map(n=>n.replace(ww,t))}var GR=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,d=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=ii(c),this.defaultRenderer=new Hl(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===gr.ShadowDom&&(i=xe(B({},i),{encapsulation:gr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof ap?s.applyToHost(r):s instanceof Gl&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case gr.Emulated:o=new ap(u,d,i,this.appId,h,a,c,g);break;case gr.ShadowDom:return new vw(u,d,r,i,a,c,this.nonce,g);default:o=new Gl(u,d,i,h,a,c,g);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(L(KR),L(QR),L(kf),L(vq),L(Ft),L(st),L(be),L(R_))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),Hl=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(pw[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(zR(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(zR(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new re(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=pw[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=pw[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Zr.DashCase|Zr.Important)?e.style.setProperty(n,r,i&Zr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Zr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=ti().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function zR(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var vw=class extends Hl{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=ZR(i.id,i.styles);for(let d of u){let h=document.createElement("style");a&&h.setAttribute("nonce",a),h.textContent=d,this.shadowRoot.appendChild(h)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Gl=class extends Hl{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?ZR(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},ap=class extends Gl{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=_q(u),this.hostAttr=wq(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Eq=(()=>{let e=class e extends op{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(L(Ft))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})(),WR=["alt","control","meta","shift"],Iq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Cq={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Dq=(()=>{let e=class e extends op{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ti().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),WR.forEach(d=>{let h=i.indexOf(d);h>-1&&(i.splice(h,1),a+=d+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=Iq[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),WR.forEach(a=>{if(a!==s){let c=Cq[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(L(Ft))},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})();function JR(t,e){return wR(B({rootComponent:t},bq(e)))}function bq(t){return{appProviders:[...Rq,...t?.providers??[]],platformProviders:xq}}function Tq(){mw.makeCurrent()}function Sq(){return new mr}function Aq(){return hx(document),document}var xq=[{provide:st,useValue:lw},{provide:x_,useValue:Tq,multi:!0},{provide:Ft,useFactory:Aq,deps:[]}];var Rq=[{provide:xf,useValue:"root"},{provide:mr,useFactory:Sq,deps:[]},{provide:yw,useClass:Eq,multi:!0,deps:[Ft,be,st]},{provide:yw,useClass:Dq,multi:!0,deps:[Ft]},GR,QR,KR,{provide:Al,useExisting:GR},{provide:np,useClass:pq,deps:[]},[]];var XR=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(L(Ft))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var _w=function(t){return t[t.NoHttpTransferCache=0]="NoHttpTransferCache",t[t.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",t}(_w||{});function eM(...t){let e=[],n=new Set,r=n.has(_w.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:s}of t)n.add(s),i.length&&e.push(i);return qs([[],ER(),n.has(_w.NoHttpTransferCache)||r?[]:HR({}),e])}var fe="primary",au=Symbol("RouteTitle"),bw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Sa(t){return new bw(t)}function Nq(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Pq(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!br(t[n],e[n]))return!1;return!0}function br(t,e){let n=t?Tw(t):void 0,r=e?Tw(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!lM(t[i],e[i]))return!1;return!0}function Tw(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function lM(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function uM(t){return t.length>0?t[t.length-1]:null}function $i(t){return nv(t)?t:Gs(t)?De(Promise.resolve(t)):ee(t)}var kq={exact:hM,subset:fM},dM={exact:Oq,subset:Fq,ignored:()=>!0};function tM(t,e,n){return kq[n.paths](t.root,e.root,n.matrixParams)&&dM[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function Oq(t,e){return br(t,e)}function hM(t,e,n){if(!Ks(t.segments,e.segments)||!up(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!hM(t.children[r],e.children[r],n))return!1;return!0}function Fq(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>lM(t[n],e[n]))}function fM(t,e,n){return pM(t,e,e.segments,n)}function pM(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Ks(i,n)||e.hasChildren()||!up(i,n,r))}else if(t.segments.length===n.length){if(!Ks(t.segments,n)||!up(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!fM(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Ks(t.segments,i)||!up(t.segments,i,r)||!t.children[fe]?!1:pM(t.children[fe],e,s,r)}}function up(t,e,n){return e.every((r,i)=>dM[n](t[i].parameters,r.parameters))}var Vi=class{constructor(e=new Oe([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Sa(this.queryParams),this._queryParamMap}toString(){return jq.serialize(this)}},Oe=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return dp(this)}},Ws=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Sa(this.parameters),this._parameterMap}toString(){return mM(this)}};function Lq(t,e){return Ks(t,e)&&t.every((n,r)=>br(n.parameters,e[r].parameters))}function Ks(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function Vq(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===fe&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==fe&&(n=n.concat(e(i,r)))}),n}var cu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>new Jl,providedIn:"root"});let t=e;return t})(),Jl=class{parse(e){let n=new Aw(e);return new Vi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${zl(e.root,!0)}`,r=$q(e.queryParams),i=typeof e.fragment=="string"?`#${Uq(e.fragment)}`:"";return`${n}${r}${i}`}},jq=new Jl;function dp(t){return t.segments.map(e=>mM(e)).join("/")}function zl(t,e){if(!t.hasChildren())return dp(t);if(e){let n=t.children[fe]?zl(t.children[fe],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==fe&&r.push(`${i}:${zl(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=Vq(t,(r,i)=>i===fe?[zl(t.children[fe],!1)]:[`${i}:${zl(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[fe]!=null?`${dp(t)}/${n[0]}`:`${dp(t)}/(${n.join("//")})`}}function gM(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function cp(t){return gM(t).replace(/%3B/gi,";")}function Uq(t){return encodeURI(t)}function Sw(t){return gM(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function hp(t){return decodeURIComponent(t)}function nM(t){return hp(t.replace(/\+/g,"%20"))}function mM(t){return`${Sw(t.path)}${Bq(t.parameters)}`}function Bq(t){return Object.entries(t).map(([e,n])=>`;${Sw(e)}=${Sw(n)}`).join("")}function $q(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${cp(n)}=${cp(i)}`).join("&"):`${cp(n)}=${cp(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var qq=/^[^\/()?;#]+/;function Ew(t){let e=t.match(qq);return e?e[0]:""}var Hq=/^[^\/()?;=#]+/;function Gq(t){let e=t.match(Hq);return e?e[0]:""}var zq=/^[^=?&#]+/;function Wq(t){let e=t.match(zq);return e?e[0]:""}var Kq=/^[^&#]+/;function Qq(t){let e=t.match(Kq);return e?e[0]:""}var Aw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Oe([],{}):new Oe([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[fe]=new Oe(e,n)),r}parseSegment(){let e=Ew(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new re(4009,!1);return this.capture(e),new Ws(hp(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Gq(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Ew(this.remaining);i&&(r=i,this.capture(r))}e[hp(n)]=hp(r)}parseQueryParam(e){let n=Wq(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=Qq(this.remaining);o&&(r=o,this.capture(r))}let i=nM(n),s=nM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Ew(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new re(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=fe);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[fe]:new Oe([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new re(4011,!1)}};function yM(t){return t.segments.length>0?new Oe([],{[fe]:t}):t}function vM(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=vM(i);if(r===fe&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Oe(t.segments,e);return Yq(n)}function Yq(t){if(t.numberOfChildren===1&&t.children[fe]){let e=t.children[fe];return new Oe(t.segments.concat(e.segments),e.children)}return t}function Aa(t){return t instanceof Vi}function Zq(t,e,n=null,r=null){let i=_M(t);return wM(i,e,n,r)}function _M(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Oe(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=yM(r);return e??i}function wM(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Iw(i,i,i,n,r);let s=Jq(e);if(s.toRoot())return Iw(i,i,new Oe([],{}),n,r);let o=Xq(s,i,t),a=o.processChildren?Ql(o.segmentGroup,o.index,s.commands):IM(o.segmentGroup,o.index,s.commands);return Iw(i,o.segmentGroup,a,n,r)}function fp(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Xl(t){return typeof t=="object"&&t!=null&&t.outlets}function Iw(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`});let o;t===e?o=n:o=EM(t,e,n);let a=yM(vM(o));return new Vi(a,s,i)}function EM(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=EM(s,e,n)}),new Oe(t.segments,r)}var pp=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&fp(r[0]))throw new re(4003,!1);let i=r.find(Xl);if(i&&i!==uM(r))throw new re(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function Jq(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new pp(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new pp(n,e,r)}var ba=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function Xq(t,e,n){if(t.isAbsolute)return new ba(e,!0,0);if(!n)return new ba(e,!1,NaN);if(n.parent===null)return new ba(n,!0,0);let r=fp(t.commands[0])?0:1,i=n.segments.length-1+r;return eH(n,i,t.numberOfDoubleDots)}function eH(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new re(4005,!1);i=r.segments.length}return new ba(r,!1,i-s)}function tH(t){return Xl(t[0])?t[0].outlets:{[fe]:t}}function IM(t,e,n){if(t??=new Oe([],{}),t.segments.length===0&&t.hasChildren())return Ql(t,e,n);let r=nH(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Oe(t.segments.slice(0,r.pathIndex),{});return s.children[fe]=new Oe(t.segments.slice(r.pathIndex),t.children),Ql(s,0,i)}else return r.match&&i.length===0?new Oe(t.segments,{}):r.match&&!t.hasChildren()?xw(t,e,n):r.match?Ql(t,0,i):xw(t,e,n)}function Ql(t,e,n){if(n.length===0)return new Oe(t.segments,{});{let r=tH(n),i={};if(Object.keys(r).some(s=>s!==fe)&&t.children[fe]&&t.numberOfChildren===1&&t.children[fe].segments.length===0){let s=Ql(t.children[fe],e,n);return new Oe(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=IM(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Oe(t.segments,i)}}function nH(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Xl(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!iM(c,u,o))return s;r+=2}else{if(!iM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function xw(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Xl(s)){let c=rH(s.outlets);return new Oe(r,c)}if(i===0&&fp(n[0])){let c=t.segments[e];r.push(new Ws(c.path,rM(n[0]))),i++;continue}let o=Xl(s)?s.outlets[fe]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&fp(a)?(r.push(new Ws(o,rM(a))),i+=2):(r.push(new Ws(o,{})),i++)}return new Oe(r,{})}function rH(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=xw(new Oe([],{}),0,r))}),e}function rM(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function iM(t,e,n){return t==n.path&&br(e,n.parameters)}var Yl="imperative",Tt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Tt||{}),Fn=class{constructor(e,n){this.id=e,this.url=n}},xa=class extends Fn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=Tt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Tr=class extends Fn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=Tt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Cn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Cn||{}),gp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(gp||{}),ji=class extends Fn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Tt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ui=class extends Fn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=Tt.NavigationSkipped}},eu=class extends Fn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=Tt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},mp=class extends Fn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Tt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Rw=class extends Fn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Tt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mw=class extends Fn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Tt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Nw=class extends Fn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Tt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Pw=class extends Fn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=Tt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},kw=class{constructor(e){this.route=e,this.type=Tt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ow=class{constructor(e){this.route=e,this.type=Tt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Fw=class{constructor(e){this.snapshot=e,this.type=Tt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Lw=class{constructor(e){this.snapshot=e,this.type=Tt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Vw=class{constructor(e){this.snapshot=e,this.type=Tt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jw=class{constructor(e){this.snapshot=e,this.type=Tt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},yp=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=Tt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},tu=class{},nu=class{constructor(e){this.url=e}};var Uw=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new lu,this.attachRef=null}},lu=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new Uw,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),vp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=Bw(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=Bw(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=$w(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return $w(e,this._root).map(n=>n.value)}};function Bw(t,e){if(t===e.value)return e;for(let n of e.children){let r=Bw(t,n);if(r)return r}return null}function $w(t,e){if(t===e.value)return[e];for(let n of e.children){let r=$w(t,n);if(r.length)return r.unshift(e),r}return[]}var In=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Da(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var _p=class extends vp{constructor(e,n){super(e),this.snapshot=n,Jw(this,e)}toString(){return this.snapshot.toString()}};function CM(t){let e=iH(t),n=new Pt([new Ws("",{})]),r=new Pt({}),i=new Pt({}),s=new Pt({}),o=new Pt(""),a=new Bi(n,r,s,o,i,fe,t,e.root);return a.snapshot=e.root,new _p(new In(a,[]),e)}function iH(t){let e={},n={},r={},i="",s=new ru([],e,r,i,n,fe,t,null,{});return new wp("",new In(s,[]))}var Bi=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(J(u=>u[au]))??ee(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(J(e=>Sa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(J(e=>Sa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Zw(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:B(B({},e.params),t.params),data:B(B({},e.data),t.data),resolve:B(B(B(B({},t.data),e.data),i?.data),t._resolvedData)}:r={params:B({},t.params),data:B({},t.data),resolve:B(B({},t.data),t._resolvedData??{})},i&&bM(i)&&(r.resolve[au]=i.title),r}var ru=class{get title(){return this.data?.[au]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Sa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Sa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},wp=class extends vp{constructor(e,n){super(n),this.url=e,Jw(this,n)}toString(){return DM(this._root)}};function Jw(t,e){e.value._routerState=t,e.children.forEach(n=>Jw(t,n))}function DM(t){let e=t.children.length>0?` { ${t.children.map(DM).join(", ")} } `:"";return`${t.value}${e}`}function Cw(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,br(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),br(e.params,n.params)||t.paramsSubject.next(n.params),Pq(e.url,n.url)||t.urlSubject.next(n.url),br(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function qw(t,e){let n=br(t.params,e.params)&&Lq(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||qw(t.parent,e.parent))}function bM(t){return typeof t.title=="string"||t.title===null}var Xw=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=fe,this.activateEvents=new $t,this.deactivateEvents=new $t,this.attachEvents=new $t,this.detachEvents=new $t,this.parentContexts=U(lu),this.location=U(Ul),this.changeDetector=U(wa),this.environmentInjector=U(dn),this.inputBinder=U(Dp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new re(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new re(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new re(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new re(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Hw(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=tn({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Pi]});let t=e;return t})(),Hw=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Bi?this.route:e===lu?this.childContexts:this.parent.get(e,n)}},Dp=new W(""),sM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=pl([i.queryParams,i.params,i.data]).pipe(ze(([o,a,c],u)=>(c=B(B(B({},o),a),c),u===0?ee(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=IR(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})();function sH(t,e,n){let r=iu(t,e._root,n?n._root:void 0);return new _p(r,e)}function iu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=oH(t,e,n);return new In(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>iu(t,a)),o}}let r=aH(e.value),i=e.children.map(s=>iu(t,s));return new In(r,i)}}function oH(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return iu(t,r,i);return iu(t,r)})}function aH(t){return new Bi(new Pt(t.url),new Pt(t.params),new Pt(t.queryParams),new Pt(t.fragment),new Pt(t.data),t.outlet,t.component,t)}var TM="ngNavigationCancelingError";function SM(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Aa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=AM(!1,Cn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function AM(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[TM]=!0,n.cancellationCode=e,n}function cH(t){return xM(t)&&Aa(t.url)}function xM(t){return!!t&&t[TM]}var lH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=qt({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ht],decls:1,vars:0,template:function(i,s){i&1&&ke(0,"router-outlet")},dependencies:[Xw],encapsulation:2});let t=e;return t})();function uH(t,e){return t.providers&&!t._injector&&(t._injector=Wf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function eE(t){let e=t.children&&t.children.map(eE),n=e?xe(B({},t),{children:e}):B({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==fe&&(n.component=lH),n}function Sr(t){return t.outlet||fe}function dH(t,e){let n=t.filter(r=>Sr(r)===e);return n.push(...t.filter(r=>Sr(r)!==e)),n}function uu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var hH=(t,e,n,r)=>J(i=>(new Gw(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Gw=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Cw(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Da(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Da(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new jw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Lw(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Cw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Cw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=uu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},Ep=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ta=class{constructor(e,n){this.component=e,this.route=n}};function fH(t,e,n){let r=t._root,i=e?e._root:null;return Wl(r,i,n,[r.value])}function pH(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ma(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!QS(t)?t:e.get(t):r}function Wl(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Da(e);return t.children.forEach(o=>{gH(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Zl(a,n.getContext(o),i)),i}function gH(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=mH(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Ep(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Wl(t,e,a?a.children:null,r,i):Wl(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ta(a.outlet.component,o))}else o&&Zl(e,a,i),i.canActivateChecks.push(new Ep(r)),s.component?Wl(t,null,a?a.children:null,r,i):Wl(t,null,n,r,i);return i}function mH(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Ks(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Ks(t.url,e.url)||!br(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qw(t,e)||!br(t.queryParams,e.queryParams);case"paramsChange":default:return!qw(t,e)}}function Zl(t,e,n){let r=Da(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Zl(o,e.children.getContext(s),n):Zl(o,null,n):Zl(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Ta(e.outlet.component,i)):n.canDeactivateChecks.push(new Ta(null,i)):n.canDeactivateChecks.push(new Ta(null,i))}function du(t){return typeof t=="function"}function yH(t){return typeof t=="boolean"}function vH(t){return t&&du(t.canLoad)}function _H(t){return t&&du(t.canActivate)}function wH(t){return t&&du(t.canActivateChild)}function EH(t){return t&&du(t.canDeactivate)}function IH(t){return t&&du(t.canMatch)}function RM(t){return t instanceof Wr||t?.name==="EmptyError"}var lp=Symbol("INITIAL_VALUE");function Ra(){return ze(t=>pl(t.map(e=>e.pipe(Kr(1),Ps(lp)))).pipe(J(e=>{for(let n of e)if(n!==!0){if(n===lp)return lp;if(n===!1||n instanceof Vi)return n}return!0}),Dt(e=>e!==lp),Kr(1)))}function CH(t,e){return ft(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?ee(xe(B({},n),{guardsResult:!0})):DH(o,r,i,t).pipe(ft(a=>a&&yH(a)?bH(r,s,t,e):ee(a)),J(a=>xe(B({},n),{guardsResult:a})))})}function DH(t,e,n,r){return De(t).pipe(ft(i=>RH(i.component,i.route,n,e,r)),gn(i=>i!==!0,!0))}function bH(t,e,n,r){return De(e).pipe(Ti(i=>Qo(SH(i.route.parent,r),TH(i.route,r),xH(t,i.path,n),AH(t,i.route,n))),gn(i=>i!==!0,!0))}function TH(t,e){return t!==null&&e&&e(new Vw(t)),ee(!0)}function SH(t,e){return t!==null&&e&&e(new Fw(t)),ee(!0)}function AH(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return ee(!0);let i=r.map(s=>$h(()=>{let o=uu(e)??n,a=Ma(s,o),c=_H(a)?a.canActivate(e,t):yr(o,()=>a(e,t));return $i(c).pipe(gn())}));return ee(i).pipe(Ra())}function xH(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>pH(o)).filter(o=>o!==null).map(o=>$h(()=>{let a=o.guards.map(c=>{let u=uu(o.node)??n,d=Ma(c,u),h=wH(d)?d.canActivateChild(r,t):yr(u,()=>d(r,t));return $i(h).pipe(gn())});return ee(a).pipe(Ra())}));return ee(s).pipe(Ra())}function RH(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return ee(!0);let o=s.map(a=>{let c=uu(e)??i,u=Ma(a,c),d=EH(u)?u.canDeactivate(t,e,n,r):yr(c,()=>u(t,e,n,r));return $i(d).pipe(gn())});return ee(o).pipe(Ra())}function MH(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return ee(!0);let s=i.map(o=>{let a=Ma(o,t),c=vH(a)?a.canLoad(e,n):yr(t,()=>a(e,n));return $i(c)});return ee(s).pipe(Ra(),MM(r))}function MM(t){return Yy($e(e=>{if(Aa(e))throw SM(t,e)}),J(e=>e===!0))}function NH(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return ee(!0);let s=i.map(o=>{let a=Ma(o,t),c=IH(a)?a.canMatch(e,n):yr(t,()=>a(e,n));return $i(c)});return ee(s).pipe(Ra(),MM(r))}var su=class{constructor(e){this.segmentGroup=e||null}},Ip=class extends Error{constructor(e){super(),this.urlTree=e}};function Ca(t){return Ko(new su(t))}function PH(t){return Ko(new re(4e3,!1))}function kH(t){return Ko(AM(!1,Cn.GuardRejected))}var zw=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return ee(r);if(i.numberOfChildren>1||!i.children[fe])return PH(e.redirectTo);i=i.children[fe]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new Ip(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Vi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Oe(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new re(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Ww={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function OH(t,e,n,r,i){let s=tE(t,e,n);return s.matched?(r=uH(e,r),NH(r,e,n,i).pipe(J(o=>o===!0?s:B({},Ww)))):ee(s)}function tE(t,e,n){if(e.path==="**")return FH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?B({},Ww):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Nq)(n,t,e);if(!i)return B({},Ww);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?B(B({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function FH(t){return{matched:!0,parameters:t.length>0?uM(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function oM(t,e,n,r){return n.length>0&&jH(t,n,r)?{segmentGroup:new Oe(e,VH(r,new Oe(n,t.children))),slicedSegments:[]}:n.length===0&&UH(t,n,r)?{segmentGroup:new Oe(t.segments,LH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Oe(t.segments,t.children),slicedSegments:n}}function LH(t,e,n,r){let i={};for(let s of n)if(bp(t,e,s)&&!r[Sr(s)]){let o=new Oe([],{});i[Sr(s)]=o}return B(B({},r),i)}function VH(t,e){let n={};n[fe]=e;for(let r of t)if(r.path===""&&Sr(r)!==fe){let i=new Oe([],{});n[Sr(r)]=i}return n}function jH(t,e,n){return n.some(r=>bp(t,e,r)&&Sr(r)!==fe)}function UH(t,e,n){return n.some(r=>bp(t,e,r))}function bp(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function BH(t,e,n,r){return Sr(t)!==r&&(r===fe||!bp(e,n,t))?!1:tE(e,t,n).matched}function $H(t,e,n){return e.length===0&&!t.children[n]}var Kw=class{};function qH(t,e,n,r,i,s,o="emptyOnly"){return new Qw(t,e,n,r,i,o,s).recognize()}var HH=31,Qw=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new zw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new re(4002,`'${e.segmentGroup}'`)}recognize(){let e=oM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(J(n=>{let r=new ru([],Object.freeze({}),Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,{},fe,this.rootComponentType,null,{}),i=new In(r,n),s=new wp("",i),o=Zq(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,fe).pipe(bi(r=>{if(r instanceof Ip)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof su?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Zw(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(J(s=>s instanceof In?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return De(i).pipe(Ti(s=>{let o=r.children[s],a=dH(n,s);return this.processSegmentGroup(e,a,o,s)}),hr((s,o)=>(s.push(...o),s)),Si(null),sv(),ft(s=>{if(s===null)return Ca(r);let o=NM(s);return GH(o),ee(o)}))}processSegment(e,n,r,i,s,o){return De(n).pipe(Ti(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(bi(c=>{if(c instanceof su)return ee(null);throw c}))),gn(a=>!!a),bi(a=>{if(RM(a))return $H(r,i,s)?ee(new Kw):Ca(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return BH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Ca(i):Ca(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:d}=tE(n,i,s);if(!a)return Ca(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>HH&&(this.allowRedirects=!1));let h=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,h).pipe(ft(g=>this.processSegment(e,r,n,g.concat(d),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=OH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(ze(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ze(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:d,remainingSegments:h,parameters:g}=a,y=new ru(d,g,Object.freeze(B({},this.urlTree.queryParams)),this.urlTree.fragment,WH(r),Sr(r),r.component??r._loadedComponent??null,r,KH(r)),{segmentGroup:E,slicedSegments:D}=oM(n,d,h,c);if(D.length===0&&E.hasChildren())return this.processChildren(u,c,E).pipe(J(k=>k===null?null:new In(y,k)));if(c.length===0&&D.length===0)return ee(new In(y,[]));let S=Sr(r)===s;return this.processSegment(u,c,E,D,S?fe:s,!0).pipe(J(k=>new In(y,k instanceof In?[k]:[])))}))):Ca(n)))}getChildConfig(e,n,r){return n.children?ee({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?ee({routes:n._loadedRoutes,injector:n._loadedInjector}):MH(e,n,r,this.urlSerializer).pipe(ft(i=>i?this.configLoader.loadChildren(e,n).pipe($e(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):kH(n))):ee({routes:[],injector:e})}};function GH(t){t.sort((e,n)=>e.value.outlet===fe?-1:n.value.outlet===fe?1:e.value.outlet.localeCompare(n.value.outlet))}function zH(t){let e=t.value.routeConfig;return e&&e.path===""}function NM(t){let e=[],n=new Set;for(let r of t){if(!zH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=NM(r.children);e.push(new In(r.value,i))}return e.filter(r=>!n.has(r))}function WH(t){return t.data||{}}function KH(t){return t.resolve||{}}function QH(t,e,n,r,i,s){return ft(o=>qH(t,e,n,r,o.extractedUrl,i,s).pipe(J(({state:a,tree:c})=>xe(B({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function YH(t,e){return ft(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return ee(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of PM(c))o.add(u);let a=0;return De(o).pipe(Ti(c=>s.has(c)?ZH(c,r,t,e):(c.data=Zw(c,c.parent,t).resolve,ee(void 0))),$e(()=>a++),Jo(1),ft(c=>a===o.size?ee(n):Yt))})}function PM(t){let e=t.children.map(n=>PM(n)).flat();return[t,...e]}function ZH(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!bM(i)&&(s[au]=i.title),JH(s,t,e,r).pipe(J(o=>(t._resolvedData=o,t.data=Zw(t,t.parent,n).resolve,null)))}function JH(t,e,n,r){let i=Tw(t);if(i.length===0)return ee({});let s={};return De(i).pipe(ft(o=>XH(t[o],e,n,r).pipe(gn(),$e(a=>{s[o]=a}))),Jo(1),iv(s),bi(o=>RM(o)?Yt:Ko(o)))}function XH(t,e,n,r){let i=uu(e)??r,s=Ma(t,i),o=s.resolve?s.resolve(e,n):yr(i,()=>s(e,n));return $i(o)}function Dw(t){return ze(e=>{let n=t(e);return n?De(n).pipe(J(()=>e)):ee(e)})}var kM=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===fe);return i}getResolvedTitleForRoute(r){return r.data[au]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(e3),providedIn:"root"});let t=e;return t})(),e3=(()=>{let e=class e extends kM{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(L(XR))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),hu=new W("",{providedIn:"root",factory:()=>({})}),ou=new W(""),nE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=U(ep)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return ee(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=$i(r.loadComponent()).pipe(J(OM),$e(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),Zo(()=>{this.componentLoaders.delete(r)})),s=new qo(i,()=>new Ke).pipe($o());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return ee({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=t3(i,this.compiler,r,this.onLoadEndListener).pipe(Zo(()=>{this.childrenLoaders.delete(i)})),a=new qo(o,()=>new Ke).pipe($o());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t3(t,e,n,r){return $i(t.loadChildren()).pipe(J(OM),ft(i=>i instanceof xl||Array.isArray(i)?ee(i):De(e.compileModuleAsync(i))),J(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(ou,[],{optional:!0,self:!0}).flat()),{routes:o.map(eE),injector:s}}))}function n3(t){return t&&typeof t=="object"&&"default"in t}function OM(t){return n3(t)?t.default:t}var rE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(r3),providedIn:"root"});let t=e;return t})(),r3=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),FM=new W(""),LM=new W("");function i3(t,e,n){let r=t.get(LM),i=t.get(Ft);return t.get(be).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(u=>setTimeout(u));let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),s3(t))),{onViewTransitionCreated:c}=r;return c&&yr(t,()=>c({transition:a,from:e,to:n})),o})}function s3(t){return new Promise(e=>{zf(e,{injector:t})})}var iE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ke,this.transitionAbortSubject=new Ke,this.configLoader=U(nE),this.environmentInjector=U(dn),this.urlSerializer=U(cu),this.rootContexts=U(lu),this.location=U(Ia),this.inputBindingEnabled=U(Dp,{optional:!0})!==null,this.titleStrategy=U(kM),this.options=U(hu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=U(rE),this.createViewTransition=U(FM,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>ee(void 0),this.rootComponentType=null;let r=s=>this.events.next(new kw(s)),i=s=>this.events.next(new Ow(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(xe(B(B({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new Pt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Yl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Dt(o=>o.id!==0),J(o=>xe(B({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),ze(o=>{let a=!1,c=!1;return ee(o).pipe(ze(u=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Cn.SupersededByNewNavigation),Yt;this.currentTransition=o,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?xe(B({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!d&&h!=="reload"){let g="";return this.events.next(new Ui(u.id,this.urlSerializer.serialize(u.rawUrl),g,gp.IgnoredSameUrlNavigation)),u.resolve(null),Yt}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return ee(u).pipe(ze(g=>{let y=this.transitions?.getValue();return this.events.next(new xa(g.id,this.urlSerializer.serialize(g.extractedUrl),g.source,g.restoredState)),y!==this.transitions?.getValue()?Yt:Promise.resolve(g)}),QH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),$e(g=>{o.targetSnapshot=g.targetSnapshot,o.urlAfterRedirects=g.urlAfterRedirects,this.currentNavigation=xe(B({},this.currentNavigation),{finalUrl:g.urlAfterRedirects});let y=new mp(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(y)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:g,extractedUrl:y,source:E,restoredState:D,extras:S}=u,k=new xa(g,this.urlSerializer.serialize(y),E,D);this.events.next(k);let q=CM(this.rootComponentType).snapshot;return this.currentTransition=o=xe(B({},u),{targetSnapshot:q,urlAfterRedirects:y,extras:xe(B({},S),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=y,ee(o)}else{let g="";return this.events.next(new Ui(u.id,this.urlSerializer.serialize(u.extractedUrl),g,gp.IgnoredByUrlHandlingStrategy)),u.resolve(null),Yt}}),$e(u=>{let d=new Rw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),J(u=>(this.currentTransition=o=xe(B({},u),{guards:fH(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),CH(this.environmentInjector,u=>this.events.next(u)),$e(u=>{if(o.guardsResult=u.guardsResult,Aa(u.guardsResult))throw SM(this.urlSerializer,u.guardsResult);let d=new Mw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(d)}),Dt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Cn.GuardRejected),!1)),Dw(u=>{if(u.guards.canActivateChecks.length)return ee(u).pipe($e(d=>{let h=new Nw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),ze(d=>{let h=!1;return ee(d).pipe(YH(this.paramsInheritanceStrategy,this.environmentInjector),$e({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Cn.NoDataFromResolver)}}))}),$e(d=>{let h=new Pw(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),Dw(u=>{let d=h=>{let g=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&g.push(this.configLoader.loadComponent(h.routeConfig).pipe($e(y=>{h.component=y}),J(()=>{})));for(let y of h.children)g.push(...d(y));return g};return pl(d(u.targetSnapshot.root)).pipe(Si(null),Kr(1))}),Dw(()=>this.afterPreactivation()),ze(()=>{let{currentSnapshot:u,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,u.root,d.root);return h?De(h).pipe(J(()=>o)):ee(o)}),J(u=>{let d=sH(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=xe(B({},u),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),$e(()=>{this.events.next(new tu)}),hH(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),Kr(1),$e({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Tr(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),Xo(this.transitionAbortSubject.pipe($e(u=>{throw u}))),Zo(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Cn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),bi(u=>{if(c=!0,xM(u))this.events.next(new ji(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),cH(u)?this.events.next(new nu(u.url)):o.resolve(!1);else{this.events.next(new eu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(d){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(d)}}return Yt}))}))}cancelNavigationTransition(r,i,s){let o=new ji(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function o3(t){return t!==Yl}var a3=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(c3),providedIn:"root"});let t=e;return t})(),Yw=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},c3=(()=>{let e=class e extends Yw{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vl(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),VM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:()=>U(l3),providedIn:"root"});let t=e;return t})(),l3=(()=>{let e=class e extends VM{constructor(){super(...arguments),this.location=U(Ia),this.urlSerializer=U(cu),this.options=U(hu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=U(rE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Vi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=CM(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof xa)this.stateMemento=this.createStateMemento();else if(r instanceof Ui)this.rawUrlTree=i.initialUrl;else if(r instanceof mp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof tu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof ji&&(r.code===Cn.GuardRejected||r.code===Cn.NoDataFromResolver)?this.restoreHistory(i):r instanceof eu?this.restoreHistory(i,!0):r instanceof Tr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=B(B({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=B(B({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vl(e)))(s||e)}})(),e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Kl=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Kl||{});function jM(t,e){t.events.pipe(Dt(n=>n instanceof Tr||n instanceof ji||n instanceof eu||n instanceof Ui),J(n=>n instanceof Tr||n instanceof Ui?Kl.COMPLETE:(n instanceof ji?n.code===Cn.Redirect||n.code===Cn.SupersededByNewNavigation:!1)?Kl.REDIRECTING:Kl.FAILED),Dt(n=>n!==Kl.REDIRECTING),Kr(1)).subscribe(()=>{e()})}function u3(t){throw t}var d3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},h3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Dn=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=U(Jf),this.stateManager=U(VM),this.options=U(hu,{optional:!0})||{},this.pendingTasks=U(Bl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=U(iE),this.urlSerializer=U(cu),this.location=U(Ia),this.urlHandlingStrategy=U(rE),this._events=new Ke,this.errorHandler=this.options.errorHandler||u3,this.navigated=!1,this.routeReuseStrategy=U(a3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=U(ou,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!U(Dp,{optional:!0}),this.eventsSubscription=new it,this.isNgZoneEnabled=U(be)instanceof be&&be.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ji&&i.code!==Cn.Redirect&&i.code!==Cn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Tr)this.navigated=!0;else if(i instanceof nu){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||o3(s.source)};this.scheduleNavigation(a,Yl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}p3(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Yl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=B({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(eE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,d=u?this.currentUrlTree.fragment:a,h=null;switch(c){case"merge":h=B(B({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let g;try{let y=s?s.snapshot:this.routerState.snapshot.root;g=_M(y)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),g=this.currentUrlTree.root}return wM(g,r,h,d??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Aa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Yl,null,i)}navigate(r,i={skipLocationChange:!1}){return f3(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=B({},d3):i===!1?s=B({},h3):s=i,Aa(r))return tM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return tM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,d;a?(c=a.resolve,u=a.reject,d=a.promise):d=new Promise((g,y)=>{c=g,u=y});let h=this.pendingTasks.add();return jM(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(g=>Promise.reject(g))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function f3(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new re(4008,!1)}function p3(t){return!(t instanceof tu)&&!(t instanceof nu)}var Na=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Ke,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(d=>{d instanceof Tr&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:Ix(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(me(Dn),me(Bi),S_("tabindex"),me(Oi),me(Xr),me(ni))},e.\u0275dir=tn({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Cr("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Qf("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[kt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Ea],skipLocationChange:[kt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Ea],replaceUrl:[kt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Ea],routerLink:"routerLink"},standalone:!0,features:[Y_,Pi]});let t=e;return t})();var Cp=class{};var g3=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(Dt(r=>r instanceof Tr),Ti(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Wf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return De(s).pipe(Di())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=ee(null);let o=s.pipe(ft(a=>a===null?ee(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return De([o,a]).pipe(Di())}else return o})}};e.\u0275fac=function(i){return new(i||e)(L(Dn),L(ep),L(dn),L(Cp),L(nE))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),UM=new W(""),m3=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},this.environmentInjector=U(dn),a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof xa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Tr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ui&&r.code===gp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof yp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>x(this,null,function*(){yield new Promise(s=>{setTimeout(()=>{s()}),zf(()=>{s()},{injector:this.environmentInjector})}),this.zone.run(()=>{this.transitions.events.next(new yp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){kx()},e.\u0275prov=Z({token:e,factory:e.\u0275fac});let t=e;return t})();function BM(t,...e){return qs([{provide:ou,multi:!0,useValue:t},[],{provide:Bi,useFactory:$M,deps:[Dn]},{provide:zs,multi:!0,useFactory:qM},e.map(n=>n.\u0275providers)])}function $M(t){return t.routerState.root}function fu(t,e){return{\u0275kind:t,\u0275providers:e}}function qM(){let t=U(Ir);return e=>{let n=t.get(Li);if(e!==n.components[0])return;let r=t.get(Dn),i=t.get(HM);t.get(sE)===1&&r.initialNavigation(),t.get(GM,null,_e.Optional)?.setUpPreloading(),t.get(UM,null,_e.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var HM=new W("",{factory:()=>new Ke}),sE=new W("",{providedIn:"root",factory:()=>1});function y3(){return fu(2,[{provide:sE,useValue:0},{provide:Xf,multi:!0,deps:[Ir],useFactory:e=>{let n=e.get(xR,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Dn),s=e.get(HM);jM(i,()=>{r(!0)}),e.get(iE).afterPreactivation=()=>(r(!0),s.closed?ee(void 0):s),i.initialNavigation()}))}}])}function v3(){return fu(3,[{provide:Xf,multi:!0,useFactory:()=>{let e=U(Dn);return()=>{e.setUpLocationChangeListener()}}},{provide:sE,useValue:2}])}var GM=new W("");function _3(t){return fu(0,[{provide:GM,useExisting:g3},{provide:Cp,useExisting:t}])}function w3(){return fu(8,[sM,{provide:Dp,useExisting:sM}])}function E3(t){let e=[{provide:FM,useValue:i3},{provide:LM,useValue:B({skipNextTransition:!!t?.skipInitialTransition},t)}];return fu(9,e)}var aM=new W("ROUTER_FORROOT_GUARD"),I3=[Ia,{provide:cu,useClass:Jl},Dn,lu,{provide:Bi,useFactory:$M,deps:[Dn]},nE,[]],Pa=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[I3,[],{provide:ou,multi:!0,useValue:r},{provide:aM,useFactory:T3,deps:[[Dn,new Nl,new nA]]},{provide:hu,useValue:i||{}},i?.useHash?D3():b3(),C3(),i?.preloadingStrategy?_3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?S3(i):[],i?.bindToComponentInputs?w3().\u0275providers:[],i?.enableViewTransitions?E3().\u0275providers:[],A3()]}}static forChild(r){return{ngModule:e,providers:[{provide:ou,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(L(aM,8))},e.\u0275mod=en({type:e}),e.\u0275inj=Xt({});let t=e;return t})();function C3(){return{provide:UM,useFactory:()=>{let t=U(kR),e=U(be),n=U(hu),r=U(iE),i=U(cu);return n.scrollOffset&&t.setOffset(n.scrollOffset),new m3(i,r,t,e,n)}}}function D3(){return{provide:ni,useClass:MR}}function b3(){return{provide:ni,useClass:aw}}function T3(t){return"guarded"}function S3(t){return[t.initialNavigation==="disabled"?v3().\u0275providers:[],t.initialNavigation==="enabledBlocking"?y3().\u0275providers:[]]}var cM=new W("");function A3(){return[{provide:cM,useFactory:qM},{provide:zs,multi:!0,useExisting:cM}]}var x3=()=>["/contact"],zM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=qt({type:e,selectors:[["app-homepage"]],standalone:!0,features:[Ht],decls:19,vars:2,consts:[[1,"bg-white","px-3","py-6","text-gray-700","screen-size"],[1,"flex","flex-col","mx-auto","mt-4","max-w-[92.5rem]","lg:justify-center","lg:items-center"],[1,"p-10","mx-auto"],["src","../../assets/me.png","alt","Developer",1,"w-[15rem]","bg-red-100","gray-scale","object-cover","rounded-full","mb-10"],[1,"flex","flex-col","px-6"],[1,"text-5xl","md:text-[4rem]","leading-[4rem]","text-center","text-gray-800","font-bold"],[1,"text-orange-600"],[1,"text-2xl","mx-auto","text-center","text-gray-600","mt-10","md:mt-[2rem]","md:my-4"],[1,"text-left","tex-md","mx-auto","px-0","md:text-xl","md:max-w-[50rem]","mt-4","text-gray-600"],[1,"flex","flex-col","w-[60%]","md:w-fit","mb-5","mx-auto","md:flex-row","space-y-3","md:space-y-0","mt-10"],["href","javascript:void(0)",1,"bg-black","text-white","py-3","px-10","rounded-lg","text-lg","font-semibold",3,"routerLink"],["href","../../assets/Stranger.pdf","download","",1,"bg-transparent","text-black","py-3","px-4","rounded-lg","text-lg","font-semibold","ml-4"]],template:function(i,s){i&1&&(V(0,"div",0)(1,"div",1)(2,"div",2),ke(3,"img",3),$(),V(4,"div",4)(5,"h1",5),Q(6," Hello there, I'm "),V(7,"span",6),Q(8,"Stranger"),$()(),V(9,"h3",7),Q(10," Software Developer | Node.js | Angular | GraphQL | TypeScript | Postgres "),$(),V(11,"p",8),Q(12," I'm a curious and adaptable software engineer who enjoys solving real-world problems through clean, scalable code. I'm passionate about continuous learning, mentoring, and building tools that make a real impact. I thrive in collaborative teams and bring a strong mix of technical depth and a user-focused mindset. "),ke(13,"br"),$(),V(14,"div",9)(15,"a",10),Q(16,"Hire me"),$(),V(17,"a",11),Q(18,"Download CV"),$()()()()()),i&2&&(wt(15),ot("routerLink",Dr(1,x3)))},dependencies:[Pa,Na,ri],styles:[".screen-size[_ngcontent-%COMP%]{height:calc(100vh - 180px)}.gray-scale[_ngcontent-%COMP%]{-webkit-filter:grayscale(100%);filter:grayscale(100%);transition:filter .5s ease-in-out}.gray-scale[_ngcontent-%COMP%]:hover{-webkit-filter:grayscale(0%);filter:grayscale(0%)}"]});let t=e;return t})();var WM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=qt({type:e,selectors:[["app-about"]],standalone:!0,features:[Ht],decls:41,vars:0,consts:[[1,"max-w-6xl","mt-10","p-4","mx-auto"],[1,"flex","flex-col-reverse","md:flex-row","mx-auto","justify-center","md:mt-10"],[1,"p-4","lg:w-[60%]","lg:pr-[4rem]"],[1,"p-6","mt-5","shadow-lg","cursor-pointer","group","hover:bg-gray-700","hover:text-white","duration-300","rounded-md","mb-6"],[1,"text-2xl","text-black","group-hover:text-white","font-semibold"],[1,"text-md","text-black","group-hover:text-white","mt-3","text-lg"],["href","https://www.ul.ac.za/","target","_blank",1,"hover:underline"],[1,"text-gray-400","group-hover:font-semibold","text-xs","block","mt-3"],[1,"text-2xl","my-6","font-semibold"],[1,"text-md","mt-4"],[1,"mt-4"],[1,"flex","flex-col-reverse","justify-center","lg:flex-row","p-10","lg:w-[40%]","mx-auto","max-w-96","lg:max-w-max","md:mx-0","lg:bg-white","lg:rounded-lg","border-lg:shadow-lg","lg:relative"],[1,"flex","flex-col"],[1,"p-4","bg-pink-200","rounded-full","overflow-hidden"],["src","../../assets/me.png","alt","",1,"object-cover"],[1,"mt-[3rem]","lg:hidden"],[1,"flex","justify-between","items-center"],["src","../../assets/node.png","alt","a",1,"w-[2rem]"],["src","../../assets/ts.png","alt","a",1,"w-[2rem]"],["src","../../assets/javascript.png","alt","a",1,"w-[2rem]"],["src","../../assets/angular.png","alt","a",1,"w-[2rem]"],["src","../../assets/graphql.png","alt","a",1,"w-[2rem]"],["src","../../assets/psql.png","alt","a",1,"w-[2rem]"],["src","../../assets/aws.png","alt","a",1,"w-[2rem]"],[1,"hidden","lg:flex","languages"],["src","../../assets/node.png","alt","a",1,"absolute","top-[20rem]","left-[14rem]","w-[5rem]"],["src","../../assets/ts.png","alt","a",1,"absolute","top-[-0rem]","right-[-0rem]","w-[5rem]"],["src","../../assets/javascript.png","alt","a",1,"absolute","top-[10rem]","right-[rem]","w-[5rem]"],["src","../../assets/angular.png","alt","a",1,"absolute","top-[0rem]","right-[22rem]","w-[5rem]"],["src","../../assets/graphql.png","alt","a",1,"absolute","top-[2rem]","right-[12rem]","w-[5rem]"],["src","../../assets/psql.png","alt","a",1,"absolute","top-[20rem]","right-[22rem]","w-[5rem]"],["src","../../assets/aws.png","alt","a",1,"absolute","top-[12rem]","right-[2rem]","w-[5rem]"]],template:function(i,s){i&1&&(V(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),Q(5," Education "),$(),V(6,"p",5),Q(7," BSc. Mathematical Science, "),V(8,"a",6),Q(9,"University of Limpopo"),$(),V(10,"span",7),Q(11," 2015 - 2018"),$()()(),V(12,"h2",8),Q(13,"About me"),$(),V(14,"p",9),Q(15," I am a passionate and dedicated software developer with 4 years of professional experience in creating and maintaining web applications. My expertise lies in full-stack development, with honed skills in both front-end and back-end technologies. I have a strong foundation in JavaScript, Node.js, GraphQL, TypeScript, and frameworks such as Angular, Next.js, and Nest.js, enabling me to build robust and scalable applications. "),$(),V(16,"div",10),Q(17," Beyond technical skills, I am committed to continuous learning and knowledge sharing. I actively contribute to team discussions, mentor junior developers, and stay updated with the latest industry trends. My goal is to not only write clean and maintainable code but also to drive innovation and efficiency within the development team. "),$(),V(18,"div",10),Q(19," In my free time, I love exploring new technologies, cooking, watching anime, playing games, and studying subjects like Astronomy, Blockchain, and AI. Additionally, I am an aspiring entrepreneur, passionate about making positive impact through technology and innovation. "),$()(),V(20,"div",11)(21,"div",12)(22,"div",13),ke(23,"img",14),$(),V(24,"div",15)(25,"div",16),ke(26,"img",17)(27,"img",18)(28,"img",19)(29,"img",20)(30,"img",21)(31,"img",22)(32,"img",23),$()()(),V(33,"div",24),ke(34,"img",25)(35,"img",26)(36,"img",27)(37,"img",28)(38,"img",29)(39,"img",30)(40,"img",31),$()()()())}});let t=e;return t})();var tN=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(me(Oi),me(Xr))},e.\u0275dir=tn({type:e});let t=e;return t})(),R3=(()=>{let e=class e extends tN{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=Vl(e)))(s||e)}})(),e.\u0275dir=tn({type:e,features:[Fi]});let t=e;return t})(),nN=new W("");var M3={provide:nN,useExisting:pa(()=>Op),multi:!0};function N3(){let t=ti()?ti().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var P3=new W(""),Op=(()=>{let e=class e extends tN{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!N3())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(me(Oi),me(Xr),me(P3,8))},e.\u0275dir=tn({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Cr("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Zf([M3]),Fi]});let t=e;return t})();function qi(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function rN(t){return t!=null&&typeof t.length=="number"}var iN=new W(""),sN=new W(""),k3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Qs=class{static min(e){return O3(e)}static max(e){return F3(e)}static required(e){return L3(e)}static requiredTrue(e){return V3(e)}static email(e){return j3(e)}static minLength(e){return U3(e)}static maxLength(e){return B3(e)}static pattern(e){return $3(e)}static nullValidator(e){return oN(e)}static compose(e){return hN(e)}static composeAsync(e){return pN(e)}};function O3(t){return e=>{if(qi(e.value)||qi(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function F3(t){return e=>{if(qi(e.value)||qi(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function L3(t){return qi(t.value)?{required:!0}:null}function V3(t){return t.value===!0?null:{required:!0}}function j3(t){return qi(t.value)||k3.test(t.value)?null:{email:!0}}function U3(t){return e=>qi(e.value)||!rN(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function B3(t){return e=>rN(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function $3(t){if(!t)return oN;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(qi(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function oN(t){return null}function aN(t){return t!=null}function cN(t){return Gs(t)?De(t):t}function lN(t){let e={};return t.forEach(n=>{e=n!=null?B(B({},e),n):e}),Object.keys(e).length===0?null:e}function uN(t,e){return e.map(n=>n(t))}function q3(t){return!t.validate}function dN(t){return t.map(e=>q3(e)?e:n=>e.validate(n))}function hN(t){if(!t)return null;let e=t.filter(aN);return e.length==0?null:function(n){return lN(uN(n,e))}}function fN(t){return t!=null?hN(dN(t)):null}function pN(t){if(!t)return null;let e=t.filter(aN);return e.length==0?null:function(n){let r=uN(n,e).map(cN);return rv(r).pipe(J(lN))}}function gN(t){return t!=null?pN(dN(t)):null}function KM(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function mN(t){return t._rawValidators}function yN(t){return t._rawAsyncValidators}function oE(t){return t?Array.isArray(t)?t:[t]:[]}function Ap(t,e){return Array.isArray(t)?t.includes(e):t===e}function QM(t,e){let n=oE(e);return oE(t).forEach(i=>{Ap(n,i)||n.push(i)}),n}function YM(t,e){return oE(e).filter(n=>!Ap(t,n))}var xp=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=fN(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=gN(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Oa=class extends xp{get formDirective(){return null}get path(){return null}},mu=class extends xp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Rp=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},H3={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Nte=xe(B({},H3),{"[class.ng-submitted]":"isSubmitted"}),vN=(()=>{let e=class e extends Rp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(me(mu,2))},e.\u0275dir=tn({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Yf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Fi]});let t=e;return t})(),_N=(()=>{let e=class e extends Rp{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(me(Oa,10))},e.\u0275dir=tn({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Yf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Fi]});let t=e;return t})();var pu="VALID",Sp="INVALID",ka="PENDING",gu="DISABLED";function wN(t){return(Fp(t)?t.validators:t)||null}function G3(t){return Array.isArray(t)?fN(t):t||null}function EN(t,e){return(Fp(e)?e.asyncValidators:t)||null}function z3(t){return Array.isArray(t)?gN(t):t||null}function Fp(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function W3(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new re(1e3,"");if(!r[n])throw new re(1001,"")}function K3(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new re(1002,"")})}var Mp=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===pu}get invalid(){return this.status===Sp}get pending(){return this.status==ka}get disabled(){return this.status===gu}get enabled(){return this.status!==gu}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(QM(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(QM(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(YM(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(YM(e,this._rawAsyncValidators))}hasValidator(e){return Ap(this._rawValidators,e)}hasAsyncValidator(e){return Ap(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=ka,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=gu,this.errors=null,this._forEachChild(r=>{r.disable(xe(B({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(xe(B({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=pu,this._forEachChild(r=>{r.enable(xe(B({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(xe(B({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===pu||this.status===ka)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?gu:pu}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=ka,this._hasOwnPendingAsyncValidator=!0;let n=cN(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new $t,this.statusChanges=new $t}_calculateStatus(){return this._allControlsDisabled()?gu:this.errors?Sp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ka)?ka:this._anyControlsHaveStatus(Sp)?Sp:pu}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Fp(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=G3(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=z3(this._rawAsyncValidators)}},Np=class extends Mp{constructor(e,n,r){super(wN(n),EN(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){K3(this,!0,e),Object.keys(e).forEach(r=>{W3(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var IN=new W("CallSetDisabledState",{providedIn:"root",factory:()=>aE}),aE="always";function Q3(t,e){return[...e.path,t]}function ZM(t,e,n=aE){cE(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),Z3(t,e),X3(t,e),J3(t,e),Y3(t,e)}function JM(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),kp(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Pp(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Y3(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function cE(t,e){let n=mN(t);e.validator!==null?t.setValidators(KM(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=yN(t);e.asyncValidator!==null?t.setAsyncValidators(KM(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();Pp(e._rawValidators,i),Pp(e._rawAsyncValidators,i)}function kp(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=mN(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=yN(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}let r=()=>{};return Pp(e._rawValidators,r),Pp(e._rawAsyncValidators,r),n}function Z3(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&CN(t,e)})}function J3(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&CN(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function CN(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function X3(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function eG(t,e){t==null,cE(t,e)}function tG(t,e){return kp(t,e)}function nG(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function rG(t){return Object.getPrototypeOf(t.constructor)===R3}function iG(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function sG(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Op?n=s:rG(s)?r=s:i=s}),i||r||n||null}function oG(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function XM(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function eN(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var yu=class extends Mp{constructor(e=null,n,r){super(wN(n),EN(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Fp(n)&&(n.nonNullable||n.initialValueIsDefault)&&(eN(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){XM(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){XM(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){eN(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var aG=t=>t instanceof yu;var DN=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=tn({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var bN=new W("");var cG={provide:Oa,useExisting:pa(()=>lE)},lE=(()=>{let e=class e extends Oa{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new $t,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(kp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return ZM(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){JM(r.control||null,r,!1),oG(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,iG(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(JM(i||null,r),aG(s)&&(ZM(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);eG(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&tG(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){cE(this.form,this),this._oldForm&&kp(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(me(iN,10),me(sN,10),me(IN,8))},e.\u0275dir=tn({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&Cr("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[kt.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Zf([cG]),Fi,Pi]});let t=e;return t})();var lG={provide:mu,useExisting:pa(()=>uE)},uE=(()=>{let e=class e extends mu{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new $t,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=sG(this,o)}ngOnChanges(r){this._added||this._setUpControl(),nG(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return Q3(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(me(Oa,13),me(iN,10),me(sN,10),me(nN,10),me(bN,8))},e.\u0275dir=tn({type:e,selectors:[["","formControlName",""]],inputs:{name:[kt.None,"formControlName","name"],isDisabled:[kt.None,"disabled","isDisabled"],model:[kt.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Zf([lG]),Fi,Pi]});let t=e;return t})();var uG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=en({type:e}),e.\u0275inj=Xt({});let t=e;return t})();var TN=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:bN,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:IN,useValue:r.callSetDisabledState??aE}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=en({type:e}),e.\u0275inj=Xt({imports:[uG]});let t=e;return t})();var hG=()=>["/"],SN=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=qt({type:e,selectors:[["app-success"]],standalone:!0,features:[Ht],decls:15,vars:2,consts:[[1,"flex","flex-col","md:flex-row","justify-center","items-center","mt-10","p-8","mx-auto"],[1,"flex","flex-col","justify-center","items-center","max-w-3xl","p-10","shadow-lg","rounded-xl"],[1,"text-6xl","font-bold"],[1,"text-md","mt-10"],[1,"text-md","my-5"],[1,"text-md","mt-4","mb-3"],[1,"text-sm","tex-gray-100","font-semibold","my-2"],[1,"flex","justify-center","items-center","mt-10"],["href","javascript:void(0)",1,"bg-black","text-white","font-bold","py-3","px-8","rounded",3,"routerLink"]],template:function(i,s){i&1&&(V(0,"div",0)(1,"div",1)(2,"h1",2),Q(3,"Thank you!"),$(),V(4,"p",3),Q(5," Thank you for reaching out! Your message has been successfully sent. I appreciate you taking the time to get in touch. "),$(),V(6,"p",4),Q(7," I will review your message and get back to you as soon as possible. "),$(),V(8,"p",5),Q(9,"Best regards,"),$(),V(10,"p",6),Q(11,"Stranger Mushwana"),$(),V(12,"div",7)(13,"a",8),Q(14,"Home Page"),$()()()()),i&2&&(wt(13),ot("routerLink",Dr(1,hG)))},dependencies:[Pa,Na],encapsulation:2});let t=e;return t})();var Ln=class{constructor(e=0,n="Network Error"){this.status=e,this.text=n}};var AN=()=>{if(!(typeof localStorage>"u"))return{get:t=>Promise.resolve(localStorage.getItem(t)),set:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),remove:t=>Promise.resolve(localStorage.removeItem(t))}};var at={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:AN()};var Fa=t=>t?typeof t=="string"?{publicKey:t}:t.toString()==="[object Object]"?t:{}:{};var xN=(t,e="https://api.emailjs.com")=>{if(!t)return;let n=Fa(t);at.publicKey=n.publicKey,at.blockHeadless=n.blockHeadless,at.storageProvider=n.storageProvider,at.blockList=n.blockList,at.limitRate=n.limitRate,at.origin=n.origin||e};var Lp=(r,i,...s)=>x(void 0,[r,i,...s],function*(t,e,n={}){let o=yield fetch(at.origin+t,{method:"POST",headers:n,body:e}),a=yield o.text(),c=new Ln(o.status,a);if(o.ok)return c;throw c});var Vp=(t,e,n)=>{if(!t||typeof t!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e||typeof e!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n||typeof n!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"};var RN=t=>{if(t&&t.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"};var jp=t=>t.webdriver||!t.languages||t.languages.length===0;var Up=()=>new Ln(451,"Unavailable For Headless Browser");var MN=(t,e)=>{if(!Array.isArray(t))throw"The BlockList list has to be an array";if(typeof e!="string")throw"The BlockList watchVariable has to be a string"};var fG=t=>!t.list?.length||!t.watchVariable,pG=(t,e)=>t instanceof FormData?t.get(e):t[e],Bp=(t,e)=>{if(fG(t))return!1;MN(t.list,t.watchVariable);let n=pG(e,t.watchVariable);return typeof n!="string"?!1:t.list.includes(n)};var $p=()=>new Ln(403,"Forbidden");var NN=(t,e)=>{if(typeof t!="number"||t<0)throw"The LimitRate throttle has to be a positive number";if(e&&typeof e!="string")throw"The LimitRate ID has to be a non-empty string"};var gG=(t,e,n)=>x(void 0,null,function*(){let r=Number((yield n.get(t))||0);return e-Date.now()+r}),qp=(t,e,n)=>x(void 0,null,function*(){if(!e.throttle||!n)return!1;NN(e.throttle,e.id);let r=e.id||t;return(yield gG(r,e.throttle,n))>0?!0:(yield n.set(r,Date.now().toString()),!1)});var Hp=()=>new Ln(429,"Too Many Requests");var PN=(t,e,n,r)=>x(void 0,null,function*(){let i=Fa(r),s=i.publicKey||at.publicKey,o=i.blockHeadless||at.blockHeadless,a=i.storageProvider||at.storageProvider,c=B(B({},at.blockList),i.blockList),u=B(B({},at.limitRate),i.limitRate);return o&&jp(navigator)?Promise.reject(Up()):(Vp(s,t,e),RN(n),n&&Bp(c,n)?Promise.reject($p()):(yield qp(location.pathname,u,a))?Promise.reject(Hp()):Lp("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:s,service_id:t,template_id:e,template_params:n}),{"Content-type":"application/json"}))});var kN=t=>{if(!t||t.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"};var mG=t=>typeof t=="string"?document.querySelector(t):t,ON=(t,e,n,r)=>x(void 0,null,function*(){let i=Fa(r),s=i.publicKey||at.publicKey,o=i.blockHeadless||at.blockHeadless,a=at.storageProvider||i.storageProvider,c=B(B({},at.blockList),i.blockList),u=B(B({},at.limitRate),i.limitRate);if(o&&jp(navigator))return Promise.reject(Up());let d=mG(n);Vp(s,t,e),kN(d);let h=new FormData(d);return Bp(c,h)?Promise.reject($p()):(yield qp(location.pathname,u,a))?Promise.reject(Hp()):(h.append("lib_version","4.4.1"),h.append("service_id",t),h.append("template_id",e),h.append("user_id",s),Lp("/api/v1.0/email/send-form",h))});var dE={init:xN,send:PN,sendForm:ON,EmailJSResponseStatus:Ln};var La={production:!0,firebase:{apiKey:"AIzaSyB-h2U4AtHj4xOoH_ORbN2JKvUI682FRp8",authDomain:"unknown-ae7c8.firebaseapp.com",projectId:"unknown-ae7c8",storageBucket:"unknown-ae7c8.appspot.com",messagingSenderId:"551768107392",appId:"1:551768107392:web:ecb22aed5b6700e3a53965",measurementId:"G-B64T6TBSBR"},emailjs:{publicKey:"N7TaIpUgRNQOlUtO0",serviceId:"service_530hpc9",templateId:"template_sk5k441"}};var yG="firebase",vG="10.12.2";zn(yG,vG,"app");var Hi=new Jr("ANGULARFIRE2_VERSION");var _G=(t,e)=>{let n=e?[e]:OT(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},si=class{constructor(){return _G(wG)}},wG="app-check";function hE(){}var Gp=class{zone;delegate;constructor(e,n=ev){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},fE=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",hE,{},hE,hE)),n.pipe($e({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Va=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Gp(Zone.current)),this.insideAngular=n.run(()=>new Gp(Zone.current,Ns)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(L(be))};static \u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function EG(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function ct(t){return IG(EG())(t)}function IG(t){return function(n){return n=n.lift(new fE(t.ngZone)),n.pipe(Kn(t.outsideAngular),Pn(t.insideAngular))}}var CG=new Map,DG={activated:!1,tokenObservers:[]},bG={initialized:!1,enabled:!1};function rr(t){return CG.get(t)||Object.assign({},DG)}function $N(){return bG}var TG="https://content-firebaseappcheck.googleapis.com/v1";var SG="exchangeDebugToken",FN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},ore=24*60*60*1e3;var mE=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return x(this,null,function*(){this.stop();try{this.pending=new It,this.pending.promise.catch(n=>{}),yield AG(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new It,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function AG(t){return new Promise(e=>{setTimeout(e,t)})}var xG={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Gi=new xT("appCheck","AppCheck",xG);function qN(t){if(!rr(t).activated)throw Gi.create("use-before-activation",{appName:t.name})}function HN(r,i){return x(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let y=yield o.getHeartbeatsHeader();y&&(s["X-Firebase-Client"]=y)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(y){throw Gi.create("fetch-network-error",{originalErrorMessage:y?.message})}if(c.status!==200)throw Gi.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(y){throw Gi.create("fetch-parse-error",{originalErrorMessage:y?.message})}let d=u.ttl.match(/^([\d.]+)(s)$/);if(!d||!d[2]||isNaN(Number(d[1])))throw Gi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let h=Number(d[1])*1e3,g=Date.now();return{token:u.token,expireTimeMillis:g+h,issuedAtTimeMillis:g}})}function GN(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${TG}/projects/${n}/apps/${r}:${SG}?key=${i}`,body:{debug_token:e}}}var RG="firebase-app-check-database",MG=1,yE="firebase-app-check-store";var zp=null;function NG(){return zp||(zp=new Promise((t,e)=>{try{let n=indexedDB.open(RG,MG);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Gi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(yE,{keyPath:"compositeKey"})}}}catch(n){e(Gi.create("storage-open",{originalErrorMessage:n?.message}))}}),zp)}function PG(t,e){return kG(OG(t),e)}function kG(t,e){return x(this,null,function*(){let r=(yield NG()).transaction(yE,"readwrite"),s=r.objectStore(yE).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(Gi.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function OG(t){return`${t.options.appId}-${t.name}`}var vE=new Ci("@firebase/app-check");function gE(t,e){return ph()?PG(t,e).catch(n=>{vE.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function zN(){return $N().enabled}function WN(){return x(this,null,function*(){let t=$N();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var FG={error:"UNKNOWN_ERROR"};function LG(t){return hh.encodeString(JSON.stringify(t),!1)}function _E(t,e=!1){return x(this,null,function*(){let n=t.app;qN(n);let r=rr(n),i=r.token,s;if(i&&!vu(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(vu(c)?i=c:yield gE(n,void 0))}if(!e&&i&&vu(i))return{token:i.token};let o=!1;if(zN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=HN(GN(n,yield WN()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield gE(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield rr(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?vE.warn(c.message):vE.error(c),s=c}let a;return i?s?vu(i)?a={token:i.token,internalError:s}:a=VN(s):(a={token:i.token},r.token=i,yield gE(n,i)):a=VN(s),o&&BG(n,a),a})}function VG(t){return x(this,null,function*(){let e=t.app;qN(e);let{provider:n}=rr(e);if(zN()){let r=yield WN(),{token:i}=yield HN(GN(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function jG(t,e,n,r){let{app:i}=t,s=rr(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&vu(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),LN(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>LN(t))}function KN(t,e){let n=rr(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function LN(t){let{app:e}=t,n=rr(e),r=n.tokenRefresher;r||(r=UG(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function UG(t){let{app:e}=t;return new mE(()=>x(this,null,function*(){let n=rr(e),r;if(n.token?r=yield _E(t,!0):r=yield _E(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=rr(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},FN.RETRIAL_MIN_WAIT,FN.RETRIAL_MAX_WAIT)}function BG(t,e){let n=rr(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function vu(t){return t.expireTimeMillis-Date.now()>0}function VN(t){return{token:LG(FG),error:t}}var wE=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=rr(this.app);for(let n of e)KN(this.app,n.next);return Promise.resolve()}};function $G(t,e){return new wE(t,e)}function qG(t){return{getToken:e=>_E(t,e),getLimitedUseToken:()=>VG(t),addTokenListener:e=>jG(t,"INTERNAL",e),removeTokenListener:e=>KN(t.app,e)}}var HG="@firebase/app-check",GG="0.8.4";var zG="app-check",jN="app-check-internal";function WG(){Ss(new pn(zG,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return $G(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(jN).initialize()})),Ss(new pn(jN,t=>{let e=t.getProvider("app-check").getImmediate();return qG(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),zn(HG,GG)}WG();var KG=["localhost","0.0.0.0","127.0.0.1"],vre=typeof window<"u"&&KG.includes(window.location.hostname);var QG="firebase",YG="10.12.2";Ct.registerVersion(QG,YG,"app-compat");var ZG=["ngOnDestroy"],YN=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(ZG.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(d=>{let h=d?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,h),h})})})});var Wp=class{constructor(e){return e}},zi=new W("angularfire2.app.options"),Wi=new W("angularfire2.app.name");function Ys(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=Ct.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ct.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;JG("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Wp(o)}var JG=(t,...e)=>{ew()&&typeof console<"u"&&console[t](...e)},XG={provide:Wp,useFactory:Ys,deps:[zi,be,[new Nl,Wi]]},ZN=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:zi,useValue:n},{provide:Wi,useValue:r}]}}constructor(n){Ct.registerVersion("angularfire",Hi.full,"core"),Ct.registerVersion("angularfire",Hi.full,"app-compat"),Ct.registerVersion("angular",gR.full,n.toString())}static \u0275fac=function(r){return new(r||t)(L(st))};static \u0275mod=en({type:t});static \u0275inj=Xt({providers:[XG]})}return t})();function ja(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return e9(i,o)||(QN("error",`${e} was already initialized on the ${n} Firebase App with different settings.${t9?" You may need to reload as Firebase is not HMR aware.":""}`),QN("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function e9(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var t9=typeof module<"u"&&!!module.hot,QN=(t,...e)=>{ew()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var _u=new W("angularfire2.auth.use-emulator"),wu=new W("angularfire2.auth.settings"),Eu=new W("angularfire2.auth.tenant-id"),Iu=new W("angularfire2.auth.langugage-code"),Cu=new W("angularfire2.auth.use-device-language"),Du=new W("angularfire.auth.persistence"),bu=(t,e,n,r,i,s,o,a)=>ja(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,d]of Object.entries(o))c.settings[u]=d;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),Kp=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,d,h,g,y){let E=new Ke,D=ee(void 0).pipe(Pn(o.outsideAngular),ze(()=>s.runOutsideAngular(()=>import("./chunk-XNFI35D3.js"))),J(()=>Ys(n,s,r)),J(S=>bu(S,s,a,u,d,h,c,g)),Hh({bufferSize:1,refCount:!1}));if(ii(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ee(null);else{D.pipe(gn()).subscribe();let S=D.pipe(ze(F=>F.getRedirectResult().then(Y=>Y,()=>null)),ct,Hh({bufferSize:1,refCount:!1})),k=D.pipe(ze(F=>new pe(Y=>({unsubscribe:s.runOutsideAngular(()=>F.onAuthStateChanged(ie=>Y.next(ie),ie=>Y.error(ie),()=>Y.complete()))})))),q=D.pipe(ze(F=>new pe(Y=>({unsubscribe:s.runOutsideAngular(()=>F.onIdTokenChanged(ie=>Y.next(ie),ie=>Y.error(ie),()=>Y.complete()))}))));this.authState=S.pipe(Gh(k),Kn(o.outsideAngular),Pn(o.insideAngular)),this.user=S.pipe(Gh(q),Kn(o.outsideAngular),Pn(o.insideAngular)),this.idToken=this.user.pipe(ze(F=>F?De(F.getIdToken()):ee(null))),this.idTokenResult=this.user.pipe(ze(F=>F?De(F.getIdTokenResult()):ee(null))),this.credential=Yo(S,E,this.authState.pipe(Dt(F=>!F))).pipe(J(F=>F?.user?F:null),Kn(o.outsideAngular),Pn(o.insideAngular))}return YN(this,D,s,{spy:{apply:(S,k,q)=>{(S.startsWith("signIn")||S.startsWith("createUser"))&&q.then(F=>E.next(F))}}})}static \u0275fac=function(r){return new(r||t)(L(zi),L(Wi,8),L(st),L(be),L(Va),L(_u,8),L(wu,8),L(Eu,8),L(Iu,8),L(Cu,8),L(Du,8),L(si,8))};static \u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var XN=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},eP={};var Ki,IE;(function(){var t;function e(I,v){function w(){}w.prototype=v.prototype,I.D=v.prototype,I.prototype=new w,I.prototype.constructor=I,I.C=function(C,b,A){for(var _=Array(arguments.length-2),qr=2;qr<arguments.length;qr++)_[qr-2]=arguments[qr];return v.prototype[b].apply(C,_)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,v,w){w||(w=0);var C=Array(16);if(typeof v=="string")for(var b=0;16>b;++b)C[b]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(b=0;16>b;++b)C[b]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=I.g[0],w=I.g[1],b=I.g[2];var A=I.g[3],_=v+(A^w&(b^A))+C[0]+3614090360&4294967295;v=w+(_<<7&4294967295|_>>>25),_=A+(b^v&(w^b))+C[1]+3905402710&4294967295,A=v+(_<<12&4294967295|_>>>20),_=b+(w^A&(v^w))+C[2]+606105819&4294967295,b=A+(_<<17&4294967295|_>>>15),_=w+(v^b&(A^v))+C[3]+3250441966&4294967295,w=b+(_<<22&4294967295|_>>>10),_=v+(A^w&(b^A))+C[4]+4118548399&4294967295,v=w+(_<<7&4294967295|_>>>25),_=A+(b^v&(w^b))+C[5]+1200080426&4294967295,A=v+(_<<12&4294967295|_>>>20),_=b+(w^A&(v^w))+C[6]+2821735955&4294967295,b=A+(_<<17&4294967295|_>>>15),_=w+(v^b&(A^v))+C[7]+4249261313&4294967295,w=b+(_<<22&4294967295|_>>>10),_=v+(A^w&(b^A))+C[8]+1770035416&4294967295,v=w+(_<<7&4294967295|_>>>25),_=A+(b^v&(w^b))+C[9]+2336552879&4294967295,A=v+(_<<12&4294967295|_>>>20),_=b+(w^A&(v^w))+C[10]+4294925233&4294967295,b=A+(_<<17&4294967295|_>>>15),_=w+(v^b&(A^v))+C[11]+2304563134&4294967295,w=b+(_<<22&4294967295|_>>>10),_=v+(A^w&(b^A))+C[12]+1804603682&4294967295,v=w+(_<<7&4294967295|_>>>25),_=A+(b^v&(w^b))+C[13]+4254626195&4294967295,A=v+(_<<12&4294967295|_>>>20),_=b+(w^A&(v^w))+C[14]+2792965006&4294967295,b=A+(_<<17&4294967295|_>>>15),_=w+(v^b&(A^v))+C[15]+1236535329&4294967295,w=b+(_<<22&4294967295|_>>>10),_=v+(b^A&(w^b))+C[1]+4129170786&4294967295,v=w+(_<<5&4294967295|_>>>27),_=A+(w^b&(v^w))+C[6]+3225465664&4294967295,A=v+(_<<9&4294967295|_>>>23),_=b+(v^w&(A^v))+C[11]+643717713&4294967295,b=A+(_<<14&4294967295|_>>>18),_=w+(A^v&(b^A))+C[0]+3921069994&4294967295,w=b+(_<<20&4294967295|_>>>12),_=v+(b^A&(w^b))+C[5]+3593408605&4294967295,v=w+(_<<5&4294967295|_>>>27),_=A+(w^b&(v^w))+C[10]+38016083&4294967295,A=v+(_<<9&4294967295|_>>>23),_=b+(v^w&(A^v))+C[15]+3634488961&4294967295,b=A+(_<<14&4294967295|_>>>18),_=w+(A^v&(b^A))+C[4]+3889429448&4294967295,w=b+(_<<20&4294967295|_>>>12),_=v+(b^A&(w^b))+C[9]+568446438&4294967295,v=w+(_<<5&4294967295|_>>>27),_=A+(w^b&(v^w))+C[14]+3275163606&4294967295,A=v+(_<<9&4294967295|_>>>23),_=b+(v^w&(A^v))+C[3]+4107603335&4294967295,b=A+(_<<14&4294967295|_>>>18),_=w+(A^v&(b^A))+C[8]+1163531501&4294967295,w=b+(_<<20&4294967295|_>>>12),_=v+(b^A&(w^b))+C[13]+2850285829&4294967295,v=w+(_<<5&4294967295|_>>>27),_=A+(w^b&(v^w))+C[2]+4243563512&4294967295,A=v+(_<<9&4294967295|_>>>23),_=b+(v^w&(A^v))+C[7]+1735328473&4294967295,b=A+(_<<14&4294967295|_>>>18),_=w+(A^v&(b^A))+C[12]+2368359562&4294967295,w=b+(_<<20&4294967295|_>>>12),_=v+(w^b^A)+C[5]+4294588738&4294967295,v=w+(_<<4&4294967295|_>>>28),_=A+(v^w^b)+C[8]+2272392833&4294967295,A=v+(_<<11&4294967295|_>>>21),_=b+(A^v^w)+C[11]+1839030562&4294967295,b=A+(_<<16&4294967295|_>>>16),_=w+(b^A^v)+C[14]+4259657740&4294967295,w=b+(_<<23&4294967295|_>>>9),_=v+(w^b^A)+C[1]+2763975236&4294967295,v=w+(_<<4&4294967295|_>>>28),_=A+(v^w^b)+C[4]+1272893353&4294967295,A=v+(_<<11&4294967295|_>>>21),_=b+(A^v^w)+C[7]+4139469664&4294967295,b=A+(_<<16&4294967295|_>>>16),_=w+(b^A^v)+C[10]+3200236656&4294967295,w=b+(_<<23&4294967295|_>>>9),_=v+(w^b^A)+C[13]+681279174&4294967295,v=w+(_<<4&4294967295|_>>>28),_=A+(v^w^b)+C[0]+3936430074&4294967295,A=v+(_<<11&4294967295|_>>>21),_=b+(A^v^w)+C[3]+3572445317&4294967295,b=A+(_<<16&4294967295|_>>>16),_=w+(b^A^v)+C[6]+76029189&4294967295,w=b+(_<<23&4294967295|_>>>9),_=v+(w^b^A)+C[9]+3654602809&4294967295,v=w+(_<<4&4294967295|_>>>28),_=A+(v^w^b)+C[12]+3873151461&4294967295,A=v+(_<<11&4294967295|_>>>21),_=b+(A^v^w)+C[15]+530742520&4294967295,b=A+(_<<16&4294967295|_>>>16),_=w+(b^A^v)+C[2]+3299628645&4294967295,w=b+(_<<23&4294967295|_>>>9),_=v+(b^(w|~A))+C[0]+4096336452&4294967295,v=w+(_<<6&4294967295|_>>>26),_=A+(w^(v|~b))+C[7]+1126891415&4294967295,A=v+(_<<10&4294967295|_>>>22),_=b+(v^(A|~w))+C[14]+2878612391&4294967295,b=A+(_<<15&4294967295|_>>>17),_=w+(A^(b|~v))+C[5]+4237533241&4294967295,w=b+(_<<21&4294967295|_>>>11),_=v+(b^(w|~A))+C[12]+1700485571&4294967295,v=w+(_<<6&4294967295|_>>>26),_=A+(w^(v|~b))+C[3]+2399980690&4294967295,A=v+(_<<10&4294967295|_>>>22),_=b+(v^(A|~w))+C[10]+4293915773&4294967295,b=A+(_<<15&4294967295|_>>>17),_=w+(A^(b|~v))+C[1]+2240044497&4294967295,w=b+(_<<21&4294967295|_>>>11),_=v+(b^(w|~A))+C[8]+1873313359&4294967295,v=w+(_<<6&4294967295|_>>>26),_=A+(w^(v|~b))+C[15]+4264355552&4294967295,A=v+(_<<10&4294967295|_>>>22),_=b+(v^(A|~w))+C[6]+2734768916&4294967295,b=A+(_<<15&4294967295|_>>>17),_=w+(A^(b|~v))+C[13]+1309151649&4294967295,w=b+(_<<21&4294967295|_>>>11),_=v+(b^(w|~A))+C[4]+4149444226&4294967295,v=w+(_<<6&4294967295|_>>>26),_=A+(w^(v|~b))+C[11]+3174756917&4294967295,A=v+(_<<10&4294967295|_>>>22),_=b+(v^(A|~w))+C[2]+718787259&4294967295,b=A+(_<<15&4294967295|_>>>17),_=w+(A^(b|~v))+C[9]+3951481745&4294967295,I.g[0]=I.g[0]+v&4294967295,I.g[1]=I.g[1]+(b+(_<<21&4294967295|_>>>11))&4294967295,I.g[2]=I.g[2]+b&4294967295,I.g[3]=I.g[3]+A&4294967295}r.prototype.u=function(I,v){v===void 0&&(v=I.length);for(var w=v-this.blockSize,C=this.B,b=this.h,A=0;A<v;){if(b==0)for(;A<=w;)i(this,I,A),A+=this.blockSize;if(typeof I=="string"){for(;A<v;)if(C[b++]=I.charCodeAt(A++),b==this.blockSize){i(this,C),b=0;break}}else for(;A<v;)if(C[b++]=I[A++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=v},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var v=1;v<I.length-8;++v)I[v]=0;var w=8*this.o;for(v=I.length-8;v<I.length;++v)I[v]=w&255,w/=256;for(this.u(I),I=Array(16),v=w=0;4>v;++v)for(var C=0;32>C;C+=8)I[w++]=this.g[v]>>>C&255;return I};function s(I,v){var w=a;return Object.prototype.hasOwnProperty.call(w,I)?w[I]:w[I]=v(I)}function o(I,v){this.h=v;for(var w=[],C=!0,b=I.length-1;0<=b;b--){var A=I[b]|0;C&&A==v||(w[b]=A,C=!1)}this.g=w}var a={};function c(I){return-128<=I&&128>I?s(I,function(v){return new o([v|0],0>v?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return S(u(-I));for(var v=[],w=1,C=0;I>=w;C++)v[C]=I/w|0,w*=4294967296;return new o(v,0)}function d(I,v){if(I.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(I.charAt(0)=="-")return S(d(I.substring(1),v));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=u(Math.pow(v,8)),C=h,b=0;b<I.length;b+=8){var A=Math.min(8,I.length-b),_=parseInt(I.substring(b,b+A),v);8>A?(A=u(Math.pow(v,A)),C=C.j(A).add(u(_))):(C=C.j(w),C=C.add(u(_)))}return C}var h=c(0),g=c(1),y=c(16777216);t=o.prototype,t.m=function(){if(D(this))return-S(this).m();for(var I=0,v=1,w=0;w<this.g.length;w++){var C=this.i(w);I+=(0<=C?C:4294967296+C)*v,v*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(E(this))return"0";if(D(this))return"-"+S(this).toString(I);for(var v=u(Math.pow(I,6)),w=this,C="";;){var b=Y(w,v).g;w=k(w,b.j(v));var A=((0<w.g.length?w.g[0]:w.h)>>>0).toString(I);if(w=b,E(w))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function E(I){if(I.h!=0)return!1;for(var v=0;v<I.g.length;v++)if(I.g[v]!=0)return!1;return!0}function D(I){return I.h==-1}t.l=function(I){return I=k(this,I),D(I)?-1:E(I)?0:1};function S(I){for(var v=I.g.length,w=[],C=0;C<v;C++)w[C]=~I.g[C];return new o(w,~I.h).add(g)}t.abs=function(){return D(this)?S(this):this},t.add=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],C=0,b=0;b<=v;b++){var A=C+(this.i(b)&65535)+(I.i(b)&65535),_=(A>>>16)+(this.i(b)>>>16)+(I.i(b)>>>16);C=_>>>16,A&=65535,_&=65535,w[b]=_<<16|A}return new o(w,w[w.length-1]&-2147483648?-1:0)};function k(I,v){return I.add(S(v))}t.j=function(I){if(E(this)||E(I))return h;if(D(this))return D(I)?S(this).j(S(I)):S(S(this).j(I));if(D(I))return S(this.j(S(I)));if(0>this.l(y)&&0>I.l(y))return u(this.m()*I.m());for(var v=this.g.length+I.g.length,w=[],C=0;C<2*v;C++)w[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<I.g.length;b++){var A=this.i(C)>>>16,_=this.i(C)&65535,qr=I.i(b)>>>16,Hc=I.i(b)&65535;w[2*C+2*b]+=_*Hc,q(w,2*C+2*b),w[2*C+2*b+1]+=A*Hc,q(w,2*C+2*b+1),w[2*C+2*b+1]+=_*qr,q(w,2*C+2*b+1),w[2*C+2*b+2]+=A*qr,q(w,2*C+2*b+2)}for(C=0;C<v;C++)w[C]=w[2*C+1]<<16|w[2*C];for(C=v;C<2*v;C++)w[C]=0;return new o(w,0)};function q(I,v){for(;(I[v]&65535)!=I[v];)I[v+1]+=I[v]>>>16,I[v]&=65535,v++}function F(I,v){this.g=I,this.h=v}function Y(I,v){if(E(v))throw Error("division by zero");if(E(I))return new F(h,h);if(D(I))return v=Y(S(I),v),new F(S(v.g),S(v.h));if(D(v))return v=Y(I,S(v)),new F(S(v.g),v.h);if(30<I.g.length){if(D(I)||D(v))throw Error("slowDivide_ only works with positive integers.");for(var w=g,C=v;0>=C.l(I);)w=ie(w),C=ie(C);var b=ne(w,1),A=ne(C,1);for(C=ne(C,2),w=ne(w,2);!E(C);){var _=A.add(C);0>=_.l(I)&&(b=b.add(w),A=_),C=ne(C,1),w=ne(w,1)}return v=k(I,b.j(v)),new F(b,v)}for(b=h;0<=I.l(v);){for(w=Math.max(1,Math.floor(I.m()/v.m())),C=Math.ceil(Math.log(w)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=u(w),_=A.j(v);D(_)||0<_.l(I);)w-=C,A=u(w),_=A.j(v);E(A)&&(A=g),b=b.add(A),I=k(I,_)}return new F(b,I)}t.A=function(I){return Y(this,I).h},t.and=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],C=0;C<v;C++)w[C]=this.i(C)&I.i(C);return new o(w,this.h&I.h)},t.or=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],C=0;C<v;C++)w[C]=this.i(C)|I.i(C);return new o(w,this.h|I.h)},t.xor=function(I){for(var v=Math.max(this.g.length,I.g.length),w=[],C=0;C<v;C++)w[C]=this.i(C)^I.i(C);return new o(w,this.h^I.h)};function ie(I){for(var v=I.g.length+1,w=[],C=0;C<v;C++)w[C]=I.i(C)<<1|I.i(C-1)>>>31;return new o(w,I.h)}function ne(I,v){var w=v>>5;v%=32;for(var C=I.g.length-w,b=[],A=0;A<C;A++)b[A]=0<v?I.i(A+w)>>>v|I.i(A+w+1)<<32-v:I.i(A+w);return new o(b,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,IE=eP.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,Ki=eP.Integer=o}).apply(typeof XN<"u"?XN:typeof self<"u"?self:typeof window<"u"?window:{});var Qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},oi={};var CE,DE,Ua,bE,Tu,Yp,TE,SE,AE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,p){return l==Array.prototype||l==Object.prototype||(l[f]=p.value),l};function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qp=="object"&&Qp];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function i(l,f){if(f)e:{var p=r;l=l.split(".");for(var m=0;m<l.length-1;m++){var T=l[m];if(!(T in p))break e;p=p[T]}l=l[l.length-1],m=p[l],f=f(m),f!=m&&f!=null&&e(p,l,{configurable:!0,writable:!0,value:f})}}function s(l,f){l instanceof String&&(l+="");var p=0,m=!1,T={next:function(){if(!m&&p<l.length){var M=p++;return{value:f(M,l[M]),done:!1}}return m=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(l){return l||function(){return s(this,function(f,p){return p})}});var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function u(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function d(l,f,p){return l.call.apply(l.bind,arguments)}function h(l,f,p){if(!l)throw Error();if(2<arguments.length){var m=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,m),l.apply(f,T)}}return function(){return l.apply(f,arguments)}}function g(l,f,p){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,g.apply(null,arguments)}function y(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var m=p.slice();return m.push.apply(m,arguments),l.apply(this,m)}}function E(l,f){function p(){}p.prototype=f.prototype,l.aa=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Qb=function(m,T,M){for(var H=Array(arguments.length-2),Le=2;Le<arguments.length;Le++)H[Le-2]=arguments[Le];return f.prototype[T].apply(m,H)}}function D(l){let f=l.length;if(0<f){let p=Array(f);for(let m=0;m<f;m++)p[m]=l[m];return p}return[]}function S(l,f){for(let p=1;p<arguments.length;p++){let m=arguments[p];if(c(m)){let T=l.length||0,M=m.length||0;l.length=T+M;for(let H=0;H<M;H++)l[T+H]=m[H]}else l.push(m)}}class k{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function q(l){return/^[\s\xa0]*$/.test(l)}function F(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function Y(l){return Y[" "](l),l}Y[" "]=function(){};var ie=F().indexOf("Gecko")!=-1&&!(F().toLowerCase().indexOf("webkit")!=-1&&F().indexOf("Edge")==-1)&&!(F().indexOf("Trident")!=-1||F().indexOf("MSIE")!=-1)&&F().indexOf("Edge")==-1;function ne(l,f,p){for(let m in l)f.call(p,l[m],m,l)}function I(l,f){for(let p in l)f.call(void 0,l[p],p,l)}function v(l){let f={};for(let p in l)f[p]=l[p];return f}let w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let p,m;for(let T=1;T<arguments.length;T++){m=arguments[T];for(p in m)l[p]=m[p];for(let M=0;M<w.length;M++)p=w[M],Object.prototype.hasOwnProperty.call(m,p)&&(l[p]=m[p])}}function b(l){var f=1;l=l.split(":");let p=[];for(;0<f&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function A(l){a.setTimeout(()=>{throw l},0)}function _(){var l=uy;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class qr{constructor(){this.h=this.g=null}add(f,p){let m=Hc.get();m.set(f,p),this.h?this.h.next=m:this.g=m,this.h=m}}var Hc=new k(()=>new fV,l=>l.reset());class fV{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let Gc,zc=!1,uy=new qr,wb=()=>{let l=a.Promise.resolve(void 0);Gc=()=>{l.then(pV)}};var pV=()=>{for(var l;l=_();){try{l.h.call(l.g)}catch(p){A(p)}var f=Hc;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}zc=!1};function vi(){this.s=this.s,this.C=this.C}vi.prototype.s=!1,vi.prototype.ma=function(){this.s||(this.s=!0,this.N())},vi.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Vt(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}Vt.prototype.h=function(){this.defaultPrevented=!0};var gV=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let p=()=>{};a.addEventListener("test",p,f),a.removeEventListener("test",p,f)}catch{}return l}();function Wc(l,f){if(Vt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var p=this.type=l.type,m=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(ie){e:{try{Y(f.nodeName);var T=!0;break e}catch{}T=!1}T||(f=null)}}else p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement);this.relatedTarget=f,m?(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:mV[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Wc.aa.h.call(this)}}E(Wc,Vt);var mV={2:"touch",3:"pen",4:"mouse"};Wc.prototype.h=function(){Wc.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Kc="closure_listenable_"+(1e6*Math.random()|0),yV=0;function vV(l,f,p,m,T){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!m,this.ha=T,this.key=++yV,this.da=this.fa=!1}function Kd(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function Qd(l){this.src=l,this.g={},this.h=0}Qd.prototype.add=function(l,f,p,m,T){var M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);var H=hy(l,f,m,T);return-1<H?(f=l[H],p||(f.fa=!1)):(f=new vV(f,this.src,M,!!m,T),f.fa=p,l.push(f)),f};function dy(l,f){var p=f.type;if(p in l.g){var m=l.g[p],T=Array.prototype.indexOf.call(m,f,void 0),M;(M=0<=T)&&Array.prototype.splice.call(m,T,1),M&&(Kd(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function hy(l,f,p,m){for(var T=0;T<l.length;++T){var M=l[T];if(!M.da&&M.listener==f&&M.capture==!!p&&M.ha==m)return T}return-1}var fy="closure_lm_"+(1e6*Math.random()|0),py={};function Eb(l,f,p,m,T){if(m&&m.once)return Cb(l,f,p,m,T);if(Array.isArray(f)){for(var M=0;M<f.length;M++)Eb(l,f[M],p,m,T);return null}return p=vy(p),l&&l[Kc]?l.K(f,p,u(m)?!!m.capture:!!m,T):Ib(l,f,p,!1,m,T)}function Ib(l,f,p,m,T,M){if(!f)throw Error("Invalid event type");var H=u(T)?!!T.capture:!!T,Le=my(l);if(Le||(l[fy]=Le=new Qd(l)),p=Le.add(f,p,m,H,M),p.proxy)return p;if(m=_V(),p.proxy=m,m.src=l,m.listener=p,l.addEventListener)gV||(T=H),T===void 0&&(T=!1),l.addEventListener(f.toString(),m,T);else if(l.attachEvent)l.attachEvent(bb(f.toString()),m);else if(l.addListener&&l.removeListener)l.addListener(m);else throw Error("addEventListener and attachEvent are unavailable.");return p}function _V(){function l(p){return f.call(l.src,l.listener,p)}let f=wV;return l}function Cb(l,f,p,m,T){if(Array.isArray(f)){for(var M=0;M<f.length;M++)Cb(l,f[M],p,m,T);return null}return p=vy(p),l&&l[Kc]?l.L(f,p,u(m)?!!m.capture:!!m,T):Ib(l,f,p,!0,m,T)}function Db(l,f,p,m,T){if(Array.isArray(f))for(var M=0;M<f.length;M++)Db(l,f[M],p,m,T);else m=u(m)?!!m.capture:!!m,p=vy(p),l&&l[Kc]?(l=l.i,f=String(f).toString(),f in l.g&&(M=l.g[f],p=hy(M,p,m,T),-1<p&&(Kd(M[p]),Array.prototype.splice.call(M,p,1),M.length==0&&(delete l.g[f],l.h--)))):l&&(l=my(l))&&(f=l.g[f.toString()],l=-1,f&&(l=hy(f,p,m,T)),(p=-1<l?f[l]:null)&&gy(p))}function gy(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Kc])dy(f.i,l);else{var p=l.type,m=l.proxy;f.removeEventListener?f.removeEventListener(p,m,l.capture):f.detachEvent?f.detachEvent(bb(p),m):f.addListener&&f.removeListener&&f.removeListener(m),(p=my(f))?(dy(p,l),p.h==0&&(p.src=null,f[fy]=null)):Kd(l)}}}function bb(l){return l in py?py[l]:py[l]="on"+l}function wV(l,f){if(l.da)l=!0;else{f=new Wc(f,this);var p=l.listener,m=l.ha||l.src;l.fa&&gy(l),l=p.call(m,f)}return l}function my(l){return l=l[fy],l instanceof Qd?l:null}var yy="__closure_events_fn_"+(1e9*Math.random()>>>0);function vy(l){return typeof l=="function"?l:(l[yy]||(l[yy]=function(f){return l.handleEvent(f)}),l[yy])}function jt(){vi.call(this),this.i=new Qd(this),this.M=this,this.F=null}E(jt,vi),jt.prototype[Kc]=!0,jt.prototype.removeEventListener=function(l,f,p,m){Db(this,l,f,p,m)};function Kt(l,f){var p,m=l.F;if(m)for(p=[];m;m=m.F)p.push(m);if(l=l.M,m=f.type||f,typeof f=="string")f=new Vt(f,l);else if(f instanceof Vt)f.target=f.target||l;else{var T=f;f=new Vt(m,l),C(f,T)}if(T=!0,p)for(var M=p.length-1;0<=M;M--){var H=f.g=p[M];T=Yd(H,m,!0,f)&&T}if(H=f.g=l,T=Yd(H,m,!0,f)&&T,T=Yd(H,m,!1,f)&&T,p)for(M=0;M<p.length;M++)H=f.g=p[M],T=Yd(H,m,!1,f)&&T}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var p=l.g[f],m=0;m<p.length;m++)Kd(p[m]);delete l.g[f],l.h--}}this.F=null},jt.prototype.K=function(l,f,p,m){return this.i.add(String(l),f,!1,p,m)},jt.prototype.L=function(l,f,p,m){return this.i.add(String(l),f,!0,p,m)};function Yd(l,f,p,m){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var T=!0,M=0;M<f.length;++M){var H=f[M];if(H&&!H.da&&H.capture==p){var Le=H.listener,Mt=H.ha||H.src;H.fa&&dy(l.i,H),T=Le.call(Mt,m)!==!1&&T}}return T&&!m.defaultPrevented}function Tb(l,f,p){if(typeof l=="function")p&&(l=g(l,p));else if(l&&typeof l.handleEvent=="function")l=g(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function Sb(l){l.g=Tb(()=>{l.g=null,l.i&&(l.i=!1,Sb(l))},l.l);let f=l.h;l.h=null,l.m.apply(null,f)}class EV extends vi{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Sb(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qc(l){vi.call(this),this.h=l,this.g={}}E(Qc,vi);var Ab=[];function xb(l){ne(l.g,function(f,p){this.g.hasOwnProperty(p)&&gy(f)},l),l.g={}}Qc.prototype.N=function(){Qc.aa.N.call(this),xb(this)},Qc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _y=a.JSON.stringify,IV=a.JSON.parse,CV=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function wy(){}wy.prototype.h=null;function Rb(l){return l.h||(l.h=l.i())}function Mb(){}var Yc={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ey(){Vt.call(this,"d")}E(Ey,Vt);function Iy(){Vt.call(this,"c")}E(Iy,Vt);var Cs={},Nb=null;function Zd(){return Nb=Nb||new jt}Cs.La="serverreachability";function Pb(l){Vt.call(this,Cs.La,l)}E(Pb,Vt);function Zc(l){let f=Zd();Kt(f,new Pb(f))}Cs.STAT_EVENT="statevent";function kb(l,f){Vt.call(this,Cs.STAT_EVENT,l),this.stat=f}E(kb,Vt);function Qt(l){let f=Zd();Kt(f,new kb(f,l))}Cs.Ma="timingevent";function Ob(l,f){Vt.call(this,Cs.Ma,l),this.size=f}E(Ob,Vt);function Jc(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function Xc(){this.g=!0}Xc.prototype.xa=function(){this.g=!1};function DV(l,f,p,m,T,M){l.info(function(){if(l.g)if(M)for(var H="",Le=M.split("&"),Mt=0;Mt<Le.length;Mt++){var Re=Le[Mt].split("=");if(1<Re.length){var Ut=Re[0];Re=Re[1];var Bt=Ut.split("_");H=2<=Bt.length&&Bt[1]=="type"?H+(Ut+"="+Re+"&"):H+(Ut+"=redacted&")}}else H=null;else H=M;return"XMLHTTP REQ ("+m+") [attempt "+T+"]: "+f+`
`+p+`
`+H})}function bV(l,f,p,m,T,M,H){l.info(function(){return"XMLHTTP RESP ("+m+") [ attempt "+T+"]: "+f+`
`+p+`
`+M+" "+H})}function Po(l,f,p,m){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+SV(l,p)+(m?" "+m:"")})}function TV(l,f){l.info(function(){return"TIMEOUT: "+f})}Xc.prototype.info=function(){};function SV(l,f){if(!l.g)return f;if(!f)return null;try{var p=JSON.parse(f);if(p){for(l=0;l<p.length;l++)if(Array.isArray(p[l])){var m=p[l];if(!(2>m.length)){var T=m[1];if(Array.isArray(T)&&!(1>T.length)){var M=T[0];if(M!="noop"&&M!="stop"&&M!="close")for(var H=1;H<T.length;H++)T[H]=""}}}}return _y(p)}catch{return f}}var Jd={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fb={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Cy;function Xd(){}E(Xd,wy),Xd.prototype.g=function(){return new XMLHttpRequest},Xd.prototype.i=function(){return{}},Cy=new Xd;function _i(l,f,p,m){this.j=l,this.i=f,this.l=p,this.R=m||1,this.U=new Qc(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Lb}function Lb(){this.i=null,this.g="",this.h=!1}var Vb={},Dy={};function by(l,f,p){l.L=1,l.v=rh(Hr(f)),l.m=p,l.P=!0,jb(l,null)}function jb(l,f){l.F=Date.now(),eh(l),l.A=Hr(l.v);var p=l.A,m=l.R;Array.isArray(m)||(m=[String(m)]),Xb(p.i,"t",m),l.C=0,p=l.j.J,l.h=new Lb,l.g=yT(l.j,p?f:null,!l.m),0<l.O&&(l.M=new EV(g(l.Y,l,l.g),l.O)),f=l.U,p=l.g,m=l.ca;var T="readystatechange";Array.isArray(T)||(T&&(Ab[0]=T.toString()),T=Ab);for(var M=0;M<T.length;M++){var H=Eb(p,T[M],m||f.handleEvent,!1,f.h||f);if(!H)break;f.g[H.key]=H}f=l.H?v(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),Zc(),DV(l.i,l.u,l.A,l.l,l.R,l.m)}_i.prototype.ca=function(l){l=l.target;let f=this.M;f&&Gr(l)==3?f.j():this.Y(l)},_i.prototype.Y=function(l){try{if(l==this.g)e:{let Bt=Gr(this.g);var f=this.g.Ba();let Fo=this.g.Z();if(!(3>Bt)&&(Bt!=3||this.g&&(this.h.h||this.g.oa()||oT(this.g)))){this.J||Bt!=4||f==7||(f==8||0>=Fo?Zc(3):Zc(2)),Ty(this);var p=this.g.Z();this.X=p;t:if(Ub(this)){var m=oT(this.g);l="";var T=m.length,M=Gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ds(this),el(this);var H="";break t}this.h.i=new a.TextDecoder}for(f=0;f<T;f++)this.h.h=!0,l+=this.h.i.decode(m[f],{stream:!(M&&f==T-1)});m.length=0,this.h.g+=l,this.C=0,H=this.h.g}else H=this.g.oa();if(this.o=p==200,bV(this.i,this.u,this.A,this.l,this.R,Bt,p),this.o){if(this.T&&!this.K){t:{if(this.g){var Le,Mt=this.g;if((Le=Mt.g?Mt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(Le)){var Re=Le;break t}}Re=null}if(p=Re)Po(this.i,this.l,p,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Sy(this,p);else{this.o=!1,this.s=3,Qt(12),Ds(this),el(this);break e}}if(this.P){p=!0;let Gn;for(;!this.J&&this.C<H.length;)if(Gn=AV(this,H),Gn==Dy){Bt==4&&(this.s=4,Qt(14),p=!1),Po(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Vb){this.s=4,Qt(15),Po(this.i,this.l,H,"[Invalid Chunk]"),p=!1;break}else Po(this.i,this.l,Gn,null),Sy(this,Gn);if(Ub(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Bt!=4||H.length!=0||this.h.h||(this.s=1,Qt(16),p=!1),this.o=this.o&&p,!p)Po(this.i,this.l,H,"[Invalid Chunked Response]"),Ds(this),el(this);else if(0<H.length&&!this.W){this.W=!0;var Ut=this.j;Ut.g==this&&Ut.ba&&!Ut.M&&(Ut.j.info("Great, no buffering proxy detected. Bytes received: "+H.length),Py(Ut),Ut.M=!0,Qt(11))}}else Po(this.i,this.l,H,null),Sy(this,H);Bt==4&&Ds(this),this.o&&!this.J&&(Bt==4?fT(this.j,this):(this.o=!1,eh(this)))}else GV(this.g),p==400&&0<H.indexOf("Unknown SID")?(this.s=3,Qt(12)):(this.s=0,Qt(13)),Ds(this),el(this)}}}catch{}finally{}};function Ub(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function AV(l,f){var p=l.C,m=f.indexOf(`
`,p);return m==-1?Dy:(p=Number(f.substring(p,m)),isNaN(p)?Vb:(m+=1,m+p>f.length?Dy:(f=f.slice(m,m+p),l.C=m+p,f)))}_i.prototype.cancel=function(){this.J=!0,Ds(this)};function eh(l){l.S=Date.now()+l.I,Bb(l,l.I)}function Bb(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=Jc(g(l.ba,l),f)}function Ty(l){l.B&&(a.clearTimeout(l.B),l.B=null)}_i.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(TV(this.i,this.A),this.L!=2&&(Zc(),Qt(17)),Ds(this),this.s=2,el(this)):Bb(this,this.S-l)};function el(l){l.j.G==0||l.J||fT(l.j,l)}function Ds(l){Ty(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,xb(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function Sy(l,f){try{var p=l.j;if(p.G!=0&&(p.g==l||Ay(p.h,l))){if(!l.K&&Ay(p.h,l)&&p.G==3){try{var m=p.Da.g.parse(f)}catch{m=null}if(Array.isArray(m)&&m.length==3){var T=m;if(T[0]==0){e:if(!p.u){if(p.g)if(p.g.F+3e3<l.F)ch(p),oh(p);else break e;Ny(p),Qt(18)}}else p.za=T[1],0<p.za-p.T&&37500>T[2]&&p.F&&p.v==0&&!p.C&&(p.C=Jc(g(p.Za,p),6e3));if(1>=Hb(p.h)&&p.ca){try{p.ca()}catch{}p.ca=void 0}}else Ts(p,11)}else if((l.K||p.g==l)&&ch(p),!q(f))for(T=p.Da.g.parse(f),f=0;f<T.length;f++){let Re=T[f];if(p.T=Re[0],Re=Re[1],p.G==2)if(Re[0]=="c"){p.K=Re[1],p.ia=Re[2];let Ut=Re[3];Ut!=null&&(p.la=Ut,p.j.info("VER="+p.la));let Bt=Re[4];Bt!=null&&(p.Aa=Bt,p.j.info("SVER="+p.Aa));let Fo=Re[5];Fo!=null&&typeof Fo=="number"&&0<Fo&&(m=1.5*Fo,p.L=m,p.j.info("backChannelRequestTimeoutMs_="+m)),m=p;let Gn=l.g;if(Gn){let uh=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(uh){var M=m.h;M.g||uh.indexOf("spdy")==-1&&uh.indexOf("quic")==-1&&uh.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(xy(M,M.h),M.h=null))}if(m.D){let ky=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;ky&&(m.ya=ky,Ge(m.I,m.D,ky))}}p.G=3,p.l&&p.l.ua(),p.ba&&(p.R=Date.now()-l.F,p.j.info("Handshake RTT: "+p.R+"ms")),m=p;var H=l;if(m.qa=mT(m,m.J?m.ia:null,m.W),H.K){Gb(m.h,H);var Le=H,Mt=m.L;Mt&&(Le.I=Mt),Le.B&&(Ty(Le),eh(Le)),m.g=H}else dT(m);0<p.i.length&&ah(p)}else Re[0]!="stop"&&Re[0]!="close"||Ts(p,7);else p.G==3&&(Re[0]=="stop"||Re[0]=="close"?Re[0]=="stop"?Ts(p,7):My(p):Re[0]!="noop"&&p.l&&p.l.ta(Re),p.v=0)}}Zc(4)}catch{}}var xV=class{constructor(l,f){this.g=l,this.map=f}};function $b(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qb(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Hb(l){return l.h?1:l.g?l.g.size:0}function Ay(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function xy(l,f){l.g?l.g.add(f):l.h=f}function Gb(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}$b.prototype.cancel=function(){if(this.i=zb(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function zb(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(let p of l.g.values())f=f.concat(p.D);return f}return D(l.i)}function RV(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],p=l.length,m=0;m<p;m++)f.push(l[m]);return f}f=[],p=0;for(m in l)f[p++]=l[m];return f}function MV(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var p=0;p<l;p++)f.push(p);return f}f=[],p=0;for(let m in l)f[p++]=m;return f}}}function Wb(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var p=MV(l),m=RV(l),T=m.length,M=0;M<T;M++)f.call(void 0,m[M],p&&p[M],l)}var Kb=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function NV(l,f){if(l){l=l.split("&");for(var p=0;p<l.length;p++){var m=l[p].indexOf("="),T=null;if(0<=m){var M=l[p].substring(0,m);T=l[p].substring(m+1)}else M=l[p];f(M,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function bs(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof bs){this.h=l.h,th(this,l.j),this.o=l.o,this.g=l.g,nh(this,l.s),this.l=l.l;var f=l.i,p=new rl;p.i=f.i,f.g&&(p.g=new Map(f.g),p.h=f.h),Qb(this,p),this.m=l.m}else l&&(f=String(l).match(Kb))?(this.h=!1,th(this,f[1]||"",!0),this.o=tl(f[2]||""),this.g=tl(f[3]||"",!0),nh(this,f[4]),this.l=tl(f[5]||"",!0),Qb(this,f[6]||"",!0),this.m=tl(f[7]||"")):(this.h=!1,this.i=new rl(null,this.h))}bs.prototype.toString=function(){var l=[],f=this.j;f&&l.push(nl(f,Yb,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(nl(f,Yb,!0),"@"),l.push(encodeURIComponent(String(p)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.s,p!=null&&l.push(":",String(p))),(p=this.l)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(nl(p,p.charAt(0)=="/"?OV:kV,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",nl(p,LV)),l.join("")};function Hr(l){return new bs(l)}function th(l,f,p){l.j=p?tl(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function nh(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function Qb(l,f,p){f instanceof rl?(l.i=f,VV(l.i,l.h)):(p||(f=nl(f,FV)),l.i=new rl(f,l.h))}function Ge(l,f,p){l.i.set(f,p)}function rh(l){return Ge(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function tl(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function nl(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,PV),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function PV(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Yb=/[#\/\?@]/g,kV=/[#\?:]/g,OV=/[#\?]/g,FV=/[#\?@]/g,LV=/#/g;function rl(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function wi(l){l.g||(l.g=new Map,l.h=0,l.i&&NV(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}t=rl.prototype,t.add=function(l,f){wi(this),this.i=null,l=ko(this,l);var p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function Zb(l,f){wi(l),f=ko(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Jb(l,f){return wi(l),f=ko(l,f),l.g.has(f)}t.forEach=function(l,f){wi(this),this.g.forEach(function(p,m){p.forEach(function(T){l.call(f,T,m,this)},this)},this)},t.na=function(){wi(this);let l=Array.from(this.g.values()),f=Array.from(this.g.keys()),p=[];for(let m=0;m<f.length;m++){let T=l[m];for(let M=0;M<T.length;M++)p.push(f[m])}return p},t.V=function(l){wi(this);let f=[];if(typeof l=="string")Jb(this,l)&&(f=f.concat(this.g.get(ko(this,l))));else{l=Array.from(this.g.values());for(let p=0;p<l.length;p++)f=f.concat(l[p])}return f},t.set=function(l,f){return wi(this),this.i=null,l=ko(this,l),Jb(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function Xb(l,f,p){Zb(l,f),0<p.length&&(l.i=null,l.g.set(ko(l,f),D(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],f=Array.from(this.g.keys());for(var p=0;p<f.length;p++){var m=f[p];let M=encodeURIComponent(String(m)),H=this.V(m);for(m=0;m<H.length;m++){var T=M;H[m]!==""&&(T+="="+encodeURIComponent(String(H[m]))),l.push(T)}}return this.i=l.join("&")};function ko(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function VV(l,f){f&&!l.j&&(wi(l),l.i=null,l.g.forEach(function(p,m){var T=m.toLowerCase();m!=T&&(Zb(this,m),Xb(this,T,p))},l)),l.j=f}function jV(l,f){let p=new Xc;if(a.Image){let m=new Image;m.onload=y(Ei,p,"TestLoadImage: loaded",!0,f,m),m.onerror=y(Ei,p,"TestLoadImage: error",!1,f,m),m.onabort=y(Ei,p,"TestLoadImage: abort",!1,f,m),m.ontimeout=y(Ei,p,"TestLoadImage: timeout",!1,f,m),a.setTimeout(function(){m.ontimeout&&m.ontimeout()},1e4),m.src=l}else f(!1)}function UV(l,f){let p=new Xc,m=new AbortController,T=setTimeout(()=>{m.abort(),Ei(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:m.signal}).then(M=>{clearTimeout(T),M.ok?Ei(p,"TestPingServer: ok",!0,f):Ei(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(T),Ei(p,"TestPingServer: error",!1,f)})}function Ei(l,f,p,m,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),m(p)}catch{}}function BV(){this.g=new CV}function $V(l,f,p){let m=p||"";try{Wb(l,function(T,M){let H=T;u(T)&&(H=_y(T)),f.push(m+M+"="+encodeURIComponent(H))})}catch(T){throw f.push(m+"type="+encodeURIComponent("_badmap")),T}}function il(l){this.l=l.Ub||null,this.j=l.eb||!1}E(il,wy),il.prototype.g=function(){return new ih(this.l,this.j)},il.prototype.i=function(l){return function(){return l}}({});function ih(l,f){jt.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(ih,jt),t=ih.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,ol(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,sl(this)),this.readyState=0},t.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ol(this)),this.g&&(this.readyState=3,ol(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;eT(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function eT(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}t.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?sl(this):ol(this),this.readyState==3&&eT(this)}},t.Ra=function(l){this.g&&(this.response=this.responseText=l,sl(this))},t.Qa=function(l){this.g&&(this.response=l,sl(this))},t.ga=function(){this.g&&sl(this)};function sl(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ol(l)}t.setRequestHeader=function(l,f){this.u.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function ol(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(ih.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function tT(l){let f="";return ne(l,function(p,m){f+=m,f+=":",f+=p,f+=`\r
`}),f}function Ry(l,f,p){e:{for(m in p){var m=!1;break e}m=!0}m||(p=tT(p),typeof l=="string"?p!=null&&encodeURIComponent(String(p)):Ge(l,f,p))}function et(l){jt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(et,jt);var qV=/^https?$/i,HV=["POST","PUT"];t=et.prototype,t.Ha=function(l){this.J=l},t.ea=function(l,f,p,m){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Cy.g(),this.v=this.o?Rb(this.o):Rb(Cy),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(M){nT(this,M);return}if(l=p||"",p=new Map(this.headers),m)if(Object.getPrototypeOf(m)===Object.prototype)for(var T in m)p.set(T,m[T]);else if(typeof m.keys=="function"&&typeof m.get=="function")for(let M of m.keys())p.set(M,m.get(M));else throw Error("Unknown input type for opt_headers: "+String(m));m=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),T=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(HV,f,void 0))||m||T||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[M,H]of p)this.g.setRequestHeader(M,H);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{sT(this),this.u=!0,this.g.send(l),this.u=!1}catch(M){nT(this,M)}};function nT(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,rT(l),sh(l)}function rT(l){l.A||(l.A=!0,Kt(l,"complete"),Kt(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,Kt(this,"complete"),Kt(this,"abort"),sh(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),sh(this,!0)),et.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?iT(this):this.bb())},t.bb=function(){iT(this)};function iT(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Gr(l)!=4||l.Z()!=2)){if(l.u&&Gr(l)==4)Tb(l.Ea,0,l);else if(Kt(l,"readystatechange"),Gr(l)==4){l.h=!1;try{let H=l.Z();e:switch(H){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var m;if(m=H===0){var T=String(l.D).match(Kb)[1]||null;!T&&a.self&&a.self.location&&(T=a.self.location.protocol.slice(0,-1)),m=!qV.test(T?T.toLowerCase():"")}p=m}if(p)Kt(l,"complete"),Kt(l,"success");else{l.m=6;try{var M=2<Gr(l)?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.Z()+"]",rT(l)}}finally{sh(l)}}}}function sh(l,f){if(l.g){sT(l);let p=l.g,m=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||Kt(l,"ready");try{p.onreadystatechange=m}catch{}}}function sT(l){l.I&&(a.clearTimeout(l.I),l.I=null)}t.isActive=function(){return!!this.g};function Gr(l){return l.g?l.g.readyState:0}t.Z=function(){try{return 2<Gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),IV(f)}};function oT(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function GV(l){let f={};l=(l.g&&2<=Gr(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let m=0;m<l.length;m++){if(q(l[m]))continue;var p=b(l[m]);let T=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();let M=f[T]||[];f[T]=M,M.push(p)}I(f,function(m){return m.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function al(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function aT(l){this.Aa=0,this.i=[],this.j=new Xc,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=al("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=al("baseRetryDelayMs",5e3,l),this.cb=al("retryDelaySeedMs",1e4,l),this.Wa=al("forwardChannelMaxRetries",2,l),this.wa=al("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new $b(l&&l.concurrentRequestLimit),this.Da=new BV,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=aT.prototype,t.la=8,t.G=1,t.connect=function(l,f,p,m){Qt(0),this.W=l,this.H=f||{},p&&m!==void 0&&(this.H.OSID=p,this.H.OAID=m),this.F=this.X,this.I=mT(this,null,this.W),ah(this)};function My(l){if(cT(l),l.G==3){var f=l.U++,p=Hr(l.I);if(Ge(p,"SID",l.K),Ge(p,"RID",f),Ge(p,"TYPE","terminate"),cl(l,p),f=new _i(l,l.j,f),f.L=2,f.v=rh(Hr(p)),p=!1,a.navigator&&a.navigator.sendBeacon)try{p=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!p&&a.Image&&(new Image().src=f.v,p=!0),p||(f.g=yT(f.j,null),f.g.ea(f.v)),f.F=Date.now(),eh(f)}gT(l)}function oh(l){l.g&&(Py(l),l.g.cancel(),l.g=null)}function cT(l){oh(l),l.u&&(a.clearTimeout(l.u),l.u=null),ch(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function ah(l){if(!qb(l.h)&&!l.s){l.s=!0;var f=l.Ga;Gc||wb(),zc||(Gc(),zc=!0),uy.add(f,l),l.B=0}}function zV(l,f){return Hb(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=Jc(g(l.Ga,l,f),pT(l,l.B)),l.B++,!0)}t.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let T=new _i(this,this.j,l),M=this.o;if(this.S&&(M?(M=v(M),C(M,this.S)):M=this.S),this.m!==null||this.O||(T.H=M,M=null),this.P)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var m=this.i[p];if("__data__"in m.map&&(m=m.map.__data__,typeof m=="string")){m=m.length;break t}m=void 0}if(m===void 0)break;if(f+=m,4096<f){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=uT(this,T,f),p=Hr(this.I),Ge(p,"RID",l),Ge(p,"CVER",22),this.D&&Ge(p,"X-HTTP-Session-Id",this.D),cl(this,p),M&&(this.O?f="headers="+encodeURIComponent(String(tT(M)))+"&"+f:this.m&&Ry(p,this.m,M)),xy(this.h,T),this.Ua&&Ge(p,"TYPE","init"),this.P?(Ge(p,"$req",f),Ge(p,"SID","null"),T.T=!0,by(T,p,null)):by(T,p,f),this.G=2}}else this.G==3&&(l?lT(this,l):this.i.length==0||qb(this.h)||lT(this))};function lT(l,f){var p;f?p=f.l:p=l.U++;let m=Hr(l.I);Ge(m,"SID",l.K),Ge(m,"RID",p),Ge(m,"AID",l.T),cl(l,m),l.m&&l.o&&Ry(m,l.m,l.o),p=new _i(l,l.j,p,l.B+1),l.m===null&&(p.H=l.o),f&&(l.i=f.D.concat(l.i)),f=uT(l,p,1e3),p.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),xy(l.h,p),by(p,m,f)}function cl(l,f){l.H&&ne(l.H,function(p,m){Ge(f,m,p)}),l.l&&Wb({},function(p,m){Ge(f,m,p)})}function uT(l,f,p){p=Math.min(l.i.length,p);var m=l.l?g(l.l.Na,l.l,l):null;e:{var T=l.i;let M=-1;for(;;){let H=["count="+p];M==-1?0<p?(M=T[0].g,H.push("ofs="+M)):M=0:H.push("ofs="+M);let Le=!0;for(let Mt=0;Mt<p;Mt++){let Re=T[Mt].g,Ut=T[Mt].map;if(Re-=M,0>Re)M=Math.max(0,T[Mt].g-100),Le=!1;else try{$V(Ut,H,"req"+Re+"_")}catch{m&&m(Ut)}}if(Le){m=H.join("&");break e}}}return l=l.i.splice(0,p),f.D=l,m}function dT(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;Gc||wb(),zc||(Gc(),zc=!0),uy.add(f,l),l.v=0}}function Ny(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=Jc(g(l.Fa,l),pT(l,l.v)),l.v++,!0)}t.Fa=function(){if(this.u=null,hT(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=Jc(g(this.ab,this),l)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qt(10),oh(this),hT(this))};function Py(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function hT(l){l.g=new _i(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=Hr(l.qa);Ge(f,"RID","rpc"),Ge(f,"SID",l.K),Ge(f,"AID",l.T),Ge(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&Ge(f,"TO",l.ja),Ge(f,"TYPE","xmlhttp"),cl(l,f),l.m&&l.o&&Ry(f,l.m,l.o),l.L&&(l.g.I=l.L);var p=l.g;l=l.ia,p.L=1,p.v=rh(Hr(f)),p.m=null,p.P=!0,jb(p,l)}t.Za=function(){this.C!=null&&(this.C=null,oh(this),Ny(this),Qt(19))};function ch(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function fT(l,f){var p=null;if(l.g==f){ch(l),Py(l),l.g=null;var m=2}else if(Ay(l.h,f))p=f.D,Gb(l.h,f),m=1;else return;if(l.G!=0){if(f.o)if(m==1){p=f.m?f.m.length:0,f=Date.now()-f.F;var T=l.B;m=Zd(),Kt(m,new Ob(m,p)),ah(l)}else dT(l);else if(T=f.s,T==3||T==0&&0<f.X||!(m==1&&zV(l,f)||m==2&&Ny(l)))switch(p&&0<p.length&&(f=l.h,f.i=f.i.concat(p)),T){case 1:Ts(l,5);break;case 4:Ts(l,10);break;case 3:Ts(l,6);break;default:Ts(l,2)}}}function pT(l,f){let p=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(p*=2),p*f}function Ts(l,f){if(l.j.info("Error code "+f),f==2){var p=g(l.fb,l),m=l.Xa;let T=!m;m=new bs(m||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||th(m,"https"),rh(m),T?jV(m.toString(),p):UV(m.toString(),p)}else Qt(2);l.G=0,l.l&&l.l.sa(f),gT(l),cT(l)}t.fb=function(l){l?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function gT(l){if(l.G=0,l.ka=[],l.l){let f=zb(l.h);(f.length!=0||l.i.length!=0)&&(S(l.ka,f),S(l.ka,l.i),l.h.i.length=0,D(l.i),l.i.length=0),l.l.ra()}}function mT(l,f,p){var m=p instanceof bs?Hr(p):new bs(p);if(m.g!="")f&&(m.g=f+"."+m.g),nh(m,m.s);else{var T=a.location;m=T.protocol,f=f?f+"."+T.hostname:T.hostname,T=+T.port;var M=new bs(null);m&&th(M,m),f&&(M.g=f),T&&nh(M,T),p&&(M.l=p),m=M}return p=l.D,f=l.ya,p&&f&&Ge(m,p,f),Ge(m,"VER",l.la),cl(l,m),m}function yT(l,f,p){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new et(new il({eb:p})):new et(l.pa),f.Ha(l.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vT(){}t=vT.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function lh(){}lh.prototype.g=function(l,f){return new fn(l,f)};function fn(l,f){jt.call(this),this.g=new aT(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!q(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!q(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Oo(this)}E(fn,jt),fn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fn.prototype.close=function(){My(this.g)},fn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.u&&(p={},p.__data__=_y(l),l=p);f.i.push(new xV(f.Ya++,l)),f.G==3&&ah(f)},fn.prototype.N=function(){this.g.l=null,delete this.j,My(this.g),delete this.g,fn.aa.N.call(this)};function _T(l){Ey.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(let p in f){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}E(_T,Ey);function wT(){Iy.call(this),this.status=1}E(wT,Iy);function Oo(l){this.g=l}E(Oo,vT),Oo.prototype.ua=function(){Kt(this.g,"a")},Oo.prototype.ta=function(l){Kt(this.g,new _T(l))},Oo.prototype.sa=function(l){Kt(this.g,new wT)},Oo.prototype.ra=function(){Kt(this.g,"b")},lh.prototype.createWebChannel=lh.prototype.g,fn.prototype.send=fn.prototype.o,fn.prototype.open=fn.prototype.m,fn.prototype.close=fn.prototype.close,AE=oi.createWebChannelTransport=function(){return new lh},SE=oi.getStatEventTarget=function(){return Zd()},TE=oi.Event=Cs,Yp=oi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Jd.NO_ERROR=0,Jd.TIMEOUT=8,Jd.HTTP_ERROR=6,Tu=oi.ErrorCode=Jd,Fb.COMPLETE="complete",bE=oi.EventType=Fb,Mb.EventType=Yc,Yc.OPEN="a",Yc.CLOSE="b",Yc.ERROR="c",Yc.MESSAGE="d",jt.prototype.listen=jt.prototype.K,Ua=oi.WebChannel=Mb,DE=oi.FetchXmlHttpFactory=il,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,CE=oi.XhrIo=et}).apply(typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{});var tP="@firebase/firestore";var mt=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};mt.UNAUTHENTICATED=new mt(null),mt.GOOGLE_CREDENTIALS=new mt("google-credentials-uid"),mt.FIRST_PARTY=new mt("first-party-uid"),mt.MOCK_USER=new mt("mock-user");var yc="10.12.1";var ts=new Ci("@firebase/firestore");function Ga(){return ts.logLevel}function t1(t){ts.setLogLevel(t)}function O(t,...e){if(ts.logLevel<=Nn.DEBUG){let n=e.map(M0);ts.debug(`Firestore (${yc}): ${t}`,...n)}}function lt(t,...e){if(ts.logLevel<=Nn.ERROR){let n=e.map(M0);ts.error(`Firestore (${yc}): ${t}`,...n)}}function jn(t,...e){if(ts.logLevel<=Nn.WARN){let n=e.map(M0);ts.warn(`Firestore (${yc}): ${t}`,...n)}}function M0(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function K(t="Unexpected state"){let e=`FIRESTORE (${yc}) INTERNAL ASSERTION FAILED: `+t;throw lt(e),new Error(e)}function X(t,e){t||K()}function n1(t,e){t||K()}function z(t,e){return t}var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=class extends AT{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var yt=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var ag=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},PE=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(mt.UNAUTHENTICATED))}shutdown(){}},kE=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},OE=class{constructor(e){this.t=e,this.currentUser=mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new yt;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new yt,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>x(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{O("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(O("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new yt)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(O("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(X(typeof r.accessToken=="string"),new ag(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return X(e===null||typeof e=="string"),new mt(e)}},FE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},LE=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new FE(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}},VE=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},jE=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&O("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,O("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{O("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):O("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(X(typeof n.token=="string"),this.R=n.token,new VE(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function r9(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var cg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=r9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function ue(t,e){return t<e?-1:t>e?1:0}function ec(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function r1(t){return t+"\0"}var Je=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new P(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new P(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new P(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var te=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Je(0,0))}static max(){return new t(new Je(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var lg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&K(),r===void 0?r=e.length-n:r>e.length-n&&K(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},Se=class t extends lg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new P(N.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},i9=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ut=class t extends lg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return i9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new P(N.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new P(N.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new P(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new P(N.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var G=class t{constructor(e){this.path=e}static fromPath(e){return new t(Se.fromString(e))}static fromName(e){return new t(Se.fromString(e).popFirst(5))}static empty(){return new t(Se.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Se.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Se.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new Se(e.slice()))}};var tc=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function UE(t){return t.fields.find(e=>e.kind===2)}function Js(t){return t.fields.filter(e=>e.kind!==2)}tc.UNKNOWN_ID=-1;var Za=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Vu=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,Un.min())}};function i1(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=te.fromTimestamp(r===1e9?new Je(n+1,0):new Je(n,r));return new Un(i,G.empty(),e)}function s1(t){return new Un(t.readTime,t.key,-1)}var Un=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(te.min(),G.empty(),-1)}static max(){return new t(te.max(),G.empty(),-1)}};function N0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=G.comparator(t.documentKey,e.documentKey),n!==0?n:ue(t.largestBatchId,e.largestBatchId))}var o1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ug=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function ds(t){return x(this,null,function*(){if(t.code!==N.FAILED_PRECONDITION||t.message!==o1)throw t;O("LocalStore","Unexpectedly lost primary lease")})}var R=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&K(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var dg=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new yt,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new io(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=P0(r.target.error);this.V.reject(new io(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new io(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(O("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new $E(n)}},ns=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(ll())===12.2&&lt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return O("SimpleDb","Removing database:",e),Xs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ph())return!1;if(t.C())return!0;let e=ll(),n=t.S(e),r=0<n&&n<10,i=a1(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.v)==="YES"}static F(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){return x(this,null,function*(){return this.db||(O("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new io(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new P(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new P(N.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new io(e,o))},i.onupgradeneeded=s=>{O("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{O("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db})}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return x(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(e);let a=dg.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),R.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(O("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function a1(t){let e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}var BE=class{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Xs(this.B.delete())}},io=class extends P{constructor(e,n){super(N.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function hs(t){return t.name==="IndexedDbTransactionError"}var $E=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(O("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(O("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Xs(r)}add(e){return O("SimpleDb","ADD",this.store.name,e,e),Xs(this.store.add(e))}get(e){return Xs(this.store.get(e)).next(n=>(n===void 0&&(n=null),O("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return O("SimpleDb","DELETE",this.store.name,e),Xs(this.store.delete(e))}count(){return O("SimpleDb","COUNT",this.store.name),Xs(this.store.count())}U(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new R((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new R((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){O("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.H=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.W(i,n)}Y(e){let n=this.cursor({});return new R((r,i)=>{n.onerror=s=>{let o=P0(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){let r=[];return new R((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new BE(a),u=n(a.primaryKey,a.value,c);if(u instanceof R){let d=u.catch(h=>(c.done(),R.reject(h)));r.push(d)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>R.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Xs(t){return new R((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=P0(r.target.error);n(i)}})}var nP=!1;function P0(t){let e=ns.S(ll());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new P("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nP||(nP=!0,setTimeout(()=>{throw r},0)),r}}return t}var qE=class{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){O("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>x(this,null,function*(){this.task=null;try{O("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(n){hs(n)?O("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield ds(n)}yield this.X(6e4)}))}},HE=class{constructor(e,n){this.localStore=e,this.persistence=n}ee(e=50){return x(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))})}te(e,n){let r=new Set,i=n,s=!0;return R.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return O("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(O("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=s1(s);N0(o,r)>0&&(r=o)}),new Un(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var bn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.se&&this.se(n),n}}return t.oe=-1,t})();function od(t){return t==null}function ju(t){return t===0&&1/t==-1/0}function c1(t){return typeof t=="number"&&Number.isInteger(t)&&!ju(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function nn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=rP(e)),e=s9(t.get(n),e);return rP(e)}function s9(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function rP(t){return t+""}function Ar(t){let e=t.length;if(X(e>=2),e===2)return X(t.charAt(0)===""&&t.charAt(1)===""),Se.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&K(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:K()}s=o+2}return new Se(r)}var iP=["userId","batchId"];function tg(t,e){return[t,nn(e)]}function l1(t,e,n){return[t,nn(e),n]}var o9={},a9=["prefixPath","collectionGroup","readTime","documentId"],c9=["prefixPath","collectionGroup","documentId"],l9=["collectionGroup","readTime","prefixPath","documentId"],u9=["canonicalId","targetId"],d9=["targetId","path"],h9=["path","targetId"],f9=["collectionId","parent"],p9=["indexId","uid"],g9=["uid","sequenceNumber"],m9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],y9=["indexId","uid","orderedDocumentKey"],v9=["userId","collectionPath","documentId"],_9=["userId","collectionPath","largestBatchId"],w9=["userId","collectionGroup","largestBatchId"],u1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],E9=[...u1,"documentOverlays"],d1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],h1=d1,f1=[...h1,"indexConfiguration","indexState","indexEntries"],I9=f1;var Uu=class extends ug{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}};function At(t,e){let n=z(t);return ns.F(n._e,e)}function sP(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function yo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function p1(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var We=class t{constructor(e,n){this.comparator=e,this.root=n||Rr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ya(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ya(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ya(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ya(this.root,e,this.comparator,!0)}},Ya=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw K();let e=this.left.check();if(e!==this.right.check())throw K();return e+(this.isRed()?0:1)}};Rr.EMPTY=null,Rr.RED=!0,Rr.BLACK=!1;Rr.EMPTY=new class{constructor(){this.size=0}get key(){throw K()}get value(){throw K()}get color(){throw K()}get left(){throw K()}get right(){throw K()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Rr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ue=class t{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new hg(this.data.getIterator())}getIteratorFrom(e){return new hg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},hg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Ba(t){return t.hasNext()?t.getNext():void 0}var Tn=class t{constructor(e){this.fields=e,e.sort(ut.comparator)}static empty(){return new t([])}unionWith(e){let n=new Ue(ut.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ec(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var fg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function g1(){return typeof atob<"u"}var St=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};St.EMPTY_BYTE_STRING=new St("");var C9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function li(t){if(X(!!t),typeof t=="string"){let e=0,n=C9.exec(t);if(X(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function rs(t){return typeof t=="string"?St.fromBase64String(t):St.fromUint8Array(t)}function rm(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function k0(t){let e=t.mapValue.fields.__previous_value__;return rm(e)?k0(e):e}function Bu(t){let e=li(t.mapValue.fields.__local_write_time__.timestampValue);return new Je(e.seconds,e.nanos)}var GE=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},is=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ng={nullValue:"NULL_VALUE"};function so(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?rm(t)?4:m1(t)?9007199254740991:10:K()}function Pr(t,e){if(t===e)return!0;let n=so(t);if(n!==so(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Bu(t).isEqual(Bu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=li(i.timestampValue),a=li(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return rs(i.bytesValue).isEqual(rs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nt(i.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(i.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nt(i.integerValue)===nt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=nt(i.doubleValue),a=nt(s.doubleValue);return o===a?ju(o)===ju(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return ec(t.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(sP(o)!==sP(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Pr(o[c],a[c])))return!1;return!0}(t,e);default:return K()}}function $u(t,e){return(t.values||[]).find(n=>Pr(n,e))!==void 0}function ss(t,e){if(t===e)return 0;let n=so(t),r=so(e);if(n!==r)return ue(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ue(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=nt(s.integerValue||s.doubleValue),c=nt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return oP(t.timestampValue,e.timestampValue);case 4:return oP(Bu(t),Bu(e));case 5:return ue(t.stringValue,e.stringValue);case 6:return function(s,o){let a=rs(s),c=rs(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let d=ue(a[u],c[u]);if(d!==0)return d}return ue(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=ue(nt(s.latitude),nt(o.latitude));return a!==0?a:ue(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let d=ss(a[u],c[u]);if(d)return d}return ue(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Xi.mapValue&&o===Xi.mapValue)return 0;if(s===Xi.mapValue)return 1;if(o===Xi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){let g=ue(c[h],d[h]);if(g!==0)return g;let y=ss(a[c[h]],u[d[h]]);if(y!==0)return y}return ue(c.length,d.length)}(t.mapValue,e.mapValue);default:throw K()}}function oP(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ue(t,e);let n=li(t),r=li(e),i=ue(n.seconds,r.seconds);return i!==0?i:ue(n.nanos,r.nanos)}function nc(t){return zE(t)}function zE(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=li(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return rs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return G.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=zE(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${zE(n.fields[o])}`;return i+"}"}(t.mapValue):K()}function oo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function WE(t){return!!t&&"integerValue"in t}function qu(t){return!!t&&"arrayValue"in t}function aP(t){return!!t&&"nullValue"in t}function cP(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rg(t){return!!t&&"mapValue"in t}function Pu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return yo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Pu(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Pu(t.arrayValue.values[n]);return e}return Object.assign({},t)}function m1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function D9(t){return"nullValue"in t?ng:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?oo(is.empty(),G.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:K()}function b9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?oo(is.empty(),G.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Xi:K()}function lP(t,e){let n=ss(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function uP(t,e){let n=ss(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var zt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!rg(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pu(n)}setAll(e){let n=ut.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Pu(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());rg(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Pr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];rg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){yo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Pu(this.value))}};function y1(t){let e=[];return yo(t.fields,(n,r)=>{let i=new ut([n]);if(rg(r)){let s=y1(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Tn(e)}var vt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,te.min(),te.min(),te.min(),zt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,te.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,te.min(),te.min(),zt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,te.min(),te.min(),zt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(te.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=zt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=zt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=te.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var kr=class{constructor(e,n){this.position=e,this.inclusive=n}};function dP(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=G.comparator(G.fromName(o.referenceValue),n.key):r=ss(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function hP(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pr(t.position[n],e.position[n]))return!1;return!0}var ao=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function T9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var pg=class{},Ce=class t extends pg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new YE(e,n,r):n==="array-contains"?new XE(e,r):n==="in"?new gg(e,r):n==="not-in"?new eI(e,r):n==="array-contains-any"?new tI(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new ZE(e,r):new JE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ss(n,this.value)):n!==null&&so(this.value)===so(n)&&this.matchesComparison(ss(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Fe=class t extends pg{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new t(e,n)}matches(e){return rc(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function rc(t){return t.op==="and"}function KE(t){return t.op==="or"}function O0(t){return v1(t)&&rc(t)}function v1(t){for(let e of t.filters)if(e instanceof Fe)return!1;return!0}function QE(t){if(t instanceof Ce)return t.field.canonicalString()+t.op.toString()+nc(t.value);if(O0(t))return t.filters.map(e=>QE(e)).join(",");{let e=t.filters.map(n=>QE(n)).join(",");return`${t.op}(${e})`}}function _1(t,e){return t instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.field.isEqual(i.field)&&Pr(r.value,i.value)}(t,e):t instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&_1(o,i.filters[a]),!0):!1}(t,e):void K()}function w1(t,e){let n=t.filters.concat(e);return Fe.create(n,t.op)}function E1(t){return t instanceof Ce?function(n){return`${n.field.canonicalString()} ${n.op} ${nc(n.value)}`}(t):t instanceof Fe?function(n){return n.op.toString()+" {"+n.getFilters().map(E1).join(" ,")+"}"}(t):"Filter"}var YE=class extends Ce{constructor(e,n,r){super(e,n,r),this.key=G.fromName(r.referenceValue)}matches(e){let n=G.comparator(e.key,this.key);return this.matchesComparison(n)}},ZE=class extends Ce{constructor(e,n){super(e,"in",n),this.keys=I1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},JE=class extends Ce{constructor(e,n){super(e,"not-in",n),this.keys=I1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function I1(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>G.fromName(r.referenceValue))}var XE=class extends Ce{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return qu(n)&&$u(n.arrayValue,this.value)}},gg=class extends Ce{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&$u(this.value.arrayValue,n)}},eI=class extends Ce{constructor(e,n){super(e,"not-in",n)}matches(e){if($u(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!$u(this.value.arrayValue,n)}},tI=class extends Ce{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!qu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>$u(this.value.arrayValue,r))}};var nI=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function rI(t,e=null,n=[],r=[],i=null,s=null,o=null){return new nI(t,e,n,r,i,s,o)}function co(t){let e=z(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>QE(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),od(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>nc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>nc(r)).join(",")),e.ue=n}return e.ue}function ad(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!T9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hP(t.startAt,e.startAt)&&hP(t.endAt,e.endAt)}function mg(t){return G.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function yg(t,e){return t.filters.filter(n=>n instanceof Ce&&n.field.isEqual(e))}function fP(t,e,n){let r=ng,i=!0;for(let s of yg(t,e)){let o=ng,a=!0;switch(s.op){case"<":case"<=":o=D9(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=ng}lP({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];lP({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function pP(t,e,n){let r=Xi,i=!0;for(let s of yg(t,e)){let o=Xi,a=!0;switch(s.op){case">=":case">":o=b9(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xi}uP({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];uP({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var ir=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function C1(t,e,n,r,i,s,o,a){return new ir(t,e,n,r,i,s,o,a)}function vc(t){return new ir(t)}function gP(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function F0(t){return t.collectionGroup!==null}function Ja(t){let e=z(t);if(e.ce===null){e.ce=[];let n=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ue(ut.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new ao(s,r))}),n.has(ut.keyField().canonicalString())||e.ce.push(new ao(ut.keyField(),r))}return e.ce}function rn(t){let e=z(t);return e.le||(e.le=S9(e,Ja(t))),e.le}function S9(t,e){if(t.limitType==="F")return rI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new ao(i.field,s)});let n=t.endAt?new kr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new kr(t.startAt.position,t.startAt.inclusive):null;return rI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function iI(t,e){let n=t.filters.concat([e]);return new ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vg(t,e,n){return new ir(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cd(t,e){return ad(rn(t),rn(e))&&t.limitType===e.limitType}function D1(t){return`${co(rn(t))}|lt:${t.limitType}`}function za(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>E1(i)).join(", ")}]`),od(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>nc(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>nc(i)).join(",")),`Target(${r})`}(rn(t))}; limitType=${t.limitType})`}function ld(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):G.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Ja(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=dP(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,Ja(r),i)||r.endAt&&!function(o,a,c){let u=dP(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,Ja(r),i))}(t,e)}function b1(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function T1(t){return(e,n)=>{let r=!1;for(let i of Ja(t)){let s=A9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function A9(t,e,n){let r=t.field.isKeyField()?G.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?ss(c,u):K()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return K()}}var Or=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){yo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return p1(this.inner)}size(){return this.innerSize}};var x9=new We(G.comparator);function hn(){return x9}var S1=new We(G.comparator);function Mu(...t){let e=S1;for(let n of t)e=e.insert(n.key,n);return e}function A1(t){let e=S1;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function xr(){return ku()}function x1(){return ku()}function ku(){return new Or(t=>t.toString(),(t,e)=>t.isEqual(e))}var R9=new We(G.comparator),M9=new Ue(G.comparator);function he(...t){let e=M9;for(let n of t)e=e.add(n);return e}var N9=new Ue(ue);function L0(){return N9}function R1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ju(e)?"-0":e}}function M1(t){return{integerValue:""+t}}function N1(t,e){return c1(e)?M1(e):R1(t,e)}var ic=class{constructor(){this._=void 0}};function P9(t,e,n){return t instanceof os?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&rm(s)&&(s=k0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ui?k1(t,e):t instanceof di?O1(t,e):function(i,s){let o=P1(i,s),a=mP(o)+mP(i.Pe);return WE(o)&&WE(i.Pe)?M1(a):R1(i.serializer,a)}(t,e)}function k9(t,e,n){return t instanceof ui?k1(t,e):t instanceof di?O1(t,e):n}function P1(t,e){return t instanceof as?function(r){return WE(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var os=class extends ic{},ui=class extends ic{constructor(e){super(),this.elements=e}};function k1(t,e){let n=F1(e);for(let r of t.elements)n.some(i=>Pr(i,r))||n.push(r);return{arrayValue:{values:n}}}var di=class extends ic{constructor(e){super(),this.elements=e}};function O1(t,e){let n=F1(e);for(let r of t.elements)n=n.filter(i=>!Pr(i,r));return{arrayValue:{values:n}}}var as=class extends ic{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function mP(t){return nt(t.integerValue||t.doubleValue)}function F1(t){return qu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var lo=class{constructor(e,n){this.field=e,this.transform=n}};function O9(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ui&&i instanceof ui||r instanceof di&&i instanceof di?ec(r.elements,i.elements,Pr):r instanceof as&&i instanceof as?Pr(r.Pe,i.Pe):r instanceof os&&i instanceof os}(t.transform,e.transform)}var sI=class{constructor(e,n){this.version=e,this.transformResults=n}},rt=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ig(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var sc=class{};function L1(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ls(t.key,rt.none()):new cs(t.key,t.data,rt.none());{let n=t.data,r=zt.empty(),i=new Ue(ut.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new sr(t.key,r,new Tn(i.toArray()),rt.none())}}function F9(t,e,n){t instanceof cs?function(i,s,o){let a=i.value.clone(),c=vP(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof sr?function(i,s,o){if(!ig(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=vP(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(V1(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ou(t,e,n,r){return t instanceof cs?function(s,o,a,c){if(!ig(s.precondition,o))return a;let u=s.value.clone(),d=_P(s.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof sr?function(s,o,a,c){if(!ig(s.precondition,o))return a;let u=_P(s.fieldTransforms,c,o),d=o.data;return d.setAll(V1(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return ig(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function L9(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=P1(r.transform,i||null);s!=null&&(n===null&&(n=zt.empty()),n.set(r.field,s))}return n||null}function yP(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ec(r,i,(s,o)=>O9(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var cs=class extends sc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},sr=class extends sc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function V1(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function vP(t,e,n){let r=new Map;X(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,k9(o,a,n[i]))}return r}function _P(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,P9(s,o,e))}return r}var ls=class extends sc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Hu=class extends sc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Gu=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&F9(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ou(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Ou(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=x1();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=L1(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(te.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),he())}isEqual(e){return this.batchId===e.batchId&&ec(this.mutations,e.mutations,(n,r)=>yP(n,r))&&ec(this.baseMutations,e.baseMutations,(n,r)=>yP(n,r))}},oI=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){X(e.mutations.length===r.length);let i=function(){return R9}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var zu=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var aI=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var pt,Te;function j1(t){switch(t){default:return K();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0}}function U1(t){if(t===void 0)return lt("GRPC error has no .code"),N.UNKNOWN;switch(t){case pt.OK:return N.OK;case pt.CANCELLED:return N.CANCELLED;case pt.UNKNOWN:return N.UNKNOWN;case pt.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case pt.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case pt.INTERNAL:return N.INTERNAL;case pt.UNAVAILABLE:return N.UNAVAILABLE;case pt.UNAUTHENTICATED:return N.UNAUTHENTICATED;case pt.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case pt.NOT_FOUND:return N.NOT_FOUND;case pt.ALREADY_EXISTS:return N.ALREADY_EXISTS;case pt.PERMISSION_DENIED:return N.PERMISSION_DENIED;case pt.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case pt.ABORTED:return N.ABORTED;case pt.OUT_OF_RANGE:return N.OUT_OF_RANGE;case pt.UNIMPLEMENTED:return N.UNIMPLEMENTED;case pt.DATA_LOSS:return N.DATA_LOSS;default:return K()}}(Te=pt||(pt={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";var wP=null;function B1(){return new TextEncoder}var V9=new Ki([4294967295,4294967295],0);function EP(t){let e=B1().encode(t),n=new IE;return n.update(e),new Uint8Array(n.digest())}function IP(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ki([n,r],0),new Ki([i,s],0)]}var cI=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ro(`Invalid padding: ${n}`);if(r<0)throw new ro(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ro(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ro(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ki.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Ki.fromNumber(r)));return i.compare(V9)===1&&(i=new Ki([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let n=EP(e),[r,i]=IP(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;let n=EP(e),[r,i]=IP(n);for(let s=0;s<this.hashCount;s++){let o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},ro=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Wu=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,Ku.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(te.min(),i,new We(ue),hn(),he())}},Ku=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,he(),he(),he())}};var Xa=class{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}},_g=class{constructor(e,n){this.targetId=e,this.me=n}},wg=class{constructor(e,n,r=St.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Eg=class{constructor(){this.fe=0,this.ge=DP(),this.pe=St.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=he(),n=he(),r=he();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:K()}}),new Ku(this.pe,this.ye,e,n,r)}ve(){this.we=!1,this.ge=DP()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,X(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},lI=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=hn(),this.qe=CP(),this.Qe=new We(ue)}Ke(e){for(let n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(let n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{let r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:K()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){let n=e.targetId,r=e.me.count,i=this.Je(n);if(i){let s=i.target;if(mg(s))if(r===0){let o=new G(s.path);this.Ue(n,o,vt.newNoDocument(o,te.min()))}else X(r===1);else{let o=this.Ye(n);if(o!==r){let a=this.Ze(e),c=a?this.Xe(a,e,o):1;if(c!==0){this.je(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}wP?.et(function(d,h,g,y,E){var D,S,k,q,F,Y;let ie={localCacheCount:d,existenceFilterCount:h.count,databaseId:g.database,projectId:g.projectId},ne=h.unchangedNames;return ne&&(ie.bloomFilter={applied:E===0,hashCount:(D=ne?.hashCount)!==null&&D!==void 0?D:0,bitmapLength:(q=(k=(S=ne?.bits)===null||S===void 0?void 0:S.bitmap)===null||k===void 0?void 0:k.length)!==null&&q!==void 0?q:0,padding:(Y=(F=ne?.bits)===null||F===void 0?void 0:F.padding)!==null&&Y!==void 0?Y:0,mightContain:I=>{var v;return(v=y?.mightContain(I))!==null&&v!==void 0&&v}}),ie}(o,e.me,this.Le.tt(),a,c))}}}}Ze(e){let n=e.me.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=rs(r).toUint8Array()}catch(c){if(c instanceof fg)return jn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new cI(o,i,s)}catch(c){return jn(c instanceof ro?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){let n=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&mg(a.target)){let c=new G(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,vt.newNoDocument(c,e))}s.be&&(n.set(o,s.Ce()),s.ve())}});let r=he();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));let i=new Wu(e,n,this.Qe,this.ke,r);return this.ke=hn(),this.qe=CP(),this.Qe=new We(ue),i}$e(e,n){if(!this.ze(e))return;let r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let n=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Eg,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ue(ue),this.qe=this.qe.insert(e,n)),n}ze(e){let n=this.Je(e)!==null;return n||O("WatchChangeAggregator","Detected inactive target",e),n}Je(e){let n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Eg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function CP(){return new We(G.comparator)}function DP(){return new We(G.comparator)}var j9={asc:"ASCENDING",desc:"DESCENDING"},U9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},B9={and:"AND",or:"OR"},uI=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function dI(t,e){return t.useProto3Json||od(e)?e:{value:e}}function oc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $1(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $9(t,e){return oc(t,e.toTimestamp())}function dt(t){return X(!!t),te.fromTimestamp(function(n){let r=li(n);return new Je(r.seconds,r.nanos)}(t))}function V0(t,e){return hI(t,e).canonicalString()}function hI(t,e){let n=function(i){return new Se(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function q1(t){let e=Se.fromString(t);return X(X1(e)),e}function Qu(t,e){return V0(t.databaseId,e.path)}function Mr(t,e){let n=q1(e);if(n.get(1)!==t.databaseId.projectId)throw new P(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new G(z1(n))}function H1(t,e){return V0(t.databaseId,e)}function G1(t){let e=q1(t);return e.length===4?Se.emptyPath():z1(e)}function fI(t){return new Se(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function z1(t){return X(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function bP(t,e,n){return{name:Qu(t,e),fields:n.value.mapValue.fields}}function W1(t,e,n){let r=Mr(t,e.name),i=dt(e.updateTime),s=e.createTime?dt(e.createTime):te.min(),o=new zt({mapValue:{fields:e.fields}}),a=vt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function q9(t,e){return"found"in e?function(r,i){X(!!i.found),i.found.name,i.found.updateTime;let s=Mr(r,i.found.name),o=dt(i.found.updateTime),a=i.found.createTime?dt(i.found.createTime):te.min(),c=new zt({mapValue:{fields:i.found.fields}});return vt.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){X(!!i.missing),X(!!i.readTime);let s=Mr(r,i.missing),o=dt(i.readTime);return vt.newNoDocument(s,o)}(t,e):K()}function H9(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:K()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(X(d===void 0||typeof d=="string"),St.fromBase64String(d||"")):(X(d===void 0||d instanceof Buffer||d instanceof Uint8Array),St.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let d=u.code===void 0?N.UNKNOWN:U1(u.code);return new P(d,u.message||"")}(o);n=new wg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Mr(t,r.document.name),s=dt(r.document.updateTime),o=r.document.createTime?dt(r.document.createTime):te.min(),a=new zt({mapValue:{fields:r.document.fields}}),c=vt.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Xa(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Mr(t,r.document),s=r.readTime?dt(r.readTime):te.min(),o=vt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Xa([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Mr(t,r.document),s=r.removedTargetIds||[];n=new Xa([],s,i,null)}else{if(!("filter"in e))return K();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new aI(i,s),a=r.targetId;n=new _g(a,o)}}return n}function Yu(t,e){let n;if(e instanceof cs)n={update:bP(t,e.key,e.value)};else if(e instanceof ls)n={delete:Qu(t,e.key)};else if(e instanceof sr)n={update:bP(t,e.key,e.data),updateMask:Y9(e.fieldMask)};else{if(!(e instanceof Hu))return K();n={verify:Qu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof os)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ui)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof di)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof as)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw K()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:$9(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:K()}(t,e.precondition)),n}function pI(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?rt.updateTime(dt(s.updateTime)):s.exists!==void 0?rt.exists(s.exists):rt.none()}(e.currentDocument):rt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)X(a.setToServerValue==="REQUEST_TIME"),c=new os;else if("appendMissingElements"in a){let d=a.appendMissingElements.values||[];c=new ui(d)}else if("removeAllFromArray"in a){let d=a.removeAllFromArray.values||[];c=new di(d)}else"increment"in a?c=new as(o,a.increment):K();let u=ut.fromServerFormat(a.fieldPath);return new lo(u,c)}(t,i)):[];if(e.update){e.update.name;let i=Mr(t,e.update.name),s=new zt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new Tn(u.map(d=>ut.fromServerFormat(d)))}(e.updateMask);return new sr(i,s,o,n,r)}return new cs(i,s,n,r)}if(e.delete){let i=Mr(t,e.delete);return new ls(i,n)}if(e.verify){let i=Mr(t,e.verify);return new Hu(i,n)}return K()}function G9(t,e){return t&&t.length>0?(X(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?dt(i.updateTime):dt(s);return o.isEqual(te.min())&&(o=dt(s)),new sI(o,i.transformResults||[])}(n,e))):[]}function K1(t,e){return{documents:[H1(t,e.path)]}}function Q1(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=H1(t,i);let s=function(u){if(u.length!==0)return J1(Fe.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(d=>function(g){return{field:Wa(g.field),direction:W9(g.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=dI(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function Y1(t){let e=G1(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){X(r===1);let d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){let g=Z1(h);return g instanceof Fe&&O0(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(g=>function(E){return new ao(Ka(E.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(h){let g;return g=typeof h=="object"?h.value:h,od(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(h){let g=!!h.before,y=h.values||[];return new kr(y,g)}(n.startAt));let u=null;return n.endAt&&(u=function(h){let g=!h.before,y=h.values||[];return new kr(y,g)}(n.endAt)),C1(e,i,o,s,a,"F",c,u)}function z9(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Z1(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=Ka(n.unaryFilter.field);return Ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Ka(n.unaryFilter.field);return Ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Ka(n.unaryFilter.field);return Ce.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Ka(n.unaryFilter.field);return Ce.create(o,"!=",{nullValue:"NULL_VALUE"});default:return K()}}(t):t.fieldFilter!==void 0?function(n){return Ce.create(Ka(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return K()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Fe.create(n.compositeFilter.filters.map(r=>Z1(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return K()}}(n.compositeFilter.op))}(t):K()}function W9(t){return j9[t]}function K9(t){return U9[t]}function Q9(t){return B9[t]}function Wa(t){return{fieldPath:t.canonicalString()}}function Ka(t){return ut.fromServerFormat(t.fieldPath)}function J1(t){return t instanceof Ce?function(n){if(n.op==="=="){if(cP(n.value))return{unaryFilter:{field:Wa(n.field),op:"IS_NAN"}};if(aP(n.value))return{unaryFilter:{field:Wa(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(cP(n.value))return{unaryFilter:{field:Wa(n.field),op:"IS_NOT_NAN"}};if(aP(n.value))return{unaryFilter:{field:Wa(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wa(n.field),op:K9(n.op),value:n.value}}}(t):t instanceof Fe?function(n){let r=n.getFilters().map(i=>J1(i));return r.length===1?r[0]:{compositeFilter:{op:Q9(n.op),filters:r}}}(t):K()}function Y9(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function X1(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var ac=class t{constructor(e,n,r,i,s=te.min(),o=te.min(),a=St.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Ig=class{constructor(e){this.ct=e}};function Z9(t,e){let n;if(e.document)n=W1(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=G.fromSegments(e.noDocument.path),i=ho(e.noDocument.readTime);n=vt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return K();{let r=G.fromSegments(e.unknownDocument.path),i=ho(e.unknownDocument.version);n=vt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Je(i[0],i[1]);return te.fromTimestamp(s)}(e.readTime)),n}function TP(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Cg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Qu(s,o.key),fields:o.data.value.mapValue.fields,updateTime:oc(s,o.version.toTimestamp()),createTime:oc(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:uo(e.version)};else{if(!e.isUnknownDocument())return K();r.unknownDocument={path:n.path.toArray(),version:uo(e.version)}}return r}function Cg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function uo(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ho(t){let e=new Je(t.seconds,t.nanoseconds);return te.fromTimestamp(e)}function eo(t,e){let n=(e.baseMutations||[]).map(s=>pI(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>pI(t.ct,s)),i=Je.fromMillis(e.localWriteTimeMs);return new Gu(e.batchId,i,n,r)}function Nu(t){let e=ho(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ho(t.lastLimboFreeSnapshotVersion):te.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return X(s.documents.length===1),rn(vc(G1(s.documents[0])))}(t.query):function(s){return rn(Y1(s))}(t.query),new ac(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,St.fromBase64String(t.resumeToken))}function ek(t,e){let n=uo(e.snapshotVersion),r=uo(e.lastLimboFreeSnapshotVersion),i;i=mg(e.target)?K1(t.ct,e.target):Q1(t.ct,e.target)._t;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function j0(t){let e=Y1({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vg(e,e.limit,"L"):e}function xE(t,e){return new zu(e.largestBatchId,pI(t.ct,e.overlayMutation))}function SP(t,e){let n=e.path.lastSegment();return[t,nn(e.path.popLast()),n]}function AP(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:uo(r.readTime),documentKey:nn(r.documentKey.path),largestBatchId:r.largestBatchId}}var gI=class{getBundleMetadata(e,n){return xP(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ho(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return xP(e).put(function(i){return{bundleId:i.id,createTime:uo(dt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return RP(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:j0(s.bundledQuery),readTime:ho(s.readTime)}}(r)})}saveNamedQuery(e,n){return RP(e).put(function(i){return{name:i.name,readTime:uo(dt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function xP(t){return At(t,"bundles")}function RP(t){return At(t,"namedQueries")}var Dg=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Su(e).get(SP(this.userId,n)).next(r=>r?xE(this.serializer,r):null)}getOverlays(e,n){let r=xr();return R.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new zu(n,o);i.push(this.ht(e,a))}),R.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(nn(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Su(e).j("collectionPathOverlayIndex",a))}),R.waitFor(s)}getOverlaysForCollection(e,n,r){let i=xr(),s=nn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Su(e).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=xE(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=xr(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Su(e).J({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{let h=xE(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Su(e).put(function(i,s,o){let[a,c,u]=SP(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Yu(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Su(t){return At(t,"documentOverlays")}var ai=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(nt(e.integerValue));else if("doubleValue"in e){let r=nt(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),ju(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"&&(r=li(r)),n.At(`${r.seconds||""}`),n.dt(r.nanos||0)}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(rs(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?m1(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):K()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),G.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ai.bt=new ai;function J9(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function MP(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=J9(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var mI=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Lt(e){let n=this.Bt(e),r=MP(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Bt(e),r=MP(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Bt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},yI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Lt(e)}Tt(){this.Gt.Qt()}},vI=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},to=class{constructor(){this.Gt=new mI,this.zt=new yI(this.Gt),this.jt=new vI(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var no=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function Qi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=NP(t.arrayValue,e.arrayValue),n!==0?n:(n=NP(t.directionalValue,e.directionalValue),n!==0?n:G.comparator(t.documentKey,e.documentKey)))}function NP(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var bg=class{constructor(e){this.Yt=new Ue((n,r)=>ut.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(X(e.collectionGroup===this.collectionId),this.en)return!1;let n=UE(e);if(n!==void 0&&!this.nn(n))return!1;let r=Js(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ue(ut.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Za(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Za(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Za(r.field,r.dir==="asc"?0:1)));return new tc(tc.UNKNOWN_ID,this.collectionId,n,Vu.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function tk(t){var e,n;if(X(t instanceof Ce||t instanceof Fe),t instanceof Ce){if(t instanceof gg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Ce.create(t.field,"==",s)))||[];return Fe.create(i,"or")}return t}let r=t.filters.map(i=>tk(i));return Fe.create(r,t.op)}function X9(t){if(t.getFilters().length===0)return[];let e=EI(tk(t));return X(nk(e)),_I(e)||wI(e)?[e]:e.getFilters()}function _I(t){return t instanceof Ce}function wI(t){return t instanceof Fe&&O0(t)}function nk(t){return _I(t)||wI(t)||function(n){if(n instanceof Fe&&KE(n)){for(let r of n.getFilters())if(!_I(r)&&!wI(r))return!1;return!0}return!1}(t)}function EI(t){if(X(t instanceof Ce||t instanceof Fe),t instanceof Ce)return t;if(t.filters.length===1)return EI(t.filters[0]);let e=t.filters.map(r=>EI(r)),n=Fe.create(e,t.op);return n=Tg(n),nk(n)?n:(X(n instanceof Fe),X(rc(n)),X(n.filters.length>1),n.filters.reduce((r,i)=>U0(r,i)))}function U0(t,e){let n;return X(t instanceof Ce||t instanceof Fe),X(e instanceof Ce||e instanceof Fe),n=t instanceof Ce?e instanceof Ce?function(i,s){return Fe.create([i,s],"and")}(t,e):PP(t,e):e instanceof Ce?PP(e,t):function(i,s){if(X(i.filters.length>0&&s.filters.length>0),rc(i)&&rc(s))return w1(i,s.getFilters());let o=KE(i)?i:s,a=KE(i)?s:i,c=o.filters.map(u=>U0(u,a));return Fe.create(c,"or")}(t,e),Tg(n)}function PP(t,e){if(rc(e))return w1(e,t.getFilters());{let n=e.filters.map(r=>U0(t,r));return Fe.create(n,"or")}}function Tg(t){if(X(t instanceof Ce||t instanceof Fe),t instanceof Ce)return t;let e=t.getFilters();if(e.length===1)return Tg(e[0]);if(v1(t))return t;let n=e.map(i=>Tg(i)),r=[];return n.forEach(i=>{i instanceof Ce?r.push(i):i instanceof Fe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,t.op)}var II=class{constructor(){this._n=new Zu}addToCollectionParentIndex(e,n){return this._n.add(n),R.resolve()}getCollectionParents(e,n){return R.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return R.resolve()}deleteFieldIndex(e,n){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,n){return R.resolve()}getDocumentsMatchingTarget(e,n){return R.resolve(null)}getIndexType(e,n){return R.resolve(0)}getFieldIndexes(e,n){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,n){return R.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,n){return R.resolve(Un.min())}updateCollectionGroup(e,n,r){return R.resolve()}updateIndexEntries(e,n){return R.resolve()}},Zu=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ue(Se.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(Se.comparator)).toArray()}};var Zp=new Uint8Array(0),CI=class{constructor(e,n){this.databaseId=n,this.an=new Zu,this.un=new Or(r=>co(r),(r,i)=>ad(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:nn(i)};return kP(e).put(s)}return R.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[r1(n),""],!1,!0);return kP(e).U(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Ar(o.parent))}return r})}addFieldIndex(e,n){let r=Au(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=qa(e);return s.next(a=>{o.put(AP(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Au(e),i=qa(e),s=$a(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Au(e),r=$a(e),i=qa(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return R.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new bg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=$a(e),i=!0,s=new Map;return R.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=he(),a=[];return R.forEach(s,(c,u)=>{O("IndexedDbIndexManager",`Using index ${function(F){return`id=${F.indexId}|cg=${F.collectionGroup}|f=${F.fields.map(Y=>`${Y.fieldPath}:${Y.kind}`).join(",")}`}(c)} to execute ${co(n)}`);let d=function(F,Y){let ie=UE(Y);if(ie===void 0)return null;for(let ne of yg(F,ie.fieldPath))switch(ne.op){case"array-contains-any":return ne.value.arrayValue.values||[];case"array-contains":return[ne.value]}return null}(u,c),h=function(F,Y){let ie=new Map;for(let ne of Js(Y))for(let I of yg(F,ne.fieldPath))switch(I.op){case"==":case"in":ie.set(ne.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return ie.set(ne.fieldPath.canonicalString(),I.value),Array.from(ie.values())}return null}(u,c),g=function(F,Y){let ie=[],ne=!0;for(let I of Js(Y)){let v=I.kind===0?fP(F,I.fieldPath,F.startAt):pP(F,I.fieldPath,F.startAt);ie.push(v.value),ne&&(ne=v.inclusive)}return new kr(ie,ne)}(u,c),y=function(F,Y){let ie=[],ne=!0;for(let I of Js(Y)){let v=I.kind===0?pP(F,I.fieldPath,F.endAt):fP(F,I.fieldPath,F.endAt);ie.push(v.value),ne&&(ne=v.inclusive)}return new kr(ie,ne)}(u,c),E=this.hn(c,u,g),D=this.hn(c,u,y),S=this.Pn(c,u,h),k=this.In(c.indexId,d,E,g.inclusive,D,y.inclusive,S);return R.forEach(k,q=>r.G(q,n.limit).next(F=>{F.forEach(Y=>{let ie=G.fromSegments(Y.documentKey);o.has(ie)||(o=o.add(ie),a.push(ie))})}))}).next(()=>a)}return R.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=X9(Fe.create(e.filters,"and")).map(r=>rI(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){let g=n?this.Tn(n[h/u]):Zp,y=this.En(e,g,r[h%u],i),E=this.dn(e,g,s[h%u],o),D=a.map(S=>this.En(e,g,S,!0));d.push(...this.createRange(y,E,D))}return d}En(e,n,r,i){let s=new no(e,G.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new no(e,G.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new bg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return R.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Ue(ut.comparator),d=!1;for(let h of c.filters)for(let g of h.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?d=!0:u=u.add(g.field));for(let h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new to;for(let i of Js(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ai.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new to;return ai.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new to;return ai.bt.Pt(oo(this.databaseId,n),r.Ht(function(s){let o=Js(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new to);let s=0;for(let o of Js(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&qu(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);ai.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new to;c.seed(a.Wt()),ai.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof Ce&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Au(e),i=qa(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{let o=[];return R.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(d,h){let g=h?new Vu(h.sequenceNumber,new Un(ho(h.readTime),new G(Ar(h.documentKey)),h.largestBatchId)):Vu.empty(),y=d.fields.map(([E,D])=>new Za(ut.fromServerFormat(E),D));return new tc(d.indexId,d.collectionGroup,y,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ue(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Au(e),s=qa(e);return this.gn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>R.forEach(a,c=>s.put(AP(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return R.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?R.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),R.forEach(a,c=>this.pn(e,i,c).next(u=>{let d=this.yn(s,c);return u.isEqual(d)?R.resolve():this.wn(e,s,c,u,d)}))))})}Sn(e,n,r,i){return $a(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return $a(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=$a(e),s=new Ue(Qi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new no(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Ue(Qi),i=this.An(n,e);if(i==null)return r;let s=UE(n);if(s!=null){let o=e.data.field(s.fieldPath);if(qu(o))for(let a of o.arrayValue.values||[])r=r.add(new no(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new no(n.indexId,e.key,Zp,i));return r}wn(e,n,r,i,s){O("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,d,h,g){let y=c.getIterator(),E=u.getIterator(),D=Ba(y),S=Ba(E);for(;D||S;){let k=!1,q=!1;if(D&&S){let F=d(D,S);F<0?q=!0:F>0&&(k=!0)}else D!=null?q=!0:k=!0;k?(h(S),S=Ba(E)):q?(g(D),D=Ba(y)):(D=Ba(y),S=Ba(E))}}(i,s,Qi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),R.waitFor(o)}gn(e){let n=1;return qa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Qi(o,a)).filter((o,a,c)=>!a||Qi(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=Qi(o,e),c=Qi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Zp,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Zp,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return Qi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(OP)}getMinOffset(e,n){return R.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||K())).next(OP)}};function kP(t){return At(t,"collectionParents")}function $a(t){return At(t,"indexEntries")}function Au(t){return At(t,"indexConfiguration")}function qa(t){return At(t,"indexState")}function OP(t){X(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;N0(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Un(e.readTime,e.documentKey,n)}var FP={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Vn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function rk(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.J({range:o},(d,h,g)=>(a++,g.delete()));s.push(c.next(()=>{X(a===1)}));let u=[];for(let d of n.mutations){let h=l1(e,d.key.path,n.batchId);s.push(i.delete(h)),u.push(d.key)}return R.waitFor(s).next(()=>u)}function Sg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw K();e=t.noDocument}return JSON.stringify(e).length}Vn.DEFAULT_COLLECTION_PERCENTILE=10,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vn.DEFAULT=new Vn(41943040,Vn.DEFAULT_COLLECTION_PERCENTILE,Vn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vn.DISABLED=new Vn(-1,0,0);var Ag=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){X(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Yi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=Qa(e),o=Yi(e);return o.add({}).next(a=>{X(typeof a=="number");let c=new Gu(a,n,r,i),u=function(y,E,D){let S=D.baseMutations.map(q=>Yu(y.ct,q)),k=D.mutations.map(q=>Yu(y.ct,q));return{userId:E,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:S,mutations:k}}(this.serializer,this.userId,c),d=[],h=new Ue((g,y)=>ue(g.canonicalString(),y.canonicalString()));for(let g of i){let y=l1(this.userId,g.key.path,a);h=h.add(g.key.path.popLast()),d.push(o.put(u)),d.push(s.put(y,o9))}return h.forEach(g=>{d.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),R.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Yi(e).get(n).next(r=>r?(X(r.userId===this.userId),eo(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?R.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Yi(e).J({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(X(a.batchId>=r),s=eo(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Yi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Yi(e).U("userMutationsIndex",n).next(r=>r.map(i=>eo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=tg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Qa(e).J({range:i},(o,a,c)=>{let[u,d,h]=o,g=Ar(d);if(u===this.userId&&n.path.isEqual(g))return Yi(e).get(h).next(y=>{if(!y)throw K();X(y.userId===this.userId),s.push(eo(this.serializer,y))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(ue),i=[];return n.forEach(s=>{let o=tg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Qa(e).J({range:a},(u,d,h)=>{let[g,y,E]=u,D=Ar(y);g===this.userId&&s.path.isEqual(D)?r=r.add(E):h.done()});i.push(c)}),R.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=tg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ue(ue);return Qa(e).J({range:o},(c,u,d)=>{let[h,g,y]=c,E=Ar(g);h===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(y)):d.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(Yi(e).get(s).next(o=>{if(o===null)throw K();X(o.userId===this.userId),r.push(eo(this.serializer,o))}))}),R.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return rk(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),R.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return R.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Qa(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Ar(s[1]);i.push(c)}else a.done()}).next(()=>{X(i.length===0)})})}containsKey(e,n){return ik(e,this.userId,n)}xn(e){return sk(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function ik(t,e,n){let r=tg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Qa(t).J({range:s,H:!0},(a,c,u)=>{let[d,h,g]=a;d===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function Yi(t){return At(t,"mutations")}function Qa(t){return At(t,"documentMutations")}function sk(t){return At(t,"mutationQueues")}var cc=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Ln(){return new t(-1)}};var DI=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Bn(e).next(n=>{let r=new cc(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Bn(e).next(n=>te.fromTimestamp(new Je(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Bn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Bn(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ha(e).delete(n.targetId)).next(()=>this.Bn(e)).next(r=>(X(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ha(e).J((o,a)=>{let c=Nu(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>R.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ha(e).J((r,i)=>{let s=Nu(i);n(s)})}Bn(e){return LP(e).get("targetGlobalKey").next(n=>(X(n!==null),n))}kn(e,n){return LP(e).put("targetGlobalKey",n)}qn(e,n){return Ha(e).put(ek(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Bn(e).next(n=>n.targetCount)}getTargetData(e,n){let r=co(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ha(e).J({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=Nu(a);ad(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Zi(e);return n.forEach(o=>{let a=nn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),R.waitFor(i)}removeMatchingKeys(e,n,r){let i=Zi(e);return R.forEach(n,s=>{let o=nn(s.path);return R.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Zi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Zi(e),s=he();return i.J({range:r,H:!0},(o,a,c)=>{let u=Ar(o[1]),d=new G(u);s=s.add(d)}).next(()=>s)}containsKey(e,n){let r=nn(n.path),i=IDBKeyRange.bound([r],[r1(r)],!1,!0),s=0;return Zi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}ot(e,n){return Ha(e).get(n).next(r=>r?Nu(r):null)}};function Ha(t){return At(t,"targets")}function LP(t){return At(t,"targetGlobal")}function Zi(t){return At(t,"targetDocuments")}function VP([t,e],[n,r]){let i=ue(t,n);return i===0?ue(e,r):i}var bI=class{constructor(e){this.Kn=e,this.buffer=new Ue(VP),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();VP(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},TI=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){O("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>x(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){hs(n)?O("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield ds(n)}yield this.zn(3e5)}))}},SI=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return R.resolve(bn.oe);let r=new bI(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(O("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve(FP)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(O("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),FP):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(O("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Ga()<=Nn.DEBUG&&O("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function ez(t,e){return new SI(t,e)}var AI=class{constructor(e,n){this.db=e,this.garbageCollector=ez(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Jp(e,r)}removeReference(e,n,r){return Jp(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Jp(e,n)}er(e,n){return function(i,s){let o=!1;return sk(i).Y(a=>ik(i,a,s).next(c=>(c&&(o=!0),R.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,te.min()),Zi(e).delete(function(h){return[0,nn(h.path)]}(o))))});i.push(c)}}).next(()=>R.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Jp(e,n)}Xn(e,n){let r=Zi(e),i,s=bn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==bn.oe&&n(new G(Ar(i)),s),s=u,i=c):s=bn.oe}).next(()=>{s!==bn.oe&&n(new G(Ar(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Jp(t,e){return Zi(t).put(function(r,i){return{targetId:0,path:nn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var xg=class{constructor(){this.changes=new Or(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,vt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?R.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var xI=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Zs(e).put(r)}removeEntry(e,n,r){return Zs(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Cg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=vt.newInvalidDocument(n);return Zs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(xu(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:vt.newInvalidDocument(n)};return Zs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(xu(n))},(i,s)=>{r={document:this.nr(n,s),size:Sg(s)}}).next(()=>r)}getEntries(e,n){let r=hn();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=hn(),i=new We(G.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Sg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return R.resolve();let i=new Ue(BP);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(xu(i.first()),xu(i.last())),o=i.getIterator(),a=o.getNext();return Zs(e).J({index:"documentKeyIndex",range:s},(c,u,d)=>{let h=G.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&BP(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(xu(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Cg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Zs(e).U(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let d=hn();for(let h of u){let g=this.nr(G.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);g.isFoundDocument()&&(ld(n,g)||i.has(g.key))&&(d=d.insert(g.key,g))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=hn(),o=UP(n,r),a=UP(n,Un.max());return Zs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{let h=this.nr(G.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new RI(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return jP(e).get("remoteDocumentGlobalKey").next(n=>(X(!!n),n))}tr(e,n){return jP(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=Z9(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(te.min())))return r}return vt.newInvalidDocument(e)}};function ok(t){return new xI(t)}var RI=class extends xg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Or(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Ue((s,o)=>ue(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=TP(this.ar.serializer,o);i=i.add(s.path.popLast());let u=Sg(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=TP(this.ar.serializer,o.convertToNoDocument(te.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),R.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function jP(t){return At(t,"remoteDocumentGlobal")}function Zs(t){return At(t,"remoteDocumentsV14")}function xu(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function UP(t,e){let n=e.documentKey.path.toArray();return[t,Cg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function BP(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ue(n[s],r[s]),i)return i;return i=ue(n.length,r.length),i||(i=ue(n[n.length-2],r[r.length-2]),i||ue(n[n.length-1],r[r.length-1]))}var MI=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Rg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ou(r.mutation,i,Tn.empty(),Je.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,he()).next(()=>r))}getLocalViewOfDocuments(e,n,r=he()){let i=xr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Mu();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=xr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,he()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=hn(),o=ku(),a=function(){return ku()}();return n.forEach((c,u)=>{let d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof sr)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),Ou(d.mutation,u,d.mutation.getFieldMask(),Je.now())):o.set(u.key,Tn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return a.set(u,new MI(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){let r=ku(),i=new We((o,a)=>o-a),s=he();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let d=r.get(c)||Tn.empty();d=a.applyToLocalView(u,d),r.set(c,d);let h=(i.get(a.batchId)||he()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,d=c.value,h=x1();d.forEach(g=>{if(!s.has(g)){let y=L1(n.get(g),r.get(g));y!==null&&h.set(g,y),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return G.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):F0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):R.resolve(xr()),a=-1,c=s;return o.next(u=>R.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?R.resolve():this.remoteDocumentCache.getEntry(e,d).next(g=>{c=c.insert(d,g)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,he())).next(d=>({batchId:a,changes:A1(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new G(n)).next(r=>{let i=Mu();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Mu();return this.indexManager.getCollectionParents(e,s).next(a=>R.forEach(a,c=>{let u=function(h,g){return new ir(g,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((h,g)=>{o=o.insert(h,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let d=u.getKey();o.get(d)===null&&(o=o.insert(d,vt.newInvalidDocument(d)))});let a=Mu();return o.forEach((c,u)=>{let d=s.get(c);d!==void 0&&Ou(d.mutation,u,Tn.empty(),Je.now()),ld(n,u)&&(a=a.insert(c,u))}),a})}};var NI=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return R.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:dt(i.createTime)}}(n)),R.resolve()}getNamedQuery(e,n){return R.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:j0(i.bundledQuery),readTime:dt(i.readTime)}}(n)),R.resolve()}};var PI=class{constructor(){this.overlays=new We(G.comparator),this.hr=new Map}getOverlay(e,n){return R.resolve(this.overlays.get(n))}getOverlays(e,n){let r=xr();return R.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),R.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),R.resolve()}getOverlaysForCollection(e,n,r){let i=xr(),s=n.length+1,o=new G(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return R.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new We((u,d)=>u-d),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=xr(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}let a=xr(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return R.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zu(n,r));let s=this.hr.get(n);s===void 0&&(s=he(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var Ju=class{constructor(){this.Pr=new Ue(gt.Ir),this.Tr=new Ue(gt.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new gt(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new gt(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new G(new Se([])),r=new gt(n,e),i=new gt(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new G(new Se([])),r=new gt(n,e),i=new gt(n,e+1),s=he();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new gt(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},gt=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return G.comparator(e.key,n.key)||ue(e.pr,n.pr)}static Er(e,n){return ue(e.pr,n.pr)||G.comparator(e.key,n.key)}};var kI=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ue(gt.Ir)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Gu(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new gt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,n){return R.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return R.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new gt(n,0),i=new gt(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),R.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(ue);return n.forEach(i=>{let s=new gt(i,0),o=new gt(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),R.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;G.isDocumentKey(s)||(s=s.child(""));let o=new gt(new G(s),0),a=new Ue(ue);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),R.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){X(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return R.forEach(n.mutations,i=>{let s=new gt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new gt(n,0),i=this.wr.firstAfterOrEqual(r);return R.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var OI=class{constructor(e){this.vr=e,this.docs=function(){return new We(G.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return R.resolve(r?r.document.mutableCopy():vt.newInvalidDocument(n))}getEntries(e,n){let r=hn();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():vt.newInvalidDocument(i))}),R.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=hn(),o=n.path,a=new G(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||N0(s1(d),r)<=0||(i.has(d.key)||ld(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return R.resolve(s)}getAllFromCollectionGroup(e,n,r,i){K()}Fr(e,n){return R.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new FI(this)}getSize(e){return R.resolve(this.size)}},FI=class extends xg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),R.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var LI=class{constructor(e){this.persistence=e,this.Mr=new Or(n=>co(n),ad),this.lastRemoteSnapshotVersion=te.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Ju,this.targetCount=0,this.Lr=cc.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),R.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Lr=new cc(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,R.resolve()}updateTargetData(e,n){return this.qn(n),R.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),R.waitFor(s).next(()=>i)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return R.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),R.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),R.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),R.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return R.resolve(r)}containsKey(e,n){return R.resolve(this.Nr.containsKey(n))}};var Mg=class{constructor(e,n){this.Br={},this.overlays={},this.kr=new bn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new LI(this),this.indexManager=new II,this.remoteDocumentCache=function(i){return new OI(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Ig(n),this.$r=new NI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new PI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Br[e.toKey()];return r||(r=new kI(n,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){O("MemoryPersistence","Starting transaction:",e);let i=new VI(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return R.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,n)))}},VI=class extends ug{constructor(e){super(),this.currentSequenceNumber=e}},Ng=class t{constructor(e){this.persistence=e,this.zr=new Ju,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw K()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),R.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),R.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.Jr,r=>{let i=G.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,te.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return R.or([()=>R.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var jI=class{constructor(e){this.serializer=e}O(e,n,r,i){let s=new dg("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iP,{unique:!0}),c.createObjectStore("documentMutations")}(e),$P(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=R.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),$P(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:te.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(d=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",iP,{unique:!0});let h=u.store("mutations"),g=d.map(y=>h.put(y));return R.waitFor(g)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:v9});u.createIndex("collectionPathOverlayIndex",_9,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",w9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:a9});u.createIndex("documentKeyIndex",c9),u.createIndex("collectionGroupIndex",l9)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:p9}).createIndex("sequenceNumberIndex",g9,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:m9}).createIndex("documentKeyIndex",y9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),o}ei(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Sg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>R.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>R.forEach(a,c=>{X(c.userId===s.userId);let u=eo(this.serializer,c);return rk(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.J((o,a)=>{let c=new Se(o),u=function(h){return[0,nn(h)]}(c);s.push(n.get(u).next(d=>d?R.resolve():(h=>n.put({targetId:0,path:nn(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>R.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:f9});let r=n.store("collectionParents"),i=new Zu,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:nn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new Se(o);return s(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],u)=>{let d=Ar(a);return s(d.popLast())}))}ri(e){let n=e.store("targets");return n.J((r,i)=>{let s=Nu(i),o=ek(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(h){return h.document?new G(Se.fromString(h.document.name).popFirst(5)):h.noDocument?G.fromSegments(h.noDocument.path):h.unknownDocument?G.fromSegments(h.unknownDocument.path):K()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>R.waitFor(i))}si(e,n){let r=n.store("mutations"),i=ok(this.serializer),s=new Mg(Ng.Hr,this.serializer.ct);return r.U().next(o=>{let a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:he();eo(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),R.forEach(a,(c,u)=>{let d=new mt(u),h=Dg.lt(this.serializer,d),g=s.getIndexManager(d),y=Ag.lt(d,this.serializer,g,s.referenceDelegate);return new Rg(i,y,h,g).recalculateAndSaveOverlaysForDocumentKeys(new Uu(n,bn.oe),c).next()})})}};function $P(t){t.createObjectStore("targetDocuments",{keyPath:d9}).createIndex("documentTargetsIndex",h9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",u9,{unique:!0}),t.createObjectStore("targetGlobal")}var RE="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",UI=class t{constructor(e,n,r,i,s,o,a,c,u,d,h=16){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=d,this.ui=h,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=g=>Promise.resolve(),!t.D())throw new P(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new AI(this,i),this.Ti=n+"main",this.serializer=new Ig(c),this.Ei=new ns(this.Ti,this.ui,new jI(this.serializer)),this.Qr=new DI(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ok(this.serializer),this.$r=new gI,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,d===!1&&lt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new P(N.FAILED_PRECONDITION,RE);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new bn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>x(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>x(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>x(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Xp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(hs(e))return O("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return O("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return Ru(e).get("owner").next(n=>R.resolve(this.Si(n)))}bi(e){return Xp(e).delete(this.clientId)}Di(){return x(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=At(n,"clientMetadata");return r.U().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return R.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?R.resolve(!0):Ru(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new P(N.FAILED_PRECONDITION,RE);return!1}}return!(!this.networkEnabled||!this.inForeground)||Xp(e).U().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&O("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return x(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Uu(e,bn.oe);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Li()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Bi(){return this.runTransaction("getActiveClients","readonly",e=>Xp(e).U().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Ag.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new CI(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Dg.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){O("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===16?I9:c===15?f1:c===14?h1:c===13?d1:c===12?E9:c===11?u1:void K()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Uu(a,this.kr?this.kr.next():bn.oe),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw lt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new P(N.FAILED_PRECONDITION,o1);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return Ru(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new P(N.FAILED_PRECONDITION,RE)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ru(e).put("owner",n)}static D(){return ns.D()}yi(e){let n=Ru(e);return n.get("owner").next(r=>this.Si(r)?(O("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):R.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(lt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Ly()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return O("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return lt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){lt("Failed to set zombie client id.",e)}}Li(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function Ru(t){return At(t,"owner")}function Xp(t){return At(t,"clientMetadata")}function B0(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var BI=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=he(),i=he();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var $I=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Pg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Ly()?8:a1(ll())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new $I;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Ga()<=Nn.DEBUG&&O("QueryEngine","SDK will not create cache indexes for query:",za(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),R.resolve()):(Ga()<=Nn.DEBUG&&O("QueryEngine","Query:",za(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Ga()<=Nn.DEBUG&&O("QueryEngine","The SDK decides to create cache indexes for query:",za(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rn(n))):R.resolve())}ji(e,n){if(gP(n))return R.resolve(null);let r=rn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=vg(n,null,"F"),r=rn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=he(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,vg(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return gP(n)||i.isEqual(te.min())?R.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?R.resolve(null):(Ga()<=Nn.DEBUG&&O("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),za(n)),this.es(e,o,n,i1(i,-1)).next(a=>a))})}Zi(e,n){let r=new Ue(T1(e));return n.forEach((i,s)=>{ld(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Ga()<=Nn.DEBUG&&O("QueryEngine","Using full collection scan to execute query:",za(n)),this.zi.getDocumentsMatchingQuery(e,n,Un.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var qI=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new We(ue),this.rs=new Or(s=>co(s),ad),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function ak(t,e,n,r){return new qI(t,e,n,r)}function ck(t,e){return x(this,null,function*(){let n=z(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=he();for(let u of i){o.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}for(let u of s){a.push(u.batchId);for(let d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function tz(t,e){let n=z(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,d){let h=u.batch,g=h.keys(),y=R.resolve();return g.forEach(E=>{y=y.next(()=>d.getEntry(c,E)).next(D=>{let S=u.docVersions.get(E);X(S!==null),D.version.compareTo(S)<0&&(h.applyToRemoteDocument(D,u),D.isValidDocument()&&(D.setReadTime(u.commitVersion),d.addEntry(D)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(c,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=he();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function lk(t){let e=z(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function nz(t,e){let n=z(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((d,h)=>{let g=i.get(h);if(!g)return;a.push(n.Qr.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Qr.addMatchingKeys(s,d.addedDocuments,h)));let y=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(St.EMPTY_BYTE_STRING,te.min()).withLastLimboFreeSnapshotVersion(te.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(h,y),function(D,S,k){return D.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(g,y,d)&&a.push(n.Qr.updateTargetData(s,y))});let c=hn(),u=he();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(uk(s,o,e.documentUpdates).next(d=>{c=d.cs,u=d.ls})),!r.isEqual(te.min())){let d=n.Qr.getLastRemoteSnapshotVersion(s).next(h=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return R.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function uk(t,e,n){let r=he(),i=he();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=hn();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(te.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):O("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function rz(t,e){let n=z(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function lc(t,e){let n=z(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,R.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new ac(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function uc(t,e,n){return x(this,null,function*(){let r=z(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!hs(o))throw o;O("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function kg(t,e,n){let r=z(t),i=te.min(),s=he();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){let h=z(c),g=h.rs.get(d);return g!==void 0?R.resolve(h.ns.get(g)):h.Qr.getTargetData(u,d)}(r,o,rn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:te.min(),n?s:he())).next(a=>(fk(r,b1(e),a),{documents:a,hs:s})))}function dk(t,e){let n=z(t),r=z(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function hk(t,e){let n=z(t),r=n.ss.get(e)||te.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,i1(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(fk(n,e,i),i))}function fk(t,e,n){let r=t.ss.get(e)||te.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function iz(t,e,n,r){return x(this,null,function*(){let i=z(t),s=he(),o=hn();for(let u of n){let d=e.Ps(u.metadata.name);u.document&&(s=s.add(d));let h=e.Is(u);h.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(d,h)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield lc(i,function(d){return rn(vc(Se.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>uk(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.cs,d.ls)).next(()=>d.cs)))})}function sz(r,i){return x(this,arguments,function*(t,e,n=he()){let s=yield lc(t,rn(j0(e.bundledQuery))),o=z(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=dt(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(St.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function qP(t,e){return`firestore_clients_${t}_${e}`}function HP(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function ME(t,e){return`firestore_targets_${t}_${e}`}var Og=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new P(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(lt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Fu=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new P(r.error.code,r.error.message))),s?new t(e,r.state,i):(lt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Fg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=L0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=c1(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(lt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},HI=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(lt("SharedClientState",`Failed to parse online state: ${e}`),null)}},Xu=class{constructor(){this.activeTargetIds=L0()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Lu=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new We(ue),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=qP(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new Xu),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return x(this,null,function*(){let e=yield this.syncEngine.Bi();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(qP(this.persistenceKey,r));if(i){let s=Fg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Ls(e,"pending")}updateMutationState(e,n,r){this.Ls(e,n,r),this.Bs(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(ME(this.persistenceKey,e));if(r){let i=Fu.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ME(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Bs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return O("SharedClientState","READ",e,n),n}setItem(e,n){O("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){O("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(O("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void lt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>x(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=bn.oe;if(s!=null)try{let a=JSON.parse(s);X(typeof a=="number"),o=a}catch(a){lt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==bn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Ls(e,n,r){let i=new Og(this.currentUser,e,n,r),s=HP(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Bs(e){let n=HP(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=ME(this.persistenceKey,e),s=new Fu(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return Fg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Og.Es(new mt(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Fu.Es(i,n)}xs(e){return HI.Es(e)}Js(e){return JSON.parse(e)}zs(e){return x(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);O("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=L0();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Lg=class{constructor(){this.no=new Xu,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Xu,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var GI=class{io(e){}shutdown(){}};var Vg=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){O("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){O("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var eg=null;function NE(){return eg===null?eg=function(){return 268435456+Math.round(2147483648*Math.random())}():eg++,"0x"+eg.toString(16)}var oz={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var zI=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}};var Gt="WebChannelConnection",WI=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+n.host,this.So=`projects/${i}/databases/${s}`,this.bo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Do(){return!1}Co(n,r,i,s,o){let a=NE(),c=this.vo(n,r.toUriEncodedString());O("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(u,s,o),this.Mo(n,c,u,i).then(d=>(O("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw jn("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",c,"request:",i),d})}xo(n,r,i,s,o,a){return this.Co(n,r,i,s,o)}Fo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yc}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}vo(n,r){let i=oz[n];return`${this.wo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,n,r,i){let s=NE();return new Promise((o,a)=>{let c=new CE;c.setWithCredentials(!0),c.listenOnce(bE.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Tu.NO_ERROR:let d=c.getResponseJson();O(Gt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Tu.TIMEOUT:O(Gt,`RPC '${e}' ${s} timed out`),a(new P(N.DEADLINE_EXCEEDED,"Request time out"));break;case Tu.HTTP_ERROR:let h=c.getStatus();if(O(Gt,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let g=c.getResponseJson();Array.isArray(g)&&(g=g[0]);let y=g?.error;if(y&&y.status&&y.message){let E=function(S){let k=S.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(k)>=0?k:N.UNKNOWN}(y.status);a(new P(E,y.message))}else a(new P(N.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new P(N.UNAVAILABLE,"Connection failed."));break;default:K()}}finally{O(Gt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);O(Gt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Oo(e,n,r){let i=NE(),s=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=AE(),a=SE(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new DE({})),this.Fo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let d=s.join("");O(Gt,`Creating RPC '${e}' stream ${i}: ${d}`,c);let h=o.createWebChannel(d,c),g=!1,y=!1,E=new zI({lo:S=>{y?O(Gt,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(g||(O(Gt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),g=!0),O(Gt,`RPC '${e}' stream ${i} sending:`,S),h.send(S))},ho:()=>h.close()}),D=(S,k,q)=>{S.listen(k,F=>{try{q(F)}catch(Y){setTimeout(()=>{throw Y},0)}})};return D(h,Ua.EventType.OPEN,()=>{y||(O(Gt,`RPC '${e}' stream ${i} transport opened.`),E.mo())}),D(h,Ua.EventType.CLOSE,()=>{y||(y=!0,O(Gt,`RPC '${e}' stream ${i} transport closed`),E.po())}),D(h,Ua.EventType.ERROR,S=>{y||(y=!0,jn(Gt,`RPC '${e}' stream ${i} transport errored:`,S),E.po(new P(N.UNAVAILABLE,"The operation could not be completed")))}),D(h,Ua.EventType.MESSAGE,S=>{var k;if(!y){let q=S.data[0];X(!!q);let F=q,Y=F.error||((k=F[0])===null||k===void 0?void 0:k.error);if(Y){O(Gt,`RPC '${e}' stream ${i} received error:`,Y);let ie=Y.status,ne=function(w){let C=pt[w];if(C!==void 0)return U1(C)}(ie),I=Y.message;ne===void 0&&(ne=N.INTERNAL,I="Unknown error status: "+ie+" with message "+Y.message),y=!0,E.po(new P(ne,I)),h.close()}else O(Gt,`RPC '${e}' stream ${i} received:`,q),E.yo(q)}}),D(a,TE.STAT_EVENT,S=>{S.stat===Yp.PROXY?O(Gt,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Yp.NOPROXY&&O(Gt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.fo()},0),E}};function pk(){return typeof window<"u"?window:null}function sg(){return typeof document<"u"?document:null}function ud(t){return new uI(t,!0)}var ed=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.No=r,this.Lo=i,this.Bo=s,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();let n=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),i=Math.max(0,n-r);i>0&&O("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}};var jg=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.Go=r,this.zo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new ed(e,n)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}stop(){return x(this,null,function*(){this.Zo()&&(yield this.close(0))})}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}r_(){return x(this,null,function*(){if(this.Xo())return this.close(0)})}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}close(e,n){return x(this,null,function*(){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():n&&n.code===N.RESOURCE_EXHAUSTED?(lt(n.toString()),lt("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):n&&n.code===N.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Ao(n)})}__(){}auth(){this.state=1;let e=this.a_(this.jo),n=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.jo===n&&this.u_(r,i)},r=>{e(()=>{let i=new P(N.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(i)})})}u_(e,n){let r=this.a_(this.jo);this.stream=this.l_(e,n),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(i=>{r(()=>this.c_(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}e_(){this.state=5,this.Yo.$o(()=>x(this,null,function*(){this.state=0,this.start()}))}c_(e){return O("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return n=>{this.oi.enqueueAndForget(()=>this.jo===e?n():(O("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},KI=class extends jg{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}l_(e,n){return this.connection.Oo("Listen",e,n)}onMessage(e){this.Yo.reset();let n=H9(this.serializer,e),r=function(s){if(!("targetChange"in s))return te.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?te.min():o.readTime?dt(o.readTime):te.min()}(e);return this.listener.h_(n,r)}P_(e){let n={};n.database=fI(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=mg(c)?{documents:K1(s,c)}:{query:Q1(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=$1(s,o.resumeToken);let u=dI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(te.min())>0){a.readTime=oc(s,o.snapshotVersion.toTimestamp());let u=dI(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=z9(this.serializer,e);r&&(n.labels=r),this.i_(n)}I_(e){let n={};n.database=fI(this.serializer),n.removeTarget=e,this.i_(n)}},QI=class extends jg{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,n){return this.connection.Oo("Write",e,n)}onMessage(e){if(X(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();let n=G9(e.writeResults,e.commitTime),r=dt(e.commitTime);return this.listener.A_(r,n)}return X(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){let e={};e.database=fI(this.serializer),this.i_(e)}d_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>Yu(this.serializer,r))};this.i_(n)}};var YI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.m_=!1}f_(){if(this.m_)throw new P(N.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,n,r,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Co(e,hI(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new P(N.UNKNOWN,s.toString())})}xo(e,n,r,i,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,hI(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===N.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new P(N.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}},ZI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(lt(n),this.y_=!1):O("OnlineStateTracker",n)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}};var JI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=s,this.O_.io(o=>{r.enqueueAndForget(()=>x(this,null,function*(){fs(this)&&(O("RemoteStore","Restarting streams for network reachability change."),yield function(c){return x(this,null,function*(){let u=z(c);u.M_.add(4),yield _c(u),u.N_.set("Unknown"),u.M_.delete(4),yield dd(u)})}(this))}))}),this.N_=new ZI(r,i)}};function dd(t){return x(this,null,function*(){if(fs(t))for(let e of t.x_)yield e(!0)})}function _c(t){return x(this,null,function*(){for(let e of t.x_)yield e(!1)})}function im(t,e){let n=z(t);n.F_.has(e.targetId)||(n.F_.set(e.targetId,e),H0(n)?q0(n):Ec(n).Xo()&&$0(n,e))}function dc(t,e){let n=z(t),r=Ec(n);n.F_.delete(e),r.Xo()&&gk(n,e),n.F_.size===0&&(r.Xo()?r.n_():fs(n)&&n.N_.set("Unknown"))}function $0(t,e){if(t.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(te.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ec(t).P_(e)}function gk(t,e){t.L_.xe(e),Ec(t).I_(e)}function q0(t){t.L_=new lI({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.F_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ec(t).start(),t.N_.w_()}function H0(t){return fs(t)&&!Ec(t).Zo()&&t.F_.size>0}function fs(t){return z(t).M_.size===0}function mk(t){t.L_=void 0}function az(t){return x(this,null,function*(){t.N_.set("Online")})}function cz(t){return x(this,null,function*(){t.F_.forEach((e,n)=>{$0(t,e)})})}function lz(t,e){return x(this,null,function*(){mk(t),H0(t)?(t.N_.D_(e),q0(t)):t.N_.set("Unknown")})}function uz(t,e,n){return x(this,null,function*(){if(t.N_.set("Online"),e instanceof wg&&e.state===2&&e.cause)try{yield function(i,s){return x(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.F_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.F_.delete(a),i.L_.removeTarget(a))})}(t,e)}catch(r){O("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Ug(t,r)}else if(e instanceof Xa?t.L_.Ke(e):e instanceof _g?t.L_.He(e):t.L_.We(e),!n.isEqual(te.min()))try{let r=yield lk(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.L_.rt(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let d=s.F_.get(u);d&&s.F_.set(u,d.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let d=s.F_.get(c);if(!d)return;s.F_.set(c,d.withResumeToken(St.EMPTY_BYTE_STRING,d.snapshotVersion)),gk(s,c);let h=new ac(d.target,c,u,d.sequenceNumber);$0(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){O("RemoteStore","Failed to raise snapshot:",r),yield Ug(t,r)}})}function Ug(t,e,n){return x(this,null,function*(){if(!hs(e))throw e;t.M_.add(1),yield _c(t),t.N_.set("Offline"),n||(n=()=>lk(t.localStore)),t.asyncQueue.enqueueRetryable(()=>x(this,null,function*(){O("RemoteStore","Retrying IndexedDB access"),yield n(),t.M_.delete(1),yield dd(t)}))})}function yk(t,e){return e().catch(n=>Ug(t,n,e))}function wc(t){return x(this,null,function*(){let e=z(t),n=us(e),r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;dz(e);)try{let i=yield rz(e.localStore,r);if(i===null){e.v_.length===0&&n.n_();break}r=i.batchId,hz(e,i)}catch(i){yield Ug(e,i)}vk(e)&&_k(e)})}function dz(t){return fs(t)&&t.v_.length<10}function hz(t,e){t.v_.push(e);let n=us(t);n.Xo()&&n.E_&&n.d_(e.mutations)}function vk(t){return fs(t)&&!us(t).Zo()&&t.v_.length>0}function _k(t){us(t).start()}function fz(t){return x(this,null,function*(){us(t).V_()})}function pz(t){return x(this,null,function*(){let e=us(t);for(let n of t.v_)e.d_(n.mutations)})}function gz(t,e,n){return x(this,null,function*(){let r=t.v_.shift(),i=oI.from(r,e,n);yield yk(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield wc(t)})}function mz(t,e){return x(this,null,function*(){e&&us(t).E_&&(yield function(r,i){return x(this,null,function*(){if(function(o){return j1(o)&&o!==N.ABORTED}(i.code)){let s=r.v_.shift();us(r).t_(),yield yk(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield wc(r)}})}(t,e)),vk(t)&&_k(t)})}function GP(t,e){return x(this,null,function*(){let n=z(t);n.asyncQueue.verifyOperationInProgress(),O("RemoteStore","RemoteStore received new credentials");let r=fs(n);n.M_.add(3),yield _c(n),r&&n.N_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.M_.delete(3),yield dd(n)})}function XI(t,e){return x(this,null,function*(){let n=z(t);e?(n.M_.delete(2),yield dd(n)):e||(n.M_.add(2),yield _c(n),n.N_.set("Unknown"))})}function Ec(t){return t.B_||(t.B_=function(n,r,i){let s=z(n);return s.f_(),new KI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:az.bind(null,t),To:cz.bind(null,t),Ao:lz.bind(null,t),h_:uz.bind(null,t)}),t.x_.push(e=>x(this,null,function*(){e?(t.B_.t_(),H0(t)?q0(t):t.N_.set("Unknown")):(yield t.B_.stop(),mk(t))}))),t.B_}function us(t){return t.k_||(t.k_=function(n,r,i){let s=z(n);return s.f_(),new QI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:()=>Promise.resolve(),To:fz.bind(null,t),Ao:mz.bind(null,t),R_:pz.bind(null,t),A_:gz.bind(null,t)}),t.x_.push(e=>x(this,null,function*(){e?(t.k_.t_(),yield wc(t)):(yield t.k_.stop(),t.v_.length>0&&(O("RemoteStore",`Stopping write stream with ${t.v_.length} pending writes`),t.v_=[]))}))),t.k_}var e0=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new yt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ic(t,e){if(lt("AsyncQueue",`${e}: ${t}`),hs(t))return new P(N.UNAVAILABLE,`${e}: ${t}`);throw t}var Bg=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||G.comparator(n.key,r.key):(n,r)=>G.comparator(n.key,r.key),this.keyedMap=Mu(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var $g=class{constructor(){this.q_=new We(G.comparator)}track(e){let n=e.doc.key,r=this.q_.get(n);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(n,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(n):e.type===1&&r.type===2?this.q_=this.q_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(n,{type:2,doc:e.doc}):K():this.q_=this.q_.insert(n,e)}Q_(){let e=[];return this.q_.inorderTraversal((n,r)=>{e.push(r)}),e}},hc=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,Bg.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var t0=class{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}},n0=class{constructor(){this.queries=new Or(e=>D1(e),cd),this.onlineState="Unknown",this.z_=new Set}};function G0(t,e){return x(this,null,function*(){let n=z(t),r=3,i=e.query,s=n.queries.get(i);s?!s.W_()&&e.G_()&&(r=2):(s=new t0,r=e.G_()?0:1);try{switch(r){case 0:s.K_=yield n.onListen(i,!0);break;case 1:s.K_=yield n.onListen(i,!1);break;case 2:yield n.onFirstRemoteStoreListen(i)}}catch(o){let a=Ic(o,`Initialization of query '${za(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.U_.push(e),e.j_(n.onlineState),s.K_&&e.H_(s.K_)&&W0(n)})}function z0(t,e){return x(this,null,function*(){let n=z(t),r=e.query,i=3,s=n.queries.get(r);if(s){let o=s.U_.indexOf(e);o>=0&&(s.U_.splice(o,1),s.U_.length===0?i=e.G_()?0:1:!s.W_()&&e.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}})}function yz(t,e){let n=z(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.U_)a.H_(i)&&(r=!0);o.K_=i}}r&&W0(n)}function vz(t,e,n){let r=z(t),i=r.queries.get(e);if(i)for(let s of i.U_)s.onError(n);r.queries.delete(e)}function W0(t){t.z_.forEach(e=>{e.next()})}var r0,zP;(zP=r0||(r0={})).J_="default",zP.Cache="cache";var td=class{constructor(e,n,r){this.query=e,this.Y_=n,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new hc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),n=!0):this.ta(e,this.onlineState)&&(this.na(e),n=!0),this.X_=e,n}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let n=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),n=!0),n}ta(e,n){if(!e.fromCache||!this.G_())return!0;let r=n!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ea(e){if(e.docChanges.length>0)return!0;let n=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}na(e){e=hc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==r0.Cache}};var i0=class{constructor(e,n){this.ia=e,this.byteLength=n}sa(){return"metadata"in this.ia}};var qg=class{constructor(e){this.serializer=e}Ps(e){return Mr(this.serializer,e)}Is(e){return e.metadata.exists?W1(this.serializer,e.document,!1):vt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return dt(e)}},s0=class{constructor(e,n,r){this.oa=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=wk(e)}_a(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.ia.namedQuery)this.queries.push(e.ia.namedQuery);else if(e.ia.documentMetadata){this.documents.push({metadata:e.ia.documentMetadata}),e.ia.documentMetadata.exists||++n;let r=Se.fromString(e.ia.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ia.document&&(this.documents[this.documents.length-1].document=e.ia.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}aa(e){let n=new Map,r=new qg(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||he()).add(s);n.set(o,a)}}return n}complete(){return x(this,null,function*(){let e=yield iz(this.localStore,new qg(this.serializer),this.documents,this.oa.id),n=this.aa(this.documents);for(let r of this.queries)yield sz(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ua:this.collectionGroups,ca:e}})}};function wk(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Hg=class{constructor(e){this.key=e}},Gg=class{constructor(e){this.key=e}},zg=class{constructor(e,n){this.query=e,this.la=n,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=he(),this.mutatedKeys=he(),this.Ia=T1(e),this.Ta=new Bg(this.Ia)}get Ea(){return this.la}da(e,n){let r=n?n.Aa:new $g,i=n?n.Ta:this.Ta,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{let g=i.get(d),y=ld(this.query,h)?h:null,E=!!g&&this.mutatedKeys.has(g.key),D=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations),S=!1;g&&y?g.data.isEqual(y.data)?E!==D&&(r.track({type:3,doc:y}),S=!0):this.Ra(g,y)||(r.track({type:2,doc:y}),S=!0,(c&&this.Ia(y,c)>0||u&&this.Ia(y,u)<0)&&(a=!0)):!g&&y?(r.track({type:0,doc:y}),S=!0):g&&!y&&(r.track({type:1,doc:g}),S=!0,(c||u)&&(a=!0)),S&&(y?(o=o.add(y),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:s}}Ra(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;let o=e.Aa.Q_();o.sort((d,h)=>function(y,E){let D=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K()}};return D(y)-D(E)}(d.type,h.type)||this.Ia(d.doc,h.doc)),this.Va(r),i=i!=null&&i;let a=n&&!i?this.ma():[],c=this.Pa.size===0&&this.current&&!i?1:0,u=c!==this.ha;return this.ha=c,o.length!==0||u?{snapshot:new hc(this.query,e.Ta,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new $g,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(n=>this.la=this.la.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.la=this.la.delete(n)),this.current=e.current)}ma(){if(!this.current)return[];let e=this.Pa;this.Pa=he(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});let n=[];return e.forEach(r=>{this.Pa.has(r)||n.push(new Gg(r))}),this.Pa.forEach(r=>{e.has(r)||n.push(new Hg(r))}),n}pa(e){this.la=e.hs,this.Pa=he();let n=this.da(e.documents);return this.applyChanges(n,!0)}ya(){return hc.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}},o0=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},a0=class{constructor(e){this.key=e,this.wa=!1}},c0=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Or(a=>D1(a),cd),this.Da=new Map,this.Ca=new Set,this.va=new We(G.comparator),this.Fa=new Map,this.Ma=new Ju,this.xa={},this.Oa=new Map,this.Na=cc.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}};function _z(t,e,n=!0){return x(this,null,function*(){let r=sm(t),i,s=r.ba.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=yield Ek(r,e,n,!0),i})}function wz(t,e){return x(this,null,function*(){let n=sm(t);yield Ek(n,e,!0,!1)})}function Ek(t,e,n,r){return x(this,null,function*(){let i=yield lc(t.localStore,rn(e)),s=i.targetId,o=n?t.sharedClientState.addLocalQueryTarget(s):"not-current",a;return r&&(a=yield K0(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&im(t.remoteStore,i),a})}function K0(t,e,n,r,i){return x(this,null,function*(){t.Ba=(h,g,y)=>function(D,S,k,q){return x(this,null,function*(){let F=S.view.da(k);F.Xi&&(F=yield kg(D.localStore,S.query,!1).then(({documents:I})=>S.view.da(I,F)));let Y=q&&q.targetChanges.get(S.targetId),ie=q&&q.targetMismatches.get(S.targetId)!=null,ne=S.view.applyChanges(F,D.isPrimaryClient,Y,ie);return l0(D,S.targetId,ne.fa),ne.snapshot})}(t,h,g,y);let s=yield kg(t.localStore,e,!0),o=new zg(e,s.hs),a=o.da(s.documents),c=Ku.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);l0(t,n,u.fa);let d=new o0(e,n,o);return t.ba.set(e,d),t.Da.has(n)?t.Da.get(n).push(e):t.Da.set(n,[e]),u.snapshot})}function Ez(t,e,n){return x(this,null,function*(){let r=z(t),i=r.ba.get(e),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter(o=>!cd(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield uc(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&dc(r.remoteStore,i.targetId),fc(r,i.targetId)}).catch(ds))):(fc(r,i.targetId),yield uc(r.localStore,i.targetId,!0))})}function Iz(t,e){return x(this,null,function*(){let n=z(t),r=n.ba.get(e),i=n.Da.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),dc(n.remoteStore,r.targetId))})}function Cz(t,e,n){return x(this,null,function*(){let r=J0(t);try{let i=yield function(o,a){let c=z(o),u=Je.now(),d=a.reduce((y,E)=>y.add(E.key),he()),h,g;return c.persistence.runTransaction("Locally write mutations","readwrite",y=>{let E=hn(),D=he();return c.os.getEntries(y,d).next(S=>{E=S,E.forEach((k,q)=>{q.isValidDocument()||(D=D.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(y,E)).next(S=>{h=S;let k=[];for(let q of a){let F=L9(q,h.get(q.key).overlayedDocument);F!=null&&k.push(new sr(q.key,F,y1(F.value.mapValue),rt.exists(!0)))}return c.mutationQueue.addMutationBatch(y,u,k,a)}).next(S=>{g=S;let k=S.applyToLocalDocumentSet(h,D);return c.documentOverlayCache.saveOverlays(y,S.batchId,k)})}).then(()=>({batchId:g.batchId,changes:A1(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.xa[o.currentUser.toKey()];u||(u=new We(ue)),u=u.insert(a,c),o.xa[o.currentUser.toKey()]=u}(r,i.batchId,n),yield pi(r,i.changes),yield wc(r.remoteStore)}catch(i){let s=Ic(i,"Failed to persist write");n.reject(s)}})}function Ik(t,e){return x(this,null,function*(){let n=z(t);try{let r=yield nz(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Fa.get(s);o&&(X(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.wa=!0:i.modifiedDocuments.size>0?X(o.wa):i.removedDocuments.size>0&&(X(o.wa),o.wa=!1))}),yield pi(n,r,e)}catch(r){yield ds(r)}})}function WP(t,e,n){let r=z(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ba.forEach((s,o)=>{let a=o.view.j_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=z(o);c.onlineState=a;let u=!1;c.queries.forEach((d,h)=>{for(let g of h.U_)g.j_(a)&&(u=!0)}),u&&W0(c)}(r.eventManager,e),i.length&&r.Sa.h_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Dz(t,e,n){return x(this,null,function*(){let r=z(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Fa.get(e),s=i&&i.key;if(s){let o=new We(G.comparator);o=o.insert(s,vt.newNoDocument(s,te.min()));let a=he().add(s),c=new Wu(te.min(),new Map,new We(ue),o,a);yield Ik(r,c),r.va=r.va.remove(s),r.Fa.delete(e),Z0(r)}else yield uc(r.localStore,e,!1).then(()=>fc(r,e,n)).catch(ds)})}function bz(t,e){return x(this,null,function*(){let n=z(t),r=e.batch.batchId;try{let i=yield tz(n.localStore,e);Y0(n,r,null),Q0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield pi(n,i)}catch(i){yield ds(i)}})}function Tz(t,e,n){return x(this,null,function*(){let r=z(t);try{let i=yield function(o,a){let c=z(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,a).next(h=>(X(h!==null),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);Y0(r,e,n),Q0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield pi(r,i)}catch(i){yield ds(i)}})}function Sz(t,e){return x(this,null,function*(){let n=z(t);fs(n.remoteStore)||O("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=z(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Oa.get(r)||[];i.push(e),n.Oa.set(r,i)}catch(r){let i=Ic(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function Q0(t,e){(t.Oa.get(e)||[]).forEach(n=>{n.resolve()}),t.Oa.delete(e)}function Y0(t,e,n){let r=z(t),i=r.xa[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.xa[r.currentUser.toKey()]=i}}function fc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.Da.get(e))t.ba.delete(r),n&&t.Sa.ka(r,n);t.Da.delete(e),t.isPrimaryClient&&t.Ma.Vr(e).forEach(r=>{t.Ma.containsKey(r)||Ck(t,r)})}function Ck(t,e){t.Ca.delete(e.path.canonicalString());let n=t.va.get(e);n!==null&&(dc(t.remoteStore,n),t.va=t.va.remove(e),t.Fa.delete(n),Z0(t))}function l0(t,e,n){for(let r of n)r instanceof Hg?(t.Ma.addReference(r.key,e),Az(t,r)):r instanceof Gg?(O("SyncEngine","Document no longer in limbo: "+r.key),t.Ma.removeReference(r.key,e),t.Ma.containsKey(r.key)||Ck(t,r.key)):K()}function Az(t,e){let n=e.key,r=n.path.canonicalString();t.va.get(n)||t.Ca.has(r)||(O("SyncEngine","New document in limbo: "+n),t.Ca.add(r),Z0(t))}function Z0(t){for(;t.Ca.size>0&&t.va.size<t.maxConcurrentLimboResolutions;){let e=t.Ca.values().next().value;t.Ca.delete(e);let n=new G(Se.fromString(e)),r=t.Na.next();t.Fa.set(r,new a0(n)),t.va=t.va.insert(n,r),im(t.remoteStore,new ac(rn(vc(n.path)),r,"TargetPurposeLimboResolution",bn.oe))}}function pi(t,e,n){return x(this,null,function*(){let r=z(t),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,c)=>{o.push(r.Ba(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient){let d=u&&!u.fromCache;r.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(u){i.push(u);let d=BI.Ki(c.targetId,u);s.push(d)}}))}),yield Promise.all(o),r.Sa.h_(i),yield function(c,u){return x(this,null,function*(){let d=z(c);try{yield d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>R.forEach(u,g=>R.forEach(g.qi,y=>d.persistence.referenceDelegate.addReference(h,g.targetId,y)).next(()=>R.forEach(g.Qi,y=>d.persistence.referenceDelegate.removeReference(h,g.targetId,y)))))}catch(h){if(!hs(h))throw h;O("LocalStore","Failed to update sequence numbers: "+h)}for(let h of u){let g=h.targetId;if(!h.fromCache){let y=d.ns.get(g),E=y.snapshotVersion,D=y.withLastLimboFreeSnapshotVersion(E);d.ns=d.ns.insert(g,D)}}})}(r.localStore,s))})}function xz(t,e){return x(this,null,function*(){let n=z(t);if(!n.currentUser.isEqual(e)){O("SyncEngine","User change. New user:",e.toKey());let r=yield ck(n.localStore,e);n.currentUser=e,function(s,o){s.Oa.forEach(a=>{a.forEach(c=>{c.reject(new P(N.CANCELLED,o))})}),s.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield pi(n,r.us)}})}function Rz(t,e){let n=z(t),r=n.Fa.get(e);if(r&&r.wa)return he().add(r.key);{let i=he(),s=n.Da.get(e);if(!s)return i;for(let o of s){let a=n.ba.get(o);i=i.unionWith(a.view.Ea)}return i}}function Mz(t,e){return x(this,null,function*(){let n=z(t),r=yield kg(n.localStore,e.query,!0),i=e.view.pa(r);return n.isPrimaryClient&&l0(n,e.targetId,i.fa),i})}function Nz(t,e){return x(this,null,function*(){let n=z(t);return hk(n.localStore,e).then(r=>pi(n,r))})}function Pz(t,e,n,r){return x(this,null,function*(){let i=z(t),s=yield function(a,c){let u=z(a),d=z(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.vn(h,c).next(g=>g?u.localDocuments.getDocuments(h,g):R.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield wc(i.remoteStore):n==="acknowledged"||n==="rejected"?(Y0(i,e,r||null),Q0(i,e),function(a,c){z(z(a).mutationQueue).Mn(c)}(i.localStore,e)):K(),yield pi(i,s)):O("SyncEngine","Cannot apply mutation batch with id: "+e)})}function kz(t,e){return x(this,null,function*(){let n=z(t);if(sm(n),J0(n),e===!0&&n.La!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield KP(n,r.toArray());n.La=!0,yield XI(n.remoteStore,!0);for(let s of i)im(n.remoteStore,s)}else if(e===!1&&n.La!==!1){let r=[],i=Promise.resolve();n.Da.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(fc(n,o),uc(n.localStore,o,!0))),dc(n.remoteStore,o)}),yield i,yield KP(n,r),function(o){let a=z(o);a.Fa.forEach((c,u)=>{dc(a.remoteStore,u)}),a.Ma.mr(),a.Fa=new Map,a.va=new We(G.comparator)}(n),n.La=!1,yield XI(n.remoteStore,!1)}})}function KP(t,e,n){return x(this,null,function*(){let r=z(t),i=[],s=[];for(let o of e){let a,c=r.Da.get(o);if(c&&c.length!==0){a=yield lc(r.localStore,rn(c[0]));for(let u of c){let d=r.ba.get(u),h=yield Mz(r,d);h.snapshot&&s.push(h.snapshot)}}else{let u=yield dk(r.localStore,o);a=yield lc(r.localStore,u),yield K0(r,Dk(u),o,!1,a.resumeToken)}i.push(a)}return r.Sa.h_(s),i})}function Dk(t){return C1(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Oz(t){return function(n){return z(z(n).persistence).Bi()}(z(t).localStore)}function Fz(t,e,n,r){return x(this,null,function*(){let i=z(t);if(i.La)return void O("SyncEngine","Ignoring unexpected query state notification.");let s=i.Da.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield hk(i.localStore,b1(s[0])),a=Wu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",St.EMPTY_BYTE_STRING);yield pi(i,o,a);break}case"rejected":yield uc(i.localStore,e,!0),fc(i,e,r);break;default:K()}})}function Lz(t,e,n){return x(this,null,function*(){let r=sm(t);if(r.La){for(let i of e){if(r.Da.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){O("SyncEngine","Adding an already active target "+i);continue}let s=yield dk(r.localStore,i),o=yield lc(r.localStore,s);yield K0(r,Dk(s),o.targetId,!1,o.resumeToken),im(r.remoteStore,o)}for(let i of n)r.Da.has(i)&&(yield uc(r.localStore,i,!1).then(()=>{dc(r.remoteStore,i),fc(r,i)}).catch(ds))}})}function sm(t){let e=z(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ik.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Rz.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Dz.bind(null,e),e.Sa.h_=yz.bind(null,e.eventManager),e.Sa.ka=vz.bind(null,e.eventManager),e}function J0(t){let e=z(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bz.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Tz.bind(null,e),e}function Vz(t,e,n){let r=z(t);(function(s,o,a){return x(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(y,E){let D=z(y),S=dt(E.createTime);return D.persistence.runTransaction("hasNewerBundle","readonly",k=>D.$r.getBundleMetadata(k,E.id)).then(k=>!!k&&k.createTime.compareTo(S)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(y){return{taskState:"Success",documentsLoaded:y.totalDocuments,bytesLoaded:y.totalBytes,totalDocuments:y.totalDocuments,totalBytes:y.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(wk(c));let u=new s0(c,s.localStore,o.serializer),d=yield o.qa();for(;d;){let g=yield u._a(d);g&&a._updateProgress(g),d=yield o.qa()}let h=yield u.complete();return yield pi(s,h.ca,void 0),yield function(y,E){let D=z(y);return D.persistence.runTransaction("Save bundle","readwrite",S=>D.$r.saveBundleMetadata(S,E))}(s.localStore,c),a._completeWith(h.progress),Promise.resolve(h.ua)}catch(c){return jn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var nd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){this.serializer=ud(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return ak(this.persistence,new Pg,e.initialUser,this.serializer)}createPersistence(e){return new Mg(Ng.Hr,this.serializer)}createSharedClientState(e){return new Lg}terminate(){return x(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Wg=class t extends nd{constructor(e,n,r){super(),this.Qa=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return x(this,null,function*(){yield Oy(t.prototype,this,"initialize").call(this,e),yield this.Qa.initialize(this,e),yield J0(this.Qa.syncEngine),yield wc(this.Qa.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return ak(this.persistence,new Pg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new TI(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new HE(n,this.persistence);return new qE(e.asyncQueue,r)}createPersistence(e){let n=B0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Vn.withCacheSize(this.cacheSizeBytes):Vn.DEFAULT;return new UI(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,pk(),sg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Lg}},u0=class t extends Wg{constructor(e,n){super(e,n,!1),this.Qa=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return x(this,null,function*(){yield Oy(t.prototype,this,"initialize").call(this,e);let n=this.Qa.syncEngine;this.sharedClientState instanceof Lu&&(this.sharedClientState.syncEngine={Zs:Pz.bind(null,n),Xs:Fz.bind(null,n),eo:Lz.bind(null,n),Bi:Oz.bind(null,n),Ys:Nz.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>x(this,null,function*(){yield kz(this.Qa.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=pk();if(!Lu.D(n))throw new P(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=B0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Lu(n,e.asyncQueue,r,e.clientId,e.initialUser)}},rd=class{initialize(e,n){return x(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>WP(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xz.bind(null,this.syncEngine),yield XI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new n0}()}createDatastore(e){let n=ud(e.databaseInfo.databaseId),r=function(s){return new WI(s)}(e.databaseInfo);return function(s,o,a,c){return new YI(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new JI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>WP(this.syncEngine,n,0),function(){return Vg.D()?new Vg:new GI}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,d){let h=new c0(i,s,o,a,c,u);return d&&(h.La=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return x(this,null,function*(){var e;yield function(r){return x(this,null,function*(){let i=z(r);O("RemoteStore","RemoteStore shutting down."),i.M_.add(5),yield _c(i),i.O_.shutdown(),i.N_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function QP(t,e=10240){let n=0;return{read(){return x(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return x(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var pc=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):lt("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var d0=class{constructor(e,n){this.Ua=e,this.serializer=n,this.metadata=new yt,this.buffer=new Uint8Array,this.Wa=function(){return new TextDecoder("utf-8")}(),this.Ga().then(r=>{r&&r.sa()?this.metadata.resolve(r.ia.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.ia)}`))},r=>this.metadata.reject(r))}close(){return this.Ua.cancel()}getMetadata(){return x(this,null,function*(){return this.metadata.promise})}qa(){return x(this,null,function*(){return yield this.getMetadata(),this.Ga()})}Ga(){return x(this,null,function*(){let e=yield this.za();if(e===null)return null;let n=this.Wa.decode(e),r=Number(n);isNaN(r)&&this.ja(`length string (${n}) is not valid number`);let i=yield this.Ha(r);return new i0(JSON.parse(i),e.length+r)})}Ja(){return this.buffer.findIndex(e=>e===123)}za(){return x(this,null,function*(){for(;this.Ja()<0&&!(yield this.Ya()););if(this.buffer.length===0)return null;let e=this.Ja();e<0&&this.ja("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ha(e){return x(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ya())&&this.ja("Reached the end of bundle when more is expected.");let n=this.Wa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}ja(e){throw this.Ua.cancel(),new Error(`Invalid bundle format: ${e}`)}Ya(){return x(this,null,function*(){let e=yield this.Ua.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var h0=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new P(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return x(this,null,function*(){let o=z(i),a={documents:s.map(h=>Qu(o.serializer,h))},c=yield o.xo("BatchGetDocuments",o.serializer.databaseId,Se.emptyPath(),a,s.length),u=new Map;c.forEach(h=>{let g=q9(o.serializer,h);u.set(g.key.toString(),g)});let d=[];return s.forEach(h=>{let g=u.get(h.toString());X(!!g),d.push(g)}),d})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ls(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return x(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=G.fromPath(r);this.mutations.push(new Hu(i,this.precondition(i)))}),yield function(r,i){return x(this,null,function*(){let s=z(r),o={writes:i.map(a=>Yu(s.serializer,a))};yield s.Co("Commit",s.serializer.databaseId,Se.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw K();n=te.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new P(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(te.min())?rt.exists(!1):rt.updateTime(n):rt.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(te.min()))throw new P(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return rt.updateTime(n)}return rt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var f0=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.Za=r.maxAttempts,this.Yo=new ed(this.asyncQueue,"transaction_retry")}Xa(){this.Za-=1,this.eu()}eu(){this.Yo.$o(()=>x(this,null,function*(){let e=new h0(this.datastore),n=this.tu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.nu(i)}))}).catch(r=>{this.nu(r)})}))}tu(e){try{let n=this.updateFunction(e);return!od(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}nu(e){this.Za>0&&this.ru(e)?(this.Za-=1,this.asyncQueue.enqueueAndForget(()=>(this.eu(),Promise.resolve()))):this.deferred.reject(e)}ru(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!j1(n)}return!1}};var p0=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=mt.UNAUTHENTICATED,this.clientId=cg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>x(this,null,function*(){O("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(O("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new P(N.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new yt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Ic(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function og(t,e){return x(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),O("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>x(this,null,function*(){r.isEqual(i)||(yield ck(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function g0(t,e){return x(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield X0(t);O("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>GP(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>GP(e.remoteStore,i)),t._onlineComponents=e})}function bk(t){return t.name==="FirebaseError"?t.code===N.FAILED_PRECONDITION||t.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function X0(t){return x(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){O("FirestoreClient","Using user provided OfflineComponentProvider");try{yield og(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!bk(n))throw n;jn("Error using user provided cache. Falling back to memory cache: "+n),yield og(t,new nd)}}else O("FirestoreClient","Using default OfflineComponentProvider"),yield og(t,new nd);return t._offlineComponents})}function om(t){return x(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(O("FirestoreClient","Using user provided OnlineComponentProvider"),yield g0(t,t._uninitializedComponentsProvider._online)):(O("FirestoreClient","Using default OnlineComponentProvider"),yield g0(t,new rd))),t._onlineComponents})}function Tk(t){return X0(t).then(e=>e.persistence)}function eC(t){return X0(t).then(e=>e.localStore)}function Sk(t){return om(t).then(e=>e.remoteStore)}function tC(t){return om(t).then(e=>e.syncEngine)}function jz(t){return om(t).then(e=>e.datastore)}function gc(t){return x(this,null,function*(){let e=yield om(t),n=e.eventManager;return n.onListen=_z.bind(null,e.syncEngine),n.onUnlisten=Ez.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=wz.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Iz.bind(null,e.syncEngine),n})}function Uz(t){return t.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield Tk(t),n=yield Sk(t);return e.setNetworkEnabled(!0),function(i){let s=z(i);return s.M_.delete(0),dd(s)}(n)}))}function Bz(t){return t.asyncQueue.enqueue(()=>x(this,null,function*(){let e=yield Tk(t),n=yield Sk(t);return e.setNetworkEnabled(!1),function(i){return x(this,null,function*(){let s=z(i);s.M_.add(0),yield _c(s),s.N_.set("Offline")})}(n)}))}function $z(t,e){let n=new yt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s,o){return x(this,null,function*(){try{let a=yield function(u,d){let h=z(u);return h.persistence.runTransaction("read document","readonly",g=>h.localDocuments.getDocument(g,d))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new P(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Ic(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield eC(t),e,n)})),n.promise}function Ak(t,e,n={}){let r=new yt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(s,o,a,c,u){let d=new pc({next:g=>{o.enqueueAndForget(()=>z0(s,h));let y=g.docs.has(a);!y&&g.fromCache?u.reject(new P(N.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&g.fromCache&&c&&c.source==="server"?u.reject(new P(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new td(vc(a.path),d,{includeMetadataChanges:!0,ra:!0});return G0(s,h)}(yield gc(t),t.asyncQueue,e,n,r)})),r.promise}function qz(t,e){let n=new yt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s,o){return x(this,null,function*(){try{let a=yield kg(i,s,!0),c=new zg(s,a.hs),u=c.da(a.documents),d=c.applyChanges(u,!1);o.resolve(d.snapshot)}catch(a){let c=Ic(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield eC(t),e,n)})),n.promise}function xk(t,e,n={}){let r=new yt;return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(s,o,a,c,u){let d=new pc({next:g=>{o.enqueueAndForget(()=>z0(s,h)),g.fromCache&&c.source==="server"?u.reject(new P(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(g)},error:g=>u.reject(g)}),h=new td(a,d,{includeMetadataChanges:!0,ra:!0});return G0(s,h)}(yield gc(t),t.asyncQueue,e,n,r)})),r.promise}function Hz(t,e){let n=new pc(e);return t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s){z(i).z_.add(s),s.next()}(yield gc(t),n)})),()=>{n.$a(),t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return function(i,s){z(i).z_.delete(s)}(yield gc(t),n)}))}}function Gz(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?B1().encode(o):o,function(d,h){return new d0(d,h)}(function(d,h){if(d instanceof Uint8Array)return QP(d,h);if(d instanceof ArrayBuffer)return QP(new Uint8Array(d),h);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,ud(e));t.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){Vz(yield tC(t),i,r)}))}function zz(t,e){return t.asyncQueue.enqueue(()=>x(this,null,function*(){return function(r,i){let s=z(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield eC(t),e)}))}function Rk(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var YP=new Map;function nC(t,e,n){if(!n)throw new P(N.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function rC(t,e,n,r){if(e===!0&&r===!0)throw new P(N.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ZP(t){if(!G.isDocumentKey(t))throw new P(N.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function JP(t){if(G.isDocumentKey(t))throw new P(N.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function am(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":K()}function Ae(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=am(t);throw new P(N.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function Mk(t,e){if(e<=0)throw new P(N.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var Kg=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new P(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}rC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new P(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new P(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new P(N.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},fo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Kg({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new P(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new P(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Kg(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new PE;switch(r.type){case"firstParty":return new LE(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new P(N.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=YP.get(n);r&&(O("ComponentProvider","Removing Datastore"),YP.delete(n),r.terminate())}(this),Promise.resolve()}};function Nk(t,e,n,r={}){var i;let s=(t=Ae(t,fo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&jn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=mt.MOCK_USER;else{a=fh(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new P(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new mt(u)}t._authCredentials=new kE(new ag(a,c))}}var Lt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},qe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Nr=class t extends Lt{constructor(e,n,r){super(e,n,vc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new qe(this.firestore,null,new G(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function iC(t,e,...n){if(t=Ee(t),nC("collection","path",e),t instanceof fo){let r=Se.fromString(e,...n);return JP(r),new Nr(t,null,r)}{if(!(t instanceof qe||t instanceof Nr))throw new P(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Se.fromString(e,...n));return JP(r),new Nr(t.firestore,null,r)}}function Pk(t,e){if(t=Ae(t,fo),nC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new P(N.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Lt(t,null,function(r){return new ir(Se.emptyPath(),r)}(e))}function hd(t,e,...n){if(t=Ee(t),arguments.length===1&&(e=cg.newId()),nC("doc","path",e),t instanceof fo){let r=Se.fromString(e,...n);return ZP(r),new qe(t,null,new G(r))}{if(!(t instanceof qe||t instanceof Nr))throw new P(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(Se.fromString(e,...n));return ZP(r),new qe(t.firestore,t instanceof Nr?t.converter:null,new G(r))}}function sC(t,e){return t=Ee(t),e=Ee(e),(t instanceof qe||t instanceof Nr)&&(e instanceof qe||e instanceof Nr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function oC(t,e){return t=Ee(t),e=Ee(e),t instanceof Lt&&e instanceof Lt&&t.firestore===e.firestore&&cd(t._query,e._query)&&t.converter===e.converter}var m0=class{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new ed(this,"async_queue_retry"),this.hu=()=>{let n=sg();n&&O("AsyncQueue","Visibility state changed to "+n.visibilityState),this.Yo.Wo()};let e=sg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;let n=sg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});let n=new yt;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}Tu(){return x(this,null,function*(){if(this.su.length!==0){try{yield this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!hs(e))throw e;O("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}})}Iu(e){let n=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw lt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.uu=!1,r))));return this.iu=n,n}enqueueAfterDelay(e,n,r){this.Pu(),this.lu.indexOf(e)>-1&&(n=0);let i=e0.createAndSchedule(this,e,n,r,s=>this.Eu(s));return this._u.push(i),i}Pu(){this.au&&K()}verifyOperationInProgress(){}du(){return x(this,null,function*(){let e;do e=this.iu,yield e;while(e!==this.iu)})}Au(e){for(let n of this._u)if(n.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this._u)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){let n=this._u.indexOf(e);this._u.splice(n,1)}};function y0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var v0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new yt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var kk=-1,Ye=class extends fo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new m0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Ok(this),this._firestoreClient.terminate()}};function Et(t){return t._firestoreClient||Ok(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Ok(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,d){return new GE(a,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,Rk(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new p0(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function Fk(t,e){Gk(t=Ae(t,Ye));let n=Et(t);if(n._uninitializedComponentsProvider)throw new P(N.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new rd;return Vk(n,i,new Wg(i,r.cacheSizeBytes,e?.forceOwnership))}function Lk(t){Gk(t=Ae(t,Ye));let e=Et(t);if(e._uninitializedComponentsProvider)throw new P(N.FAILED_PRECONDITION,"SDK cache is already specified.");jn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new rd;return Vk(e,r,new u0(r,n.cacheSizeBytes))}function Vk(t,e,n){let r=new yt;return t.asyncQueue.enqueue(()=>x(this,null,function*(){try{yield og(t,n),yield g0(t,e),r.resolve()}catch(i){let s=i;if(!bk(s))throw s;jn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function jk(t){if(t._initialized&&!t._terminated)throw new P(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new yt;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>x(this,null,function*(){try{yield function(r){return x(this,null,function*(){if(!ns.D())return Promise.resolve();let i=r+"main";yield ns.delete(i)})}(B0(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function Uk(t){return function(n){let r=new yt;return n.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return Sz(yield tC(n),r)})),r.promise}(Et(t=Ae(t,Ye)))}function Bk(t){return Uz(Et(t=Ae(t,Ye)))}function $k(t){return Bz(Et(t=Ae(t,Ye)))}function qk(t,e){let n=Et(t=Ae(t,Ye)),r=new v0;return Gz(n,t._databaseId,e,r),r}function Hk(t,e){return zz(Et(t=Ae(t,Ye)),e).then(n=>n?new Lt(t,null,n.query):null)}function Gk(t){if(t._initialized||t._terminated)throw new P(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Fr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(St.fromBase64String(e))}catch(n){throw new P(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(St.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var or=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new P(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ut(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var hi=class{constructor(e){this._methodName=e}};var po=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new P(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new P(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}};var Wz=/^__.*__$/,_0=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new sr(e,this.data,this.fieldMask,n,this.fieldTransforms):new cs(e,this.data,n,this.fieldTransforms)}},Qg=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new sr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function zk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K()}}var Yg=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.mu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.wu(e),i}Su(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.gu({path:r,yu:!1});return i.mu(),i}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Zg(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(zk(this.fu)&&Wz.test(e))throw this.Du('Document fields cannot begin and end with "__"')}},w0=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||ud(e)}Fu(e,n,r,i=!1){return new Yg({fu:e,methodName:n,vu:r,path:ut.emptyPath(),yu:!1,Cu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function vo(t){let e=t._freezeSettings(),n=ud(t._databaseId);return new w0(t._databaseId,!!e.ignoreUndefinedProperties,n)}function cm(t,e,n,r,i,s={}){let o=t.Fu(s.merge||s.mergeFields?2:0,e,n,i);lC("Data must be an object, but it was:",o,r);let a=Qk(r,o),c,u;if(s.merge)c=new Tn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let d=[];for(let h of s.mergeFields){let g=b0(e,h,n);if(!o.contains(g))throw new P(N.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Zk(d,g)||d.push(g)}c=new Tn(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new _0(new zt(a),c,u)}var id=class t extends hi{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function Wk(t,e,n){return new Yg({fu:3,vu:e.settings.vu,methodName:t._methodName,yu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var E0=class t extends hi{_toFieldTransform(e){return new lo(e.path,new os)}isEqual(e){return e instanceof t}},I0=class t extends hi{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=Wk(this,e,!0),r=this.Mu.map(s=>_o(s,n)),i=new ui(r);return new lo(e.path,i)}isEqual(e){return e instanceof t&&Vy(this.Mu,e.Mu)}},C0=class t extends hi{constructor(e,n){super(e),this.Mu=n}_toFieldTransform(e){let n=Wk(this,e,!0),r=this.Mu.map(s=>_o(s,n)),i=new di(r);return new lo(e.path,i)}isEqual(e){return e instanceof t&&Vy(this.Mu,e.Mu)}},D0=class t extends hi{constructor(e,n){super(e),this.xu=n}_toFieldTransform(e){let n=new as(e.serializer,N1(e.serializer,this.xu));return new lo(e.path,n)}isEqual(e){return e instanceof t&&this.xu===e.xu}};function aC(t,e,n,r){let i=t.Fu(1,e,n);lC("Data must be an object, but it was:",i,r);let s=[],o=zt.empty();yo(r,(c,u)=>{let d=uC(e,c,n);u=Ee(u);let h=i.Su(d);if(u instanceof id)s.push(d);else{let g=_o(u,h);g!=null&&(s.push(d),o.set(d,g))}});let a=new Tn(s);return new Qg(o,a,i.fieldTransforms)}function cC(t,e,n,r,i,s){let o=t.Fu(1,e,n),a=[b0(e,r,n)],c=[i];if(s.length%2!=0)throw new P(N.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)a.push(b0(e,s[g])),c.push(s[g+1]);let u=[],d=zt.empty();for(let g=a.length-1;g>=0;--g)if(!Zk(u,a[g])){let y=a[g],E=c[g];E=Ee(E);let D=o.Su(y);if(E instanceof id)u.push(y);else{let S=_o(E,D);S!=null&&(u.push(y),d.set(y,S))}}let h=new Tn(u);return new Qg(d,h,o.fieldTransforms)}function Kk(t,e,n,r=!1){return _o(n,t.Fu(r?4:3,e))}function _o(t,e){if(Yk(t=Ee(t)))return lC("Unsupported field value:",e,t),Qk(t,e);if(t instanceof hi)return function(r,i){if(!zk(i.fu))throw i.Du(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Du(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=_o(a,i.bu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ee(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return N1(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Je.fromDate(r);return{timestampValue:oc(i.serializer,s)}}if(r instanceof Je){let s=new Je(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oc(i.serializer,s)}}if(r instanceof po)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Fr)return{bytesValue:$1(i.serializer,r._byteString)};if(r instanceof qe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:V0(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.Du(`Unsupported field value: ${am(r)}`)}(t,e)}function Qk(t,e){let n={};return p1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):yo(t,(r,i)=>{let s=_o(i,e.pu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function Yk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Je||t instanceof po||t instanceof Fr||t instanceof qe||t instanceof hi)}function lC(t,e,n){if(!Yk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=am(n);throw r==="an object"?e.Du(t+" a custom object"):e.Du(t+" "+r)}}function b0(t,e,n){if((e=Ee(e))instanceof or)return e._internalPath;if(typeof e=="string")return uC(t,e);throw Zg("Field path arguments must be of type string or ",t,!1,void 0,n)}var Kz=new RegExp("[~\\*/\\[\\]]");function uC(t,e,n){if(e.search(Kz)>=0)throw Zg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new or(...e.split("."))._internalPath}catch{throw Zg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zg(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new P(N.INVALID_ARGUMENT,a+t+c)}function Zk(t,e){return t.some(n=>n.isEqual(e))}var go=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new qe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new T0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(lm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},T0=class extends go{data(){return super.data()}};function lm(t,e){return typeof e=="string"?uC(t,e):e instanceof or?e._internalPath:e._delegate._internalPath}function Jk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new P(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var sd=class{},mo=class extends sd{};function gi(t,e,...n){let r=[];e instanceof sd&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof S0).length,a=s.filter(c=>c instanceof Jg).length;if(o>1||o>0&&a>0)throw new P(N.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Jg=class t extends mo{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return cO(e._query,n),new Lt(e.firestore,e.converter,iI(e._query,n))}_parse(e){let n=vo(e.firestore);return function(s,o,a,c,u,d,h){let g;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new P(N.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){e1(h,d);let y=[];for(let E of h)y.push(XP(c,s,E));g={arrayValue:{values:y}}}else g=XP(c,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||e1(h,d),g=Kk(a,o,h,d==="in"||d==="not-in");return Ce.create(u,d,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function Xk(t,e,n){let r=e,i=lm("where",t);return Jg._create(i,r,n)}var S0=class t extends sd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fe.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)cO(o,c),o=iI(o,c)}(e._query,n),new Lt(e.firestore,e.converter,iI(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var A0=class t extends mo{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new P(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new P(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ao(s,o)}(e._query,this._field,this._direction);return new Lt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new ir(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function eO(t,e="asc"){let n=e,r=lm("orderBy",t);return A0._create(r,n)}var Xg=class t extends mo{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Lt(e.firestore,e.converter,vg(e._query,this._limit,this._limitType))}};function tO(t){return Mk("limit",t),Xg._create("limit",t,"F")}function nO(t){return Mk("limitToLast",t),Xg._create("limitToLast",t,"L")}var em=class t extends mo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=aO(e,this.type,this._docOrFields,this._inclusive);return new Lt(e.firestore,e.converter,function(i,s){return new ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function rO(...t){return em._create("startAt",t,!0)}function iO(...t){return em._create("startAfter",t,!1)}var tm=class t extends mo{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=aO(e,this.type,this._docOrFields,this._inclusive);return new Lt(e.firestore,e.converter,function(i,s){return new ir(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function sO(...t){return tm._create("endBefore",t,!1)}function oO(...t){return tm._create("endAt",t,!0)}function aO(t,e,n,r){if(n[0]=Ee(n[0]),n[0]instanceof go)return function(s,o,a,c,u){if(!c)throw new P(N.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let d=[];for(let h of Ja(s))if(h.field.isKeyField())d.push(oo(o,c.key));else{let g=c.data.field(h.field);if(rm(g))throw new P(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+h.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){let y=h.field.canonicalString();throw new P(N.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${y}' (used as the orderBy) does not exist.`)}d.push(g)}return new kr(d,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=vo(t.firestore);return function(o,a,c,u,d,h){let g=o.explicitOrderBy;if(d.length>g.length)throw new P(N.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let y=[];for(let E=0;E<d.length;E++){let D=d[E];if(g[E].field.isKeyField()){if(typeof D!="string")throw new P(N.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof D}`);if(!F0(o)&&D.indexOf("/")!==-1)throw new P(N.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${D}' contains a slash.`);let S=o.path.child(Se.fromString(D));if(!G.isDocumentKey(S))throw new P(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${S}' is not because it contains an odd number of segments.`);let k=new G(S);y.push(oo(a,k))}else{let S=Kk(c,u,D);y.push(S)}}return new kr(y,h)}(t._query,t.firestore._databaseId,i,e,n,r)}}function XP(t,e,n){if(typeof(n=Ee(n))=="string"){if(n==="")throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!F0(e)&&n.indexOf("/")!==-1)throw new P(N.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(Se.fromString(n));if(!G.isDocumentKey(r))throw new P(N.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return oo(t,new G(r))}if(n instanceof qe)return oo(t,n._key);throw new P(N.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${am(n)}.`)}function e1(t,e){if(!Array.isArray(t)||t.length===0)throw new P(N.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cO(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new P(N.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new P(N.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var mc=class{convertValue(e,n="none"){switch(so(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(rs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw K()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return yo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new po(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=k0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Bu(e));default:return null}}convertTimestamp(e){let n=li(e);return new Je(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=Se.fromString(e);X(X1(r));let i=new is(r.get(1),r.get(3)),s=new G(r.popFirst(5));return i.isEqual(n)||lt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function um(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var x0=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,n)}};var ci=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Bn=class extends go{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new es(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(lm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},es=class extends Bn{data(e={}){return super.data(e)}},ar=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ci(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new es(this._firestore,this._userDataWriter,r.key,r,new ci(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new P(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new es(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ci(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Qz(a.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function Qz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K()}}function dC(t,e){return t instanceof Bn&&e instanceof Bn?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ar&&e instanceof ar&&t._firestore===e._firestore&&oC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function lO(t){t=Ae(t,qe);let e=Ae(t.firestore,Ye);return Ak(Et(e),t._key).then(n=>gC(e,t,n))}var fi=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new qe(this.firestore,null,n)}};function uO(t){t=Ae(t,qe);let e=Ae(t.firestore,Ye),n=Et(e),r=new fi(e);return $z(n,t._key).then(i=>new Bn(e,r,t._key,i,new ci(i!==null&&i.hasLocalMutations,!0),t.converter))}function dO(t){t=Ae(t,qe);let e=Ae(t.firestore,Ye);return Ak(Et(e),t._key,{source:"server"}).then(n=>gC(e,t,n))}function hO(t){t=Ae(t,Lt);let e=Ae(t.firestore,Ye),n=Et(e),r=new fi(e);return Jk(t._query),xk(n,t._query).then(i=>new ar(e,r,t,i))}function fO(t){t=Ae(t,Lt);let e=Ae(t.firestore,Ye),n=Et(e),r=new fi(e);return qz(n,t._query).then(i=>new ar(e,r,t,i))}function pO(t){t=Ae(t,Lt);let e=Ae(t.firestore,Ye),n=Et(e),r=new fi(e);return xk(n,t._query,{source:"server"}).then(i=>new ar(e,r,t,i))}function hC(t,e,n){t=Ae(t,qe);let r=Ae(t.firestore,Ye),i=um(t.converter,e,n);return Cc(r,[cm(vo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,rt.none())])}function fC(t,e,n,...r){t=Ae(t,qe);let i=Ae(t.firestore,Ye),s=vo(i),o;return o=typeof(e=Ee(e))=="string"||e instanceof or?cC(s,"updateDoc",t._key,e,n,r):aC(s,"updateDoc",t._key,e),Cc(i,[o.toMutation(t._key,rt.exists(!0))])}function gO(t){return Cc(Ae(t.firestore,Ye),[new ls(t._key,rt.none())])}function mO(t,e){let n=Ae(t.firestore,Ye),r=hd(t),i=um(t.converter,e);return Cc(n,[cm(vo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,rt.exists(!1))]).then(()=>r)}function pC(t,...e){var n,r,i;t=Ee(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||y0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(y0(e[o])){let h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,d;if(t instanceof qe)u=Ae(t.firestore,Ye),d=vc(t._key.path),c={next:h=>{e[o]&&e[o](gC(u,t,h))},error:e[o+1],complete:e[o+2]};else{let h=Ae(t,Lt);u=Ae(h.firestore,Ye),d=h._query;let g=new fi(u);c={next:y=>{e[o]&&e[o](new ar(u,g,h,y))},error:e[o+1],complete:e[o+2]},Jk(t._query)}return function(g,y,E,D){let S=new pc(D),k=new td(y,S,E);return g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return G0(yield gc(g),k)})),()=>{S.$a(),g.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return z0(yield gc(g),k)}))}}(Et(u),d,a,c)}function yO(t,e){return Hz(Et(t=Ae(t,Ye)),y0(e)?e:{next:e})}function Cc(t,e){return function(r,i){let s=new yt;return r.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){return Cz(yield tC(r),i,s)})),s.promise}(Et(t),e)}function gC(t,e,n){let r=n.docs.get(e._key),i=new fi(t);return new Bn(t,i,e._key,r,new ci(n.hasPendingWrites,n.fromCache),e.converter)}var Yz={maxAttempts:5};var nm=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=vo(e)}set(e,n,r){this._verifyNotCommitted();let i=Ji(e,this._firestore),s=um(i.converter,n,r),o=cm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,rt.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Ji(e,this._firestore),o;return o=typeof(n=Ee(n))=="string"||n instanceof or?cC(this._dataReader,"WriteBatch.update",s._key,n,r,i):aC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,rt.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Ji(e,this._firestore);return this._mutations=this._mutations.concat(new ls(n._key,rt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new P(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Ji(t,e){if((t=Ee(t)).firestore!==e)throw new P(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var R0=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=vo(n)}get(n){let r=Ji(n,this._firestore),i=new x0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return K();let o=s[0];if(o.isFoundDocument())return new go(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new go(this._firestore,i,r._key,null,r.converter);throw K()})}set(n,r,i){let s=Ji(n,this._firestore),o=um(s.converter,r,i),a=cm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Ji(n,this._firestore),a;return a=typeof(r=Ee(r))=="string"||r instanceof or?cC(this._dataReader,"Transaction.update",o._key,r,i,s):aC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Ji(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Ji(e,this._firestore),r=new fi(this._firestore);return super.get(e).then(i=>new Bn(this._firestore,r,n._key,i._document,new ci(!1,!1),n.converter))}};function vO(t,e,n){t=Ae(t,Ye);let r=Object.assign(Object.assign({},Yz),n);return function(s){if(s.maxAttempts<1)throw new P(N.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new yt;return s.asyncQueue.enqueueAndForget(()=>x(this,null,function*(){let u=yield jz(s);new f0(s.asyncQueue,u,a,o,c).Xa()})),c.promise}(Et(t),i=>e(new R0(t,i)),r)}function _O(){return new id("deleteField")}function wO(){return new E0("serverTimestamp")}function EO(...t){return new I0("arrayUnion",t)}function IO(...t){return new C0("arrayRemove",t)}function CO(t){return new D0("increment",t)}(function(e,n=!0){(function(i){yc=i})(vh),Ss(new pn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ye(new OE(r.getProvider("auth-internal")),new jE(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new P(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new is(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),zn(tP,"4.6.3",e),zn(tP,"4.6.3","esm2017")})();var Zz="@firebase/firestore-compat",Jz="0.3.32";function EC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function DO(){if(typeof Uint8Array>"u")throw new P("unimplemented","Uint8Arrays are not available in this environment.")}function bO(){if(!g1())throw new P("unimplemented","Blobs are unavailable in Firestore in this environment.")}var dm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return bO(),new t(Fr.fromBase64String(e))}static fromUint8Array(e){return DO(),new t(Fr.fromUint8Array(e))}toBase64(){return bO(),this._delegate.toBase64()}toUint8Array(){return DO(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function mC(t){return Xz(t,["next","error","complete"])}function Xz(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var yC=class{enableIndexedDbPersistence(e,n){return Fk(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return Lk(e._delegate)}clearIndexedDbPersistence(e){return jk(e._delegate)}},hm=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof is||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&jn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){Nk(this._delegate,e,n,r)}enableNetwork(){return Bk(this._delegate)}disableNetwork(){return $k(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,rC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Uk(this._delegate)}onSnapshotsInSync(e){return yO(this._delegate,e)}get app(){if(!this._appCompat)throw new P("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Tc(this,iC(this._delegate,e))}catch(n){throw sn(n,"collection()","Firestore.collection()")}}doc(e){try{return new Lr(this,hd(this._delegate,e))}catch(n){throw sn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Co(this,Pk(this._delegate,e))}catch(n){throw sn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return vO(this._delegate,n=>e(new fm(this,n)))}batch(){return Et(this._delegate),new pm(new nm(this._delegate,e=>Cc(this._delegate,e)))}loadBundle(e){return qk(this._delegate,e)}namedQuery(e){return Hk(this._delegate,e).then(n=>n?new Co(this,n):null)}},Dc=class extends mc{constructor(e){super(),this.firestore=e}convertBytes(e){return new dm(new Fr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return Lr.forKey(n,this.firestore,null)}};function e5(t){t1(t)}var fm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Dc(e)}get(e){let n=wo(e);return this._delegate.get(n).then(r=>new Eo(this._firestore,new Bn(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=wo(e);return r?(EC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=wo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=wo(e);return this._delegate.delete(n),this}},pm=class{constructor(e){this._delegate=e}set(e,n,r){let i=wo(e);return r?(EC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=wo(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=wo(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},bc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new es(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Io(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new Dc(e),n),i.set(n,s)),s}};bc.INSTANCES=new WeakMap;var Lr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Dc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new P("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new qe(n._delegate,r,new G(e)))}static forKey(e,n,r){return new t(n,new qe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Tc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Tc(this.firestore,iC(this._delegate,e))}catch(n){throw sn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Ee(e),e instanceof qe?sC(this._delegate,e):!1}set(e,n){n=EC("DocumentReference.set",n);try{return n?hC(this._delegate,e,n):hC(this._delegate,e)}catch(r){throw sn(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?fC(this._delegate,e):fC(this._delegate,e,n,...r)}catch(i){throw sn(i,"updateDoc()","DocumentReference.update()")}}delete(){return gO(this._delegate)}onSnapshot(...e){let n=TO(e),r=SO(e,i=>new Eo(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return pC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=uO(this._delegate):e?.source==="server"?n=dO(this._delegate):n=lO(this._delegate),n.then(r=>new Eo(this.firestore,new Bn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(bc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function sn(t,e,n){return t.message=t.message.replace(e,n),t}function TO(t){for(let e of t)if(typeof e=="object"&&!mC(e))return e;return{}}function SO(t,e){var n,r;let i;return mC(t[0])?i=t[0]:mC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Eo=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new Lr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return dC(this._delegate,e._delegate)}},Io=class extends Eo{data(e){let n=this._delegate.data(e);return this._delegate._converter||n1(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},Co=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Dc(e)}where(e,n,r){try{return new t(this.firestore,gi(this._delegate,Xk(e,n,r)))}catch(i){throw sn(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,gi(this._delegate,eO(e,n)))}catch(r){throw sn(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,gi(this._delegate,tO(e)))}catch(n){throw sn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,gi(this._delegate,nO(e)))}catch(n){throw sn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,gi(this._delegate,rO(...e)))}catch(n){throw sn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,gi(this._delegate,iO(...e)))}catch(n){throw sn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,gi(this._delegate,sO(...e)))}catch(n){throw sn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,gi(this._delegate,oO(...e)))}catch(n){throw sn(n,"endAt()","Query.endAt()")}}isEqual(e){return oC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=fO(this._delegate):e?.source==="server"?n=pO(this._delegate):n=hO(this._delegate),n.then(r=>new fd(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=TO(e),r=SO(e,i=>new fd(this.firestore,new ar(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return pC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(bc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},vC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Io(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},fd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Co(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Io(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new vC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Io(this._firestore,r))})}isEqual(e){return dC(this._delegate,e._delegate)}},Tc=class t extends Co{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new Lr(this.firestore,e):null}doc(e){try{return e===void 0?new Lr(this.firestore,hd(this._delegate)):new Lr(this.firestore,hd(this._delegate,e))}catch(n){throw sn(n,"doc()","CollectionReference.doc()")}}add(e){return mO(this._delegate,e).then(n=>new Lr(this.firestore,n))}isEqual(e){return sC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(bc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function wo(t){return Ae(t,qe)}var _C=class t{constructor(...e){this._delegate=new or(...e)}static documentId(){return new t(ut.keyField().canonicalString())}isEqual(e){return e=Ee(e),e instanceof or?this._delegate._internalPath.isEqual(e._internalPath):!1}};var wC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=wO();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=_O();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=EO(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=IO(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=CO(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var t5={Firestore:hm,GeoPoint:po,Timestamp:Je,Blob:dm,Transaction:fm,WriteBatch:pm,DocumentReference:Lr,DocumentSnapshot:Eo,Query:Co,QueryDocumentSnapshot:Io,QuerySnapshot:fd,CollectionReference:Tc,FieldPath:_C,FieldValue:wC,setLogLevel:e5,CACHE_SIZE_UNLIMITED:kk};function n5(t,e){t.INTERNAL.registerComponent(new pn("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},t5)))}function r5(t){n5(t,(e,n)=>new hm(e,n,new yC)),t.registerVersion(Zz,Jz)}r5(Ct);function i5(t,e=Ns){return new pe(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function AO(t,e){return i5(t,e)}function s5(t,e){return AO(t,e).pipe(Ps(void 0),ml(),J(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function DC(t,e){return AO(t,e).pipe(J(n=>({payload:n,type:"query"})))}var gm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=PO(r,n);return new ym(i,s,this.afs)}snapshotChanges(){return s5(this.ref,this.afs.schedulers.outsideAngular).pipe(ct)}valueChanges(e={}){return this.snapshotChanges().pipe(J(({payload:n})=>e.idField?xe(B({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return De(this.ref.get(e)).pipe(ct)}};function mm(t,e){return DC(t,e).pipe(Ps(void 0),ml(),J(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(h=>h.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(h=>h.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function xO(t,e,n){return mm(t,n).pipe(hr((r,i)=>o5(r,i.map(s=>s.payload),e),[]),gl(),J(r=>r.map(i=>({type:i.type,payload:i}))))}function o5(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=a5(t,r))}),t}function IC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function a5(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return IC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return IC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return IC(t,e.oldIndex,1);break}return t}function RO(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var ym=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=mm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(J(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Ps(void 0),ml(),Dt(([r,i])=>i.length>0||!r),J(([,r])=>r),ct)}auditTrail(e){return this.stateChanges(e).pipe(hr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=RO(e);return xO(this.query,n,this.afs.schedulers.outsideAngular).pipe(ct)}valueChanges(e={}){return DC(this.query,this.afs.schedulers.outsideAngular).pipe(J(n=>n.payload.docs.map(r=>e.idField?xe(B({},r.data()),{[e.idField]:r.id}):r.data())),ct)}get(e){return De(this.query.get(e)).pipe(ct)}add(e){return this.ref.add(e)}doc(e){return new gm(this.ref.doc(e),this.afs)}},CC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?mm(this.query,this.afs.schedulers.outsideAngular).pipe(ct):mm(this.query,this.afs.schedulers.outsideAngular).pipe(J(n=>n.filter(r=>e.indexOf(r.type)>-1)),Dt(n=>n.length>0),ct)}auditTrail(e){return this.stateChanges(e).pipe(hr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=RO(e);return xO(this.query,n,this.afs.schedulers.outsideAngular).pipe(ct)}valueChanges(e={}){return DC(this.query,this.afs.schedulers.outsideAngular).pipe(J(r=>r.payload.docs.map(i=>e.idField?B({[e.idField]:i.id},i.data()):i.data())),ct)}get(e){return De(this.query.get(e)).pipe(ct)}},MO=new W("angularfire2.enableFirestorePersistence"),NO=new W("angularfire2.firestore.persistenceSettings"),c5=new W("angularfire2.firestore.settings"),l5=new W("angularfire2.firestore.use-emulator");function PO(t,e=n=>n){return{query:e(t),ref:t}}var bC=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,d,h,g,y,E,D,S,k,q){this.schedulers=c;let F=Ys(n,a,r),Y=d;h&&bu(F,a,g,E,D,S,y,k),[this.firestore,this.persistenceEnabled$]=ja(`${F.name}.firestore`,"AngularFirestore",F.name,()=>{let ie=a.runOutsideAngular(()=>F.firestore());if(s&&ie.settings(s),Y&&ie.useEmulator(...Y),i&&!ii(o)){let ne=()=>{try{return De(ie.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),ee(!1)}};return[ie,a.runOutsideAngular(ne)]}else return[ie,ee(!1)]},[s,Y,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=PO(i,r),a=this.schedulers.ngZone.run(()=>s);return new ym(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new CC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new gm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(L(zi),L(Wi,8),L(MO,8),L(c5,8),L(st),L(be),L(Va),L(NO,8),L(l5,8),L(Kp,8),L(_u,8),L(wu,8),L(Eu,8),L(Iu,8),L(Cu,8),L(Du,8),L(si,8))};static \u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),kO=(()=>{class t{constructor(){Ct.registerVersion("angularfire",Hi.full,"fst-compat")}static enablePersistence(n){return{ngModule:t,providers:[{provide:MO,useValue:!0},{provide:NO,useValue:n}]}}static \u0275fac=function(r){return new(r||t)};static \u0275mod=en({type:t});static \u0275inj=Xt({providers:[bC]})}return t})();var OO=(()=>{let e=class e{constructor(r){this.db=r}insertData(r){try{return this.db.collection("emailData").add(xe(B({},r),{createdDate:new Date().toISOString()}))}catch{return Promise.reject({error:"An error occurred while trying to insert data"})}}};e.\u0275fac=function(i){return new(i||e)(L(bC))},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var FO=(()=>{let e=class e{constructor(){}sendEmail(r,i){console.log(r,i)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function f5(t,e){t&1&&(V(0,"div",32)(1,"small",33),Q(2," Please fill in the form below and I will get back to you as soon as possible. "),$()())}function p5(t,e){t&1&&(V(0,"div",34)(1,"small",35),Q(2," Valid email address is required. "),$()())}function g5(t,e){t&1&&(V(0,"span"),Q(1,"Send"),$())}function m5(t,e){t&1&&(V(0,"span",36)(1,"div"),_r(),V(2,"svg",37),ke(3,"path",38)(4,"path",39),$(),wr(),V(5,"span",40),Q(6,"Loading..."),$()(),V(7,"span"),Q(8,"Sending email..."),$()())}function y5(t,e){if(t&1){let n=dR();V(0,"div",2)(1,"div",3),ke(2,"div",4)(3,"div",5)(4,"div",6)(5,"div",7)(6,"div",8)(7,"div",9),$(),V(8,"div",10)(9,"h1",11),Q(10,"Let's chat"),$(),V(11,"div",12),va(12,f5,3,0,"div",13),V(13,"form",14),Cr("ngSubmit",function(){PA(n);let i=Z_();return kA(i.onSubmit())}),V(14,"div",15)(15,"label",16),Q(16,"Name"),$(),V(17,"div",17),ke(18,"img",18),$(),ke(19,"input",19),$(),V(20,"div",15)(21,"label",20),Q(22,"Email"),$(),V(23,"div",17),_r(),V(24,"svg",21),ke(25,"path",22)(26,"path",23),$()(),wr(),ke(27,"input",24),va(28,p5,3,0,"div",25),$(),V(29,"div",26)(30,"label",27),Q(31,"Message"),$(),ke(32,"textarea",28),$(),V(33,"div",29)(34,"button",30),va(35,g5,2,0,"span",1)(36,m5,9,0,"span",31),$()()()()()()}if(t&2){let n=Z_();wt(12),ot("ngIf",!n.emailDataForm.valid&&n.submitted),wt(),ot("formGroup",n.emailDataForm),wt(15),ot("ngIf",(n.form==null||n.form.email==null?null:n.form.email.errors)&&n.submitted),wt(6),ot("disabled",n.loading),wt(),ot("ngIf",!n.loading),wt(),ot("ngIf",n.loading&&n.emailDataForm.valid)}}function v5(t,e){t&1&&(V(0,"div"),ke(1,"app-success"),$())}var LO=(()=>{let e=class e{constructor(r,i){this.db=r,this.emailService=i,this.submitted=!1,this.showSuccess=!1,this.loading=!1,dE.init(La.emailjs.publicKey)}ngOnInit(){this.initForm()}initForm(){this.emailDataForm=new Np({name:new yu("",[Qs.required]),email:new yu("",[Qs.required,Qs.email]),message:new yu("",[Qs.required])})}onSubmit(){return x(this,null,function*(){if(this.submitted=!0,this.loading=!0,this.emailDataForm.invalid){this.loading=!1;return}try{let r=this.emailDataForm.value.email,i=this.emailDataForm.value.name,s=this.emailDataForm.value.message,o=`Name: ${i}
Email: ${r}

Message: ${s}`,c={name:i,email_from:"strangermushwana@gmail.com",message:o,subject:"Portfolio Contact Form Submission",to_email:"strangermushwana@gmail.com"};yield dE.send(La.emailjs.serviceId,La.emailjs.templateId,c),this.db.insertData(this.emailDataForm.value).then(u=>{this.showSuccess=!0,this.emailDataForm.reset()})}catch(r){console.log(r),this.loading=!1,this.submitted=!1,this.db.insertData(this.emailDataForm.value).then(i=>{this.showSuccess=!0,this.emailDataForm.reset()})}})}get form(){return this.emailDataForm.controls}};e.\u0275fac=function(i){return new(i||e)(me(OO),me(FO))},e.\u0275cmp=qt({type:e,selectors:[["app-contact"]],standalone:!0,features:[Ht],decls:2,vars:2,consts:[["class","flex flex-col md:flex-row justify-center items-center max-w-6xl mt-10 p-4 mx-auto",4,"ngIf"],[4,"ngIf"],[1,"flex","flex-col","md:flex-row","justify-center","items-center","max-w-6xl","mt-10","p-4","mx-auto"],[1,"hidden","md:w-1/2","mb-8","md:mb-0","md:flex","justify-center","relative","items-center"],[1,"envelope","w-[16rem]","h-[10rem]","rounded-lg","overflow-hidden"],[1,"invisible","md:visible","bg-gray-200","px-10","py-5","rounded-full","absolute","top-[25rem]","z-10"],[1,"invisible","md:visible","bg-gray-200","px-10","py-2","rounded-full","absolute","top-[15rem]","left-[3rem]","z-10"],[1,"invisible","lg:visible","bg-green-200","px-2","py-2","absolute","top-[10rem]","left-[3rem]","z-10"],[1,"invisible","md:visible","bg-gray-200","px-[5rem]","py-5","rounded-full","absolute","top-[-10rem]","z-10"],[1,"invisible","md:visible","bg-red-200","px-2","py-2","rounded-full","absolute","right-[10rem]","top-[-5rem]","z-10"],[1,"md:w-1/2","p-6","md:p-0","w-full"],[1,"text-4xl","font-bold","text-center"],[1,"mt-10"],["class","py-3",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"mb-6","relative"],["for","name",1,"block","mb-2","text-sm","font-medium","text-gray-700"],[1,"absolute","inset-y-[3.25rem]","start-0","flex","justify-center","items-center","ps-3.5","pointer-events-none"],["src","../../assets/pers.png","alt","",1,"w-5","h-5"],["type","text","id","name","formControlName","name","placeholder","Homer Simpson",1,"bg-gray-50","border","text-sm","outline-none","rounded-lg","w-full","ps-10","p-4"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-700"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 16",1,"w-4","h-4","text-gray-500","dark:text-gray-400"],["d","m10.036 8.278 9.258-7.79A1.979 1.979 0 0 0 18 0H2A1.987 1.987 0 0 0 .641.541l9.395 7.737Z"],["d","M11.241 9.817c-.36.275-.801.425-1.255.427-.428 0-.845-.138-1.187-.395L0 2.6V14a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V2.5l-8.759 7.317Z"],["type","email","id","email","formControlName","email","placeholder","name@example.com",1,"bg-gray-50","border","text-sm","outline-none","rounded-lg","w-full","ps-10","p-4"],["class","my-2",4,"ngIf"],[1,"mb-4"],["for","message",1,"block","text-sm","font-medium","text-gray-700"],["id","message","name","message","formControlName","message","rows","6",1,"mt-1","bg-gray-50","block","w-full","px-4","py-3","border","border-gray-300","rounded-md","shadow-sm","focus:outline-none","sm:text-sm"],[1,"my-4"],["type","submit",1,"w-full","flex","bg-black","justify-center","py-3","px-10","border","border-transparent","rounded-md","shadow-sm","text-sm","font-medium","text-white",3,"disabled"],["class","flex justify-center items-center space-x-1",4,"ngIf"],[1,"py-3"],[1,"text-red-300"],[1,"my-2"],[1,"text-red-200"],[1,"flex","justify-center","items-center","space-x-1"],["aria-hidden","true","viewBox","0 0 100 101","fill","none","xmlns","http://www.w3.org/2000/svg",1,"w-4","h-4","me-2","text-gray-200","animate-spin","dark:text-gray-600","fill-blue-600"],["d","M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z","fill","currentColor"],["d","M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z","fill","currentFill"],[1,"sr-only"]],template:function(i,s){i&1&&va(0,y5,37,6,"div",0)(1,v5,2,0,"div",1),i&2&&(ot("ngIf",!s.showSuccess),wt(),ot("ngIf",s.showSuccess&&s.submitted))},dependencies:[TN,DN,Op,vN,_N,lE,uE,ri,PR,SN],styles:['.envelope[_ngcontent-%COMP%]{height:200px;width:320px;background-color:#e1e1e1;position:relative;overflow:hidden;margin:0 auto}.envelope[_ngcontent-%COMP%]:before, .envelope[_ngcontent-%COMP%]:after{content:"";height:240px;width:240px;border:1px solid #e7dfce;position:absolute;border-radius:32px 32px 20px;background-color:#d6d6d6}.envelope[_ngcontent-%COMP%]:before{top:auto;bottom:0;left:50%;transform:translate(-50%,50%) rotate(45deg)}.envelope[_ngcontent-%COMP%]:after{left:50%;top:0;transform:translate(-50%,-50%) rotate(45deg);box-shadow:1px 1px 20px 1px #7c7b7a}']});let t=e;return t})();var VO=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=qt({type:e,selectors:[["app-work"]],standalone:!0,features:[Ht],decls:60,vars:0,consts:[[1,"max-w-3xl","mt-10","p-4","mx-auto","px-10"],[1,"text-4xl","font-bold","text-center","mt-4","mb-[4rem]"],[1,"relative","border-s","px-2","border-gray-700"],[1,"mb-10","ms-6"],[1,"absolute","flex","items-center","justify-center","w-6","h-6","rounded-full","-start-3","ring-8","ring-gray-900","bg-blue-900"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"w-2.5","h-2.5","text-blue-300"],["d","M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"],[1,"flex","items-center","mb-1","text-lg","pb-3","font-semibold","text-gray-900"],[1,"block","mb-2","text-sm","font-normal","leading-none","text-gray-500"],[1,"mb-4","text-base","font-normal","pt-4","text-gray-500","dark:text-gray-400"],[1,"flex","flex-col","space-y-3"],[1,"flex","items-center","mb-1","pb-3","text-lg","font-semibold","text-gray-900"],[1,"mb-4","text-base","pt-4","font-normal","text-gray-500","dark:text-gray-400"]],template:function(i,s){i&1&&(V(0,"div",0)(1,"h1",1),Q(2,"Work history"),$(),V(3,"ol",2)(4,"li",3)(5,"span",4),_r(),V(6,"svg",5),ke(7,"path",6),$()(),wr(),V(8,"h3",7),Q(9," Software Developer at JOBJACK. "),$(),V(10,"time",8),Q(11,"2021 - Current"),$(),V(12,"div",9)(13,"ul",10)(14,"li"),Q(15," - Collaborate with product managers, designers, and other stakeholders to drive product growth and deliver innovative solutions. "),$(),V(16,"li"),Q(17," - Develop and optimize front-end and back-end components to enhance performance and user experience. "),$(),V(18,"li"),Q(19," - Conduct code reviews and provided constructive feedback to team members. "),$(),V(20,"li"),Q(21," - Integrate third-party APIs and services to extend application functionality. "),$(),V(22,"li"),Q(23," - Mentor and train junior developers, fostering a culture of continuous learning and improvement. "),$()()()(),V(24,"li",3)(25,"span",4),_r(),V(26,"svg",5),ke(27,"path",6),$()(),wr(),V(28,"h3",11),Q(29," Software Developer at ORACLE. "),$(),V(30,"time",8),Q(31,"2020 - 2021"),$(),V(32,"div",12)(33,"ul",10)(34,"li"),Q(35," - Implemented and updated application modules under the direction of Senior Developers. "),$(),V(36,"li"),Q(37," - Created and maintained technical documentation to support ongoing development and future enhancements. "),$(),V(38,"li"),Q(39," - Participated in agile development processes, including daily stand-ups, sprint planning, and retrospectives. "),$(),V(40,"li"),Q(41," - Participated in code reviews, providing feedback and suggestions to improve code quality and maintainability. "),$()()()(),V(42,"li",3)(43,"span",4),_r(),V(44,"svg",5),ke(45,"path",6),$()(),wr(),V(46,"h3",11),Q(47," Tutor at University of Limpopo. "),$(),V(48,"time",8),Q(49,"2017 - 2020"),$(),V(50,"div",12)(51,"ul",10)(52,"li"),Q(53," - Provided one-on-one and group tutoring sessions in programming languages such as C#, Java, C++ and Python. "),$(),V(54,"li"),Q(55," - Developed customized lesson plans to meet individual student needs and learning styles. "),$(),V(56,"li"),Q(57," - Assisted students with understanding fundamental programming concepts, debugging code, and completing assignments. "),$(),V(58,"li"),Q(59,"- Helped students prepare for exams."),$()()()()()())}});let t=e;return t})();var jO=[{path:"",component:zM},{path:"about",component:WM},{path:"contact",component:LO},{path:"work",component:VO},{path:"**",redirectTo:""}];var UO="@firebase/database",BO="1.0.5";var LD="";function VD(t){LD=t}var PC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ht(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:gh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var kC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Mn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var vF=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new PC(e)}}catch{}return new kC},bo=vF("localStorage"),OC=vF("sessionStorage");var Rc=new Ci("@firebase/database"),_F=function(){let t=1;return function(){return t++}}(),wF=function(t){let e=kT(t),n=new PT;n.update(e);let r=n.digest();return hh.encodeByteArray(r)},Ld=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Ld.apply(null,r):typeof r=="object"?e+=ht(r):e+=r,e+=" "}return e},To=null,$O=!0,EF=function(t,e){j(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Rc.logLevel=Nn.VERBOSE,To=Rc.log.bind(Rc),e&&OC.set("logging_enabled",!0)):typeof t=="function"?To=t:(To=null,OC.remove("logging_enabled"))},xt=function(...t){if($O===!0&&($O=!1,To===null&&OC.get("logging_enabled")===!0&&EF(!0)),To){let e=Ld.apply(null,t);To(e)}},Vd=function(t){return function(...e){xt(t,...e)}},FC=function(...t){let e="FIREBASE INTERNAL ERROR: "+Ld(...t);Rc.error(e)},Ur=function(...t){let e=`FIREBASE FATAL ERROR: ${Ld(...t)}`;throw Rc.error(e),new Error(e)},Wt=function(...t){let e="FIREBASE WARNING: "+Ld(...t);Rc.warn(e)},_5=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Wt("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Gm=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},w5=function(t){if(ur()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ys="[MIN_NAME]",mi="[MAX_NAME]",Ao=function(t,e){if(t===e)return 0;if(t===ys||e===mi)return-1;if(e===ys||t===mi)return 1;{let n=qO(t),r=qO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},E5=function(t,e){return t===e?0:t<e?-1:1},pd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ht(e))},jD=function(t){if(typeof t!="object"||t===null)return ht(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ht(e[r]),n+=":",n+=jD(t[e[r]]);return n+="}",n},IF=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Rt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var CF=function(t){j(!Gm(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let d=u.join(""),h="";for(c=0;c<64;c+=8){let g=parseInt(d.substr(c,8),2).toString(16);g.length===1&&(g="0"+g),h=h+g}return h.toLowerCase()},I5=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},C5=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function D5(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var b5=new RegExp("^-?(0*)\\d{1,10}$"),T5=-2147483648,S5=2147483647,qO=function(t){if(b5.test(t)){let e=Number(t);if(e>=T5&&e<=S5)return e}return null},jc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Wt("Exception was thrown by user callback.",n),e},Math.floor(0))}},A5=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},vd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var LC=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Wt(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var VC=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(xt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Wt(e)}},_d=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),_m="5",DF="v",bF="s",TF="r",SF="f",AF=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,xF="ls",RF="p",jC="ac",MF="websocket",NF="long_polling";var wm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=bo.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&bo.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function x5(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function PF(t,e,n){j(typeof e=="string","typeof type must == string"),j(typeof n=="object","typeof params must == object");let r;if(e===MF)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===NF)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);x5(t)&&(n.ns=t.namespace);let i=[];return Rt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var UC=class{constructor(){this.counters_={}}incrementCounter(e,n=1){Mn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return TT(this.counters_)}};var TC={},SC={};function UD(t){let e=t.toString();return TC[e]||(TC[e]=new UC),TC[e]}function R5(t,e){let n=t.toString();return SC[n]||(SC[n]=e()),SC[n]}var BC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&jc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var HO="start",M5="close",N5="pLPCommand",P5="pRTLPCB",kF="id",OF="pw",FF="ser",k5="cb",O5="seg",F5="ts",L5="d",V5="dframe",LF=1870,VF=30,j5=LF-VF,U5=25e3,B5=3e4,Cd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Vd(e),this.stats_=UD(n),this.urlFn=c=>(this.appCheckToken&&(c[jC]=this.appCheckToken),PF(n,NF,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new BC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(B5)),w5(()=>{if(this.isClosed_)return;this.scriptTagHolder=new $C((...s)=>{let[o,a,c,u,d]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===HO)this.id=a,this.password=c;else if(o===M5)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[HO]="t",r[FF]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[k5]=this.scriptTagHolder.uniqueCallbackIdentifier),r[DF]=_m,this.transportSessionId&&(r[bF]=this.transportSessionId),this.lastSessionId&&(r[xF]=this.lastSessionId),this.applicationId&&(r[RF]=this.applicationId),this.appCheckToken&&(r[jC]=this.appCheckToken),typeof location<"u"&&location.hostname&&AF.test(location.hostname)&&(r[TF]=SF);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ur()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!I5()&&!C5()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=ht(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=bT(n),i=IF(r,j5);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ur())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[V5]="t",r[kF]=e,r[OF]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=ht(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},$C=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ur())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=_F(),window[N5+this.uniqueCallbackIdentifier]=e,window[P5+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){xt("frame writing exception"),a.stack&&xt(a.stack),xt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||xt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[kF]=this.myID,e[OF]=this.myPW,e[FF]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+VF+r.length<=LF;){let o=this.pendingSegs.shift();r=r+"&"+O5+i+"="+o.seg+"&"+F5+i+"="+o.ts+"&"+L5+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(U5)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ur()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{xt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var $5=16384,q5=45e3,Em=null;typeof MozWebSocket<"u"?Em=MozWebSocket:typeof WebSocket<"u"&&(Em=WebSocket);var Ac=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Vd(this.connId),this.stats_=UD(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[DF]=_m,!ur()&&typeof location<"u"&&location.hostname&&AF.test(location.hostname)&&(a[TF]=SF),r&&(a[bF]=r),i&&(a[xF]=i),s&&(a[jC]=s),o&&(a[RF]=o),PF(n,MF,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,bo.set("previous_websocket_failure",!0);try{let i;if(ur()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${_m}/${LD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Em(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Em!==null&&!t.forceDisallow_}static previouslyFailed(){return bo.isInMemoryStorage||bo.get("previous_websocket_failure")===!0}markConnectionHealthy(){bo.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=gh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(j(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=ht(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=IF(r,$5);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(q5))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),jF=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Cd,Ac]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Ac&&Ac.isAvailable(),i=r&&!Ac.previouslyFailed();if(n.webSocketOnly&&(r||Wt("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Ac];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),H5=6e4,G5=5e3,z5=10*1024,W5=100*1024,AC="t",GO="d",K5="s",zO="r",Q5="e",WO="o",KO="a",QO="n",YO="p",Y5="h",qC=class{constructor(e,n,r,i,s,o,a,c,u,d){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Vd("c:"+this.id+":"),this.transportManager_=new jF(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=vd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>W5?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>z5?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(AC in e){let n=e[AC];n===KO?this.upgradeIfSecondaryHealthy_():n===zO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===WO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=pd("t",e),r=pd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:YO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:KO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:QO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=pd("t",e),r=pd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=pd(AC,e);if(GO in e){let r=e[GO];if(n===Y5){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===QO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===K5?this.onConnectionShutdown_(r):n===zO?this.onReset_(r):n===Q5?FC("Server Error: "+r):n===WO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):FC("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),_m!==r&&Wt("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),vd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(H5))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):vd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(G5))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:YO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(bo.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var Im=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Cm=class{constructor(e){this.allowedEvents_=e,this.listeners_={},j(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){j(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Dm=class t extends Cm{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!Fy()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return j(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var ZO=32,JO=768,Ne=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function Me(){return new Ne("")}function ye(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function vs(t){return t.pieces_.length-t.pieceNum_}function Be(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new Ne(t.pieces_,e)}function BD(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Z5(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Dd(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function UF(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new Ne(e,0)}function Ze(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof Ne)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new Ne(n,0)}function ve(t){return t.pieceNum_>=t.pieces_.length}function on(t,e){let n=ye(t),r=ye(e);if(n===null)return e;if(n===r)return on(Be(t),Be(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function J5(t,e){let n=Dd(t,0),r=Dd(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Ao(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function $D(t,e){if(vs(t)!==vs(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function $n(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(vs(t)>vs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var HC=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Dd(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=dl(this.parts_[r]);BF(this)}};function X5(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=dl(e),BF(t)}function e6(t){let e=t.parts_.pop();t.byteLength_-=dl(e),t.parts_.length>0&&(t.byteLength_-=1)}function BF(t){if(t.byteLength_>JO)throw new Error(t.errorPrefix_+"has a key path longer than "+JO+" bytes ("+t.byteLength_+").");if(t.parts_.length>ZO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ZO+") or object contains a cycle "+Do(t))}function Do(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var GC=class t extends Cm{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return j(e==="visible","Unknown event type: "+e),[this.visible_]}};var gd=1e3,t6=60*5*1e3,XO=30*1e3,n6=1.3,r6=3e4,i6="server_kill",eF=3,qD=(()=>{class t extends Im{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=Vd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=gd,this.maxReconnectDelay_=t6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!ur())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");GC.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Dm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(ht(o)),j(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new It,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),j(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),j(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,d=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),d!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(d,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&Mn(n,"w")){let i=Ii(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Wt(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||MT(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=XO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=RT(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),j(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+ht(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):FC("Unrecognized action received from server: "+ht(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){j(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>r6&&(this.reconnectDelay_=gd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*n6)}this.onConnectStatus_(!1)}establishConnection_(){return x(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},d=function(g){j(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(g)};this.realtime_={close:u,sendRequest:d};let h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[g,y]=yield Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);a?xt("getToken() completed but was canceled"):(xt("getToken() completed. Creating connection."),this.authToken_=g&&g.accessToken,this.appCheckToken_=y&&y.token,c=new qC(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,E=>{Wt(E+" ("+this.repoInfo_.toString()+")"),this.interrupt(i6)},o))}catch(g){this.log_("Failed to get token: "+g),a||(this.repoInfo_.nodeAdmin&&Wt(g),u())}}})}interrupt(n){xt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){xt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],mh(this.interruptReasons_)&&(this.reconnectDelay_=gd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>jD(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new Ne(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){xt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=eF&&(this.reconnectDelay_=XO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){xt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=eF&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ur()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+LD.replace(/\./g,"-")]=1,Fy()?n["framework.cordova"]=1:ST()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Dm.getInstance().currentlyOnline();return mh(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),we=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Mc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new we(ys,e),i=new we(ys,n);return this.compare(r,i)!==0}minPost(){return we.MIN}};var vm,bm=class extends Mc{static get __EMPTY_NODE(){return vm}static set __EMPTY_NODE(e){vm=e}compare(e,n){return Ao(e.name,n.name)}isDefinedOn(e){throw Lo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return we.MIN}maxPost(){return new we(mi,vm)}makePost(e,n){return j(typeof e=="string","KeyIndex indexValue must always be a string."),new we(e,vm)}toString(){return".key"}},jr=new bm;var xc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},cr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??qn.EMPTY_NODE,this.right=o??qn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return qn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return qn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),zC=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new cr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},qn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,cr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,cr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new xc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new xc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new xc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new xc(this.root_,null,this.comparator_,!0,e)}};qn.EMPTY_NODE=new zC;function s6(t,e){return Ao(t.name,e.name)}function HD(t,e){return Ao(t,e)}var WC;function o6(t){WC=t}var $F=function(t){return typeof t=="number"?"number:"+CF(t):"string:"+t},qF=function(t){if(t.isLeafNode()){let e=t.val();j(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Mn(e,".sv"),"Priority must be a string or number.")}else j(t===WC||t.isEmpty(),"priority of unexpected type.");j(t===WC||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var tF,Nc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,j(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),qF(this.priorityNode_)}static set __childrenNodeConstructor(n){tF=n}static get __childrenNodeConstructor(){return tF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ve(n)?this:ye(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ye(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(j(i!==".priority"||vs(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Be(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+$F(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=CF(this.value_):n+=this.value_,this.lazyHash_=wF(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(j(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return j(s>=0,"Unknown leaf type: "+r),j(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),HF,GF;function a6(t){HF=t}function c6(t){GF=t}var KC=class extends Mc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Ao(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return we.MIN}maxPost(){return new we(mi,new Nc("[PRIORITY-POST]",GF))}makePost(e,n){let r=HF(e);return new we(n,new Nc("[PRIORITY-POST]",r))}toString(){return".priority"}},He=new KC;var l6=Math.log(2),QC=class{constructor(e){let n=s=>parseInt(Math.log(s)/l6,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Tm=function(t,e,n,r){t.sort(e);let i=function(c,u){let d=u-c,h,g;if(d===0)return null;if(d===1)return h=t[c],g=n?n(h):h,new cr(g,h.node,cr.BLACK,null,null);{let y=parseInt(d/2,10)+c,E=i(c,y),D=i(y+1,u);return h=t[y],g=n?n(h):h,new cr(g,h.node,cr.BLACK,E,D)}},s=function(c){let u=null,d=null,h=t.length,g=function(E,D){let S=h-E,k=h;h-=E;let q=i(S+1,k),F=t[S],Y=n?n(F):F;y(new cr(Y,F.node,D,null,q))},y=function(E){u?(u.left=E,u=E):(d=E,u=E)};for(let E=0;E<c.count;++E){let D=c.nextBitIsOne(),S=Math.pow(2,c.count-(E+1));D?g(S,cr.BLACK):(g(S,cr.BLACK),g(S,cr.RED))}return d},o=new QC(t.length),a=s(o);return new qn(r||e,a)};var xC,Sc={},Pc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return j(Sc&&He,"ChildrenNode.ts has not been loaded"),xC=xC||new t({".priority":Sc},{".priority":He}),xC}get(e){let n=Ii(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof qn?n:null}hasIndex(e){return Mn(this.indexSet_,e.toString())}addIndex(e,n){j(e!==jr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(we.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Tm(r,e.getCompare()):a=Sc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let d=Object.assign({},this.indexes_);return d[c]=a,new t(d,u)}addToIndexes(e,n){let r=ul(this.indexes_,(i,s)=>{let o=Ii(this.indexSet_,s);if(j(o,"Missing index implementation for "+s),i===Sc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(we.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),Tm(a,o.getCompare())}else return Sc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new we(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=ul(this.indexes_,i=>{if(i===Sc)return i;{let s=n.get(e.name);return s?i.remove(new we(e.name,s)):i}});return new t(r,this.indexSet_)}};var md,de=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&qF(this.priorityNode_),this.children_.isEmpty()&&j(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return md||(md=new t(new qn(HD),null,Pc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||md}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?md:r}}getChild(n){let r=ye(n);return r===null?this:this.getImmediateChild(r).getChild(Be(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(j(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new we(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?md:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ye(n);if(i===null)return r;{j(ye(n)!==".priority"||vs(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Be(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(He,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+$F(this.getPriority().val())+":"),this.forEachChild(He,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":wF(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new we(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new we(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new we(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,we.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===jd?-1:0}withIndex(n){if(n===jr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===jr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(He),s=r.getIterator(He),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===jr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),YC=class extends de{constructor(){super(new qn(HD),de.EMPTY_NODE,Pc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return de.EMPTY_NODE}isEmpty(){return!1}},jd=new YC;Object.defineProperties(we,{MIN:{value:new we(ys,de.EMPTY_NODE)},MAX:{value:new we(mi,jd)}});bm.__EMPTY_NODE=de.EMPTY_NODE;Nc.__childrenNodeConstructor=de;o6(jd);c6(jd);var u6=!0;function Xe(t,e=null){if(t===null)return de.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),j(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Nc(n,Xe(e))}if(!(t instanceof Array)&&u6){let n=[],r=!1;if(Rt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=Xe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new we(o,c)))}}),n.length===0)return de.EMPTY_NODE;let s=Tm(n,s6,o=>o.name,HD);if(r){let o=Tm(n,He.getCompare());return new de(s,Xe(e),new Pc({".priority":o},{".priority":He}))}else return new de(s,Xe(e),Pc.Default)}else{let n=de.EMPTY_NODE;return Rt(t,(r,i)=>{if(Mn(t,r)&&r.substring(0,1)!=="."){let s=Xe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Xe(e))}}a6(Xe);var bd=class extends Mc{constructor(e){super(),this.indexPath_=e,j(!ve(e)&&ye(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Ao(e.name,n.name):s}makePost(e,n){let r=Xe(e),i=de.EMPTY_NODE.updateChild(this.indexPath_,r);return new we(n,i)}maxPost(){let e=de.EMPTY_NODE.updateChild(this.indexPath_,jd);return new we(mi,e)}toString(){return Dd(this.indexPath_,0).join("/")}};var ZC=class extends Mc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Ao(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return we.MIN}maxPost(){return we.MAX}makePost(e,n){let r=Xe(e);return new we(n,r)}toString(){return".value"}},GD=new ZC;function zF(t){return{type:"value",snapshotNode:t}}function kc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Td(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Sd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function d6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Ad=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){j(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Td(n,a)):j(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(kc(n,r)):o.trackChildChange(Sd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(He,(i,s)=>{n.hasChild(i)||r.trackChildChange(Td(i,s))}),n.isLeafNode()||n.forEachChild(He,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Sd(i,s,o))}else r.trackChildChange(kc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?de.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Sm=class t{constructor(e){this.indexedFilter_=new Ad(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new we(n,r))||(r=de.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=de.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(de.EMPTY_NODE);let s=this;return n.forEachChild(He,(o,a)=>{s.matches(new we(o,a))||(i=i.updateImmediateChild(o,de.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var JC=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Sm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new we(n,r))||(r=de.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=de.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=de.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(de.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,de.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let h=this.index_.getCompare();o=(g,y)=>h(y,g)}else o=this.index_.getCompare();let a=e;j(a.numChildren()===this.limit_,"");let c=new we(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(c);if(a.hasChild(n)){let h=a.getImmediateChild(n),g=i.getChildAfterChild(this.index_,u,this.reverse_);for(;g!=null&&(g.name===n||a.hasChild(g.name));)g=i.getChildAfterChild(this.index_,g,this.reverse_);let y=g==null?1:o(g,c);if(d&&!r.isEmpty()&&y>=0)return s?.trackChildChange(Sd(n,r,h)),a.updateImmediateChild(n,r);{s?.trackChildChange(Td(n,h));let D=a.updateImmediateChild(n,de.EMPTY_NODE);return g!=null&&this.rangedFilter_.matches(g)?(s?.trackChildChange(kc(g.name,g.node)),D.updateImmediateChild(g.name,g.node)):D}}else return r.isEmpty()?e:d&&o(u,c)>=0?(s!=null&&(s.trackChildChange(Td(u.name,u.node)),s.trackChildChange(kc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,de.EMPTY_NODE)):e}};var xd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=He}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return j(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return j(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ys}hasEnd(){return this.endSet_}getIndexEndValue(){return j(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return j(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:mi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return j(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===He}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function h6(t){return t.loadsAllData()?new Ad(t.getIndex()):t.hasLimit()?new JC(t):new Sm(t)}function f6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function p6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function XC(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function g6(t,e,n){let r;return t.index_===jr||n?r=XC(t,e,n):r=XC(t,e,mi),r.startAfterSet_=!0,r}function eD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function m6(t,e,n){let r;return t.index_===jr||n?r=eD(t,e,n):r=eD(t,e,ys),r.endBeforeSet_=!0,r}function zm(t,e){let n=t.copy();return n.index_=e,n}function nF(t){let e={};if(t.isDefault())return e;let n;if(t.index_===He?n="$priority":t.index_===GD?n="$value":t.index_===jr?n="$key":(j(t.index_ instanceof bd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ht(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=ht(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ht(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ht(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ht(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function rF(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==He&&(e.i=t.index_.toString()),e}var tD=class t extends Im{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Vd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(j(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=nF(e._queryParams);this.restRequest_(s+".json",c,(u,d)=>{let h=d;if(u===404&&(h=null,u=null),u===null&&this.onDataUpdate_(s,h,!1,r),Ii(this.listens_,o)===a){let g;u?u===401?g="permission_denied":g="rest_error:"+u:g="ok",i(g,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=nF(e._queryParams),r=e._path.toString(),i=new It;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+NT(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=gh(a.responseText)}catch{Wt("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Wt("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var nD=class{constructor(){this.rootNode_=de.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Am(){return{value:null,children:new Map}}function Uc(t,e,n){if(ve(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ye(e);t.children.has(r)||t.children.set(r,Am());let i=t.children.get(r);e=Be(e),Uc(i,e,n)}}function rD(t,e){if(ve(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(He,(r,i)=>{Uc(t,new Ne(r),i)}),rD(t,e)}}else if(t.children.size>0){let n=ye(e);return e=Be(e),t.children.has(n)&&rD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function iD(t,e,n){t.value!==null?n(e,t.value):y6(t,(r,i)=>{let s=new Ne(e.toString()+"/"+r);iD(i,s,n)})}function y6(t,e){t.children.forEach((n,r)=>{e(r,n)})}var sD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Rt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var iF=10*1e3,v6=30*1e3,_6=5*60*1e3,oD=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new sD(e);let r=iF+(v6-iF)*Math.random();vd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;Rt(e,(i,s)=>{s>0&&Mn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),vd(this.reportStats_.bind(this),Math.floor(Math.random()*2*_6))}};var Vr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Vr||{});function zD(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function WD(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function KD(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var aD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Vr.ACK_USER_WRITE,this.source=zD()}operationForChild(e){if(ve(this.path)){if(this.affectedTree.value!=null)return j(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new Ne(e));return new t(Me(),n,this.revert)}}else return j(ye(this.path)===e,"operationForChild called for unrelated child."),new t(Be(this.path),this.affectedTree,this.revert)}};var xm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Vr.LISTEN_COMPLETE}operationForChild(e){return ve(this.path)?new t(this.source,Me()):new t(this.source,Be(this.path))}};var Oc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Vr.OVERWRITE}operationForChild(e){return ve(this.path)?new t(this.source,Me(),this.snap.getImmediateChild(e)):new t(this.source,Be(this.path),this.snap)}};var Rd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Vr.MERGE}operationForChild(e){if(ve(this.path)){let n=this.children.subtree(new Ne(e));return n.isEmpty()?null:n.value?new Oc(this.source,Me(),n.value):new t(this.source,Me(),n)}else return j(ye(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Be(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Br=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ve(e))return this.isFullyInitialized()&&!this.filtered_;let n=ye(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var cD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function w6(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(d6(o.childName,o.snapshotNode))}),yd(t,i,"child_removed",e,r,n),yd(t,i,"child_added",e,r,n),yd(t,i,"child_moved",s,r,n),yd(t,i,"child_changed",e,r,n),yd(t,i,"value",e,r,n),i}function yd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>I6(t,a,c)),o.forEach(a=>{let c=E6(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function E6(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function I6(t,e,n){if(e.childName==null||n.childName==null)throw Lo("Should only compare child_ events.");let r=new we(e.childName,e.snapshotNode),i=new we(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Wm(t,e){return{eventCache:t,serverCache:e}}function wd(t,e,n,r){return Wm(new Br(e,n,r),t.serverCache)}function WF(t,e,n,r){return Wm(t.eventCache,new Br(e,n,r))}function Rm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function So(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var RC,C6=()=>(RC||(RC=new qn(E5)),RC),an=class t{constructor(e,n=C6()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return Rt(e,(r,i)=>{n=n.set(new Ne(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Me(),value:this.value};if(ve(e))return null;{let r=ye(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Be(e),n);return s!=null?{path:Ze(new Ne(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ve(e))return this;{let n=ye(e),r=this.children.get(n);return r!==null?r.subtree(Be(e)):new t(null)}}set(e,n){if(ve(e))return new t(n,this.children);{let r=ye(e),s=(this.children.get(r)||new t(null)).set(Be(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ve(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ye(e),r=this.children.get(n);if(r){let i=r.remove(Be(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ve(e))return this.value;{let n=ye(e),r=this.children.get(n);return r?r.get(Be(e)):null}}setTree(e,n){if(ve(e))return n;{let r=ye(e),s=(this.children.get(r)||new t(null)).setTree(Be(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(Me(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Ze(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,Me(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ve(e))return null;{let s=ye(e),o=this.children.get(s);return o?o.findOnPath_(Be(e),Ze(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Me(),n)}foreachOnPath_(e,n,r){if(ve(e))return this;{this.value&&r(n,this.value);let i=ye(e),s=this.children.get(i);return s?s.foreachOnPath_(Be(e),Ze(n,i),r):new t(null)}}foreach(e){this.foreach_(Me(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Ze(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var lr=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new an(null))}};function Ed(t,e,n){if(ve(e))return new lr(new an(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=on(i,e);return s=s.updateChild(o,n),new lr(t.writeTree_.set(i,s))}else{let i=new an(n),s=t.writeTree_.setTree(e,i);return new lr(s)}}}function lD(t,e,n){let r=t;return Rt(n,(i,s)=>{r=Ed(r,Ze(e,i),s)}),r}function sF(t,e){if(ve(e))return lr.empty();{let n=t.writeTree_.setTree(e,new an(null));return new lr(n)}}function uD(t,e){return xo(t,e)!=null}function xo(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(on(n.path,e)):null}function oF(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(He,(r,i)=>{e.push(new we(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new we(r,i.value))}),e}function gs(t,e){if(ve(e))return t;{let n=xo(t,e);return n!=null?new lr(new an(n)):new lr(t.writeTree_.subtree(e))}}function dD(t){return t.writeTree_.isEmpty()}function Fc(t,e){return KF(Me(),t.writeTree_,e)}function KF(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(j(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=KF(Ze(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Ze(t,".priority"),r)),n}}function Km(t,e){return JF(e,t)}function D6(t,e,n,r,i){j(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ed(t.visibleWrites,e,n)),t.lastWriteId=r}function b6(t,e,n,r){j(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=lD(t.visibleWrites,e,n),t.lastWriteId=r}function T6(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function S6(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);j(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&A6(a,r.path)?i=!1:$n(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return x6(t),!0;if(r.snap)t.visibleWrites=sF(t.visibleWrites,r.path);else{let a=r.children;Rt(a,c=>{t.visibleWrites=sF(t.visibleWrites,Ze(r.path,c))})}return!0}else return!1}function A6(t,e){if(t.snap)return $n(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&$n(Ze(t.path,n),e))return!0;return!1}function x6(t){t.visibleWrites=QF(t.allWrites,R6,Me()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function R6(t){return t.visible}function QF(t,e,n){let r=lr.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)$n(n,o)?(a=on(n,o),r=Ed(r,a,s.snap)):$n(o,n)&&(a=on(o,n),r=Ed(r,Me(),s.snap.getChild(a)));else if(s.children){if($n(n,o))a=on(n,o),r=lD(r,a,s.children);else if($n(o,n))if(a=on(o,n),ve(a))r=lD(r,Me(),s.children);else{let c=Ii(s.children,ye(a));if(c){let u=c.getChild(Be(a));r=Ed(r,Me(),u)}}}else throw Lo("WriteRecord should have .snap or .children")}}return r}function YF(t,e,n,r,i){if(!r&&!i){let s=xo(t.visibleWrites,e);if(s!=null)return s;{let o=gs(t.visibleWrites,e);if(dD(o))return n;if(n==null&&!uD(o,Me()))return null;{let a=n||de.EMPTY_NODE;return Fc(o,a)}}}else{let s=gs(t.visibleWrites,e);if(!i&&dD(s))return n;if(!i&&n==null&&!uD(s,Me()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&($n(u.path,e)||$n(e,u.path))},a=QF(t.allWrites,o,e),c=n||de.EMPTY_NODE;return Fc(a,c)}}}function M6(t,e,n){let r=de.EMPTY_NODE,i=xo(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(He,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=gs(t.visibleWrites,e);return n.forEachChild(He,(o,a)=>{let c=Fc(gs(s,new Ne(o)),a);r=r.updateImmediateChild(o,c)}),oF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=gs(t.visibleWrites,e);return oF(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function N6(t,e,n,r,i){j(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Ze(e,n);if(uD(t.visibleWrites,s))return null;{let o=gs(t.visibleWrites,s);return dD(o)?i.getChild(n):Fc(o,i.getChild(n))}}function P6(t,e,n,r){let i=Ze(e,n),s=xo(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=gs(t.visibleWrites,i);return Fc(o,r.getNode().getImmediateChild(n))}else return null}function k6(t,e){return xo(t.visibleWrites,e)}function O6(t,e,n,r,i,s,o){let a,c=gs(t.visibleWrites,e),u=xo(c,Me());if(u!=null)a=u;else if(n!=null)a=Fc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let d=[],h=o.getCompare(),g=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),y=g.getNext();for(;y&&d.length<i;)h(y,r)!==0&&d.push(y),y=g.getNext();return d}else return[]}function F6(){return{visibleWrites:lr.empty(),allWrites:[],lastWriteId:-1}}function Mm(t,e,n,r){return YF(t.writeTree,t.treePath,e,n,r)}function QD(t,e){return M6(t.writeTree,t.treePath,e)}function aF(t,e,n,r){return N6(t.writeTree,t.treePath,e,n,r)}function Nm(t,e){return k6(t.writeTree,Ze(t.treePath,e))}function L6(t,e,n,r,i,s){return O6(t.writeTree,t.treePath,e,n,r,i,s)}function YD(t,e,n){return P6(t.writeTree,t.treePath,e,n)}function ZF(t,e){return JF(Ze(t.treePath,e),t.writeTree)}function JF(t,e){return{treePath:t,writeTree:e}}var hD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;j(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),j(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Sd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Td(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,kc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Sd(r,e.snapshotNode,i.oldSnap));else throw Lo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var fD=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},XF=new fD,Md=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Br(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return YD(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:So(this.viewCache_),s=L6(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function V6(t){return{filter:t}}function j6(t,e){j(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),j(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function U6(t,e,n,r,i){let s=new hD,o,a;if(n.type===Vr.OVERWRITE){let u=n;u.source.fromUser?o=pD(t,e,u.path,u.snap,r,i,s):(j(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ve(u.path),o=Pm(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Vr.MERGE){let u=n;u.source.fromUser?o=$6(t,e,u.path,u.children,r,i,s):(j(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=gD(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Vr.ACK_USER_WRITE){let u=n;u.revert?o=G6(t,e,u.path,r,i,s):o=q6(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Vr.LISTEN_COMPLETE)o=H6(t,e,n.path,r,s);else throw Lo("Unknown operation type: "+n.type);let c=s.getChanges();return B6(e,o,c),{viewCache:o,changes:c}}function B6(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Rm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(zF(Rm(e)))}}function eL(t,e,n,r,i,s){let o=e.eventCache;if(Nm(r,n)!=null)return e;{let a,c;if(ve(n))if(j(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=So(e),d=u instanceof de?u:de.EMPTY_NODE,h=QD(r,d);a=t.filter.updateFullNode(e.eventCache.getNode(),h,s)}else{let u=Mm(r,So(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=ye(n);if(u===".priority"){j(vs(n)===1,"Can't have a priority with additional path components");let d=o.getNode();c=e.serverCache.getNode();let h=aF(r,n,d,c);h!=null?a=t.filter.updatePriority(d,h):a=o.getNode()}else{let d=Be(n),h;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let g=aF(r,n,o.getNode(),c);g!=null?h=o.getNode().getImmediateChild(u).updateChild(d,g):h=o.getNode().getImmediateChild(u)}else h=YD(r,u,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),u,h,d,i,s):a=o.getNode()}}return wd(e,a,o.isFullyInitialized()||ve(n),t.filter.filtersNodes())}}function Pm(t,e,n,r,i,s,o,a){let c=e.serverCache,u,d=o?t.filter:t.filter.getIndexedFilter();if(ve(n))u=d.updateFullNode(c.getNode(),r,null);else if(d.filtersNodes()&&!c.isFiltered()){let y=c.getNode().updateChild(n,r);u=d.updateFullNode(c.getNode(),y,null)}else{let y=ye(n);if(!c.isCompleteForPath(n)&&vs(n)>1)return e;let E=Be(n),S=c.getNode().getImmediateChild(y).updateChild(E,r);y===".priority"?u=d.updatePriority(c.getNode(),S):u=d.updateChild(c.getNode(),y,S,E,XF,null)}let h=WF(e,u,c.isFullyInitialized()||ve(n),d.filtersNodes()),g=new Md(i,h,s);return eL(t,h,n,i,g,a)}function pD(t,e,n,r,i,s,o){let a=e.eventCache,c,u,d=new Md(i,e,s);if(ve(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=wd(e,u,!0,t.filter.filtersNodes());else{let h=ye(n);if(h===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=wd(e,u,a.isFullyInitialized(),a.isFiltered());else{let g=Be(n),y=a.getNode().getImmediateChild(h),E;if(ve(g))E=r;else{let D=d.getCompleteChild(h);D!=null?BD(g)===".priority"&&D.getChild(UF(g)).isEmpty()?E=D:E=D.updateChild(g,r):E=de.EMPTY_NODE}if(y.equals(E))c=e;else{let D=t.filter.updateChild(a.getNode(),h,E,g,d,o);c=wd(e,D,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function cF(t,e){return t.eventCache.isCompleteForChild(e)}function $6(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let d=Ze(n,c);cF(e,ye(d))&&(a=pD(t,a,d,u,i,s,o))}),r.foreach((c,u)=>{let d=Ze(n,c);cF(e,ye(d))||(a=pD(t,a,d,u,i,s,o))}),a}function lF(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function gD(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ve(n)?u=r:u=new an(null).setTree(n,r);let d=e.serverCache.getNode();return u.children.inorderTraversal((h,g)=>{if(d.hasChild(h)){let y=e.serverCache.getNode().getImmediateChild(h),E=lF(t,y,g);c=Pm(t,c,new Ne(h),E,i,s,o,a)}}),u.children.inorderTraversal((h,g)=>{let y=!e.serverCache.isCompleteForChild(h)&&g.value===null;if(!d.hasChild(h)&&!y){let E=e.serverCache.getNode().getImmediateChild(h),D=lF(t,E,g);c=Pm(t,c,new Ne(h),D,i,s,o,a)}}),c}function q6(t,e,n,r,i,s,o){if(Nm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ve(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Pm(t,e,n,c.getNode().getChild(n),i,s,a,o);if(ve(n)){let u=new an(null);return c.getNode().forEachChild(jr,(d,h)=>{u=u.set(new Ne(d),h)}),gD(t,e,n,u,i,s,a,o)}else return e}else{let u=new an(null);return r.foreach((d,h)=>{let g=Ze(n,d);c.isCompleteForPath(g)&&(u=u.set(d,c.getNode().getChild(g)))}),gD(t,e,n,u,i,s,a,o)}}function H6(t,e,n,r,i){let s=e.serverCache,o=WF(e,s.getNode(),s.isFullyInitialized()||ve(n),s.isFiltered());return eL(t,o,n,r,XF,i)}function G6(t,e,n,r,i,s){let o;if(Nm(r,n)!=null)return e;{let a=new Md(r,e,i),c=e.eventCache.getNode(),u;if(ve(n)||ye(n)===".priority"){let d;if(e.serverCache.isFullyInitialized())d=Mm(r,So(e));else{let h=e.serverCache.getNode();j(h instanceof de,"serverChildren would be complete if leaf node"),d=QD(r,h)}d=d,u=t.filter.updateFullNode(c,d,s)}else{let d=ye(n),h=YD(r,d,e.serverCache);h==null&&e.serverCache.isCompleteForChild(d)&&(h=c.getImmediateChild(d)),h!=null?u=t.filter.updateChild(c,d,h,Be(n),a,s):e.eventCache.getNode().hasChild(d)?u=t.filter.updateChild(c,d,de.EMPTY_NODE,Be(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Mm(r,So(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Nm(r,Me())!=null,wd(e,u,o,t.filter.filtersNodes())}}var mD=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Ad(r.getIndex()),s=h6(r);this.processor_=V6(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(de.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(de.EMPTY_NODE,a.getNode(),null),d=new Br(c,o.isFullyInitialized(),i.filtersNodes()),h=new Br(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Wm(h,d),this.eventGenerator_=new cD(this.query_)}get query(){return this.query_}};function z6(t){return t.viewCache_.serverCache.getNode()}function W6(t){return Rm(t.viewCache_)}function K6(t,e){let n=So(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ve(e)&&!n.getImmediateChild(ye(e)).isEmpty())?n.getChild(e):null}function uF(t){return t.eventRegistrations_.length===0}function Q6(t,e){t.eventRegistrations_.push(e)}function dF(t,e,n){let r=[];if(n){j(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function hF(t,e,n,r){e.type===Vr.MERGE&&e.source.queryId!==null&&(j(So(t.viewCache_),"We should always have a full cache before handling merges"),j(Rm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=U6(t.processor_,i,e,n,r);return j6(t.processor_,s.viewCache),j(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,tL(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Y6(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(He,(s,o)=>{r.push(kc(s,o))}),n.isFullyInitialized()&&r.push(zF(n.getNode())),tL(t,r,n.getNode(),e)}function tL(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return w6(t.eventGenerator_,e,n,i)}var km,Om=class{constructor(){this.views=new Map}};function Z6(t){j(!km,"__referenceConstructor has already been defined"),km=t}function J6(){return j(km,"Reference.ts has not been loaded"),km}function X6(t){return t.views.size===0}function ZD(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return j(s!=null,"SyncTree gave us an op for an invalid query."),hF(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(hF(o,e,n,r));return s}}function nL(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Mm(n,i?r:null),c=!1;a?c=!0:r instanceof de?(a=QD(n,r),c=!1):(a=de.EMPTY_NODE,c=!1);let u=Wm(new Br(a,c,!1),new Br(r,i,!1));return new mD(e,u)}return o}function e8(t,e,n,r,i,s){let o=nL(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Q6(o,n),Y6(o,n)}function t8(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=_s(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(dF(u,n,r)),uF(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(dF(c,n,r)),uF(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!_s(t)&&s.push(new(J6())(e._repo,e._path)),{removed:s,events:o}}function rL(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ms(t,e){let n=null;for(let r of t.views.values())n=n||K6(r,e);return n}function iL(t,e){if(e._queryParams.loadsAllData())return Qm(t);{let r=e._queryIdentifier;return t.views.get(r)}}function sL(t,e){return iL(t,e)!=null}function _s(t){return Qm(t)!=null}function Qm(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Fm;function n8(t){j(!Fm,"__referenceConstructor has already been defined"),Fm=t}function r8(){return j(Fm,"Reference.ts has not been loaded"),Fm}var i8=1,Lm=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new an(null),this.pendingWriteTree_=F6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function JD(t,e,n,r,i){return D6(t.pendingWriteTree_,e,n,r,i),i?Bc(t,new Oc(zD(),e,n)):[]}function s8(t,e,n,r){b6(t.pendingWriteTree_,e,n,r);let i=an.fromObject(n);return Bc(t,new Rd(zD(),e,i))}function ps(t,e,n=!1){let r=T6(t.pendingWriteTree_,e);if(S6(t.pendingWriteTree_,e)){let s=new an(null);return r.snap!=null?s=s.set(Me(),!0):Rt(r.children,o=>{s=s.set(new Ne(o),!0)}),Bc(t,new aD(r.path,s,n))}else return[]}function Ud(t,e,n){return Bc(t,new Oc(WD(),e,n))}function o8(t,e,n){let r=an.fromObject(n);return Bc(t,new Rd(WD(),e,r))}function a8(t,e){return Bc(t,new xm(WD(),e))}function c8(t,e,n){let r=XD(t,n);if(r){let i=eb(r),s=i.path,o=i.queryId,a=on(s,e),c=new xm(KD(o),a);return tb(t,s,c)}else return[]}function Vm(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||sL(o,e))){let c=t8(o,e,n,r);X6(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let d=u.findIndex(g=>g._queryParams.loadsAllData())!==-1,h=t.syncPointTree_.findOnPath(s,(g,y)=>_s(y));if(d&&!h){let g=t.syncPointTree_.subtree(s);if(!g.isEmpty()){let y=d8(g);for(let E=0;E<y.length;++E){let D=y[E],S=D.query,k=lL(t,D);t.listenProvider_.startListening(Id(S),Nd(t,S),k.hashFn,k.onComplete)}}}!h&&u.length>0&&!r&&(d?t.listenProvider_.stopListening(Id(e),null):u.forEach(g=>{let y=t.queryToTagMap.get(Zm(g));t.listenProvider_.stopListening(Id(g),y)}))}h8(t,u)}return a}function oL(t,e,n,r){let i=XD(t,r);if(i!=null){let s=eb(i),o=s.path,a=s.queryId,c=on(o,e),u=new Oc(KD(a),c,n);return tb(t,o,u)}else return[]}function l8(t,e,n,r){let i=XD(t,r);if(i){let s=eb(i),o=s.path,a=s.queryId,c=on(o,e),u=an.fromObject(n),d=new Rd(KD(a),c,u);return tb(t,o,d)}else return[]}function yD(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(g,y)=>{let E=on(g,i);s=s||ms(y,E),o=o||_s(y)});let a=t.syncPointTree_.get(i);a?(o=o||_s(a),s=s||ms(a,Me())):(a=new Om,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=de.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((y,E)=>{let D=ms(E,Me());D&&(s=s.updateImmediateChild(y,D))}));let u=sL(a,e);if(!u&&!e._queryParams.loadsAllData()){let g=Zm(e);j(!t.queryToTagMap.has(g),"View does not exist, but we have a tag");let y=f8();t.queryToTagMap.set(g,y),t.tagToQueryMap.set(y,g)}let d=Km(t.pendingWriteTree_,i),h=e8(a,e,n,d,s,c);if(!u&&!o&&!r){let g=iL(a,e);h=h.concat(p8(t,e,g))}return h}function Ym(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=on(o,e),u=ms(a,c);if(u)return u});return YF(i,e,s,n,!0)}function u8(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,d)=>{let h=on(u,n);r=r||ms(d,h)});let i=t.syncPointTree_.get(n);i?r=r||ms(i,Me()):(i=new Om,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Br(r,!0,!1):null,a=Km(t.pendingWriteTree_,e._path),c=nL(i,e,a,s?o.getNode():de.EMPTY_NODE,s);return W6(c)}function Bc(t,e){return aL(e,t.syncPointTree_,null,Km(t.pendingWriteTree_,Me()))}function aL(t,e,n,r){if(ve(t.path))return cL(t,e,n,r);{let i=e.get(Me());n==null&&i!=null&&(n=ms(i,Me()));let s=[],o=ye(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,d=ZF(r,o);s=s.concat(aL(a,c,u,d))}return i&&(s=s.concat(ZD(i,t,r,n))),s}}function cL(t,e,n,r){let i=e.get(Me());n==null&&i!=null&&(n=ms(i,Me()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=ZF(r,o),d=t.operationForChild(o);d&&(s=s.concat(cL(d,a,c,u)))}),i&&(s=s.concat(ZD(i,t,r,n))),s}function lL(t,e){let n=e.query,r=Nd(t,n);return{hashFn:()=>(z6(e)||de.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?c8(t,n._path,r):a8(t,n._path);{let s=D5(i,n);return Vm(t,n,null,s)}}}}function Nd(t,e){let n=Zm(e);return t.queryToTagMap.get(n)}function Zm(t){return t._path.toString()+"$"+t._queryIdentifier}function XD(t,e){return t.tagToQueryMap.get(e)}function eb(t){let e=t.indexOf("$");return j(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Ne(t.substr(0,e))}}function tb(t,e,n){let r=t.syncPointTree_.get(e);j(r,"Missing sync point for query tag that we're tracking");let i=Km(t.pendingWriteTree_,e);return ZD(r,n,i,null)}function d8(t){return t.fold((e,n,r)=>{if(n&&_s(n))return[Qm(n)];{let i=[];return n&&(i=rL(n)),Rt(r,(s,o)=>{i=i.concat(o)}),i}})}function Id(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(r8())(t._repo,t._path):t}function h8(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=Zm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function f8(){return i8++}function p8(t,e,n){let r=e._path,i=Nd(t,e),s=lL(t,n),o=t.listenProvider_.startListening(Id(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)j(!_s(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,d,h)=>{if(!ve(u)&&d&&_s(d))return[Qm(d).query];{let g=[];return d&&(g=g.concat(rL(d).map(y=>y.query))),Rt(h,(y,E)=>{g=g.concat(E)}),g}});for(let u=0;u<c.length;++u){let d=c[u];t.listenProvider_.stopListening(Id(d),Nd(t,d))}}return o}var vD=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},_D=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Ze(this.path_,e);return new t(this.syncTree_,n)}node(){return Ym(this.syncTree_,this.path_)}},g8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},fF=function(t,e,n){if(!t||typeof t!="object")return t;if(j(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return m8(t[".sv"],e,n);if(typeof t[".sv"]=="object")return y8(t[".sv"],e);j(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},m8=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:j(!1,"Unexpected server value: "+t)}},y8=function(t,e,n){t.hasOwnProperty("increment")||j(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&j(!1,"Unexpected increment value: "+r);let i=e.node();if(j(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},uL=function(t,e,n,r){return rb(e,new _D(n,t),r)},nb=function(t,e,n){return rb(t,new vD(e),n)};function rb(t,e,n){let r=t.getPriority().val(),i=fF(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=fF(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Nc(a,Xe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Nc(i))),o.forEachChild(He,(a,c)=>{let u=rb(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Pd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function Jm(t,e){let n=e instanceof Ne?e:new Ne(e),r=t,i=ye(n);for(;i!==null;){let s=Ii(r.node.children,i)||{children:{},childCount:0};r=new Pd(i,r,s),n=Be(n),i=ye(n)}return r}function Ro(t){return t.node.value}function ib(t,e){t.node.value=e,wD(t)}function dL(t){return t.node.childCount>0}function v8(t){return Ro(t)===void 0&&!dL(t)}function Xm(t,e){Rt(t.node.children,(n,r)=>{e(new Pd(n,t,r))})}function hL(t,e,n,r){n&&!r&&e(t),Xm(t,i=>{hL(i,e,!0,r)}),n&&r&&e(t)}function _8(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Bd(t){return new Ne(t.parent===null?t.name:Bd(t.parent)+"/"+t.name)}function wD(t){t.parent!==null&&w8(t.parent,t.name,t)}function w8(t,e,n){let r=v8(n),i=Mn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,wD(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,wD(t))}var E8=/[\[\].#$\/\u0000-\u001F\u007F]/,I8=/[\[\].#$\u0000-\u001F\u007F]/,MC=10*1024*1024,ey=function(t){return typeof t=="string"&&t.length!==0&&!E8.test(t)},fL=function(t){return typeof t=="string"&&t.length!==0&&!I8.test(t)},C8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),fL(t)},kd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Gm(t)||t&&typeof t=="object"&&Mn(t,".sv")},$r=function(t,e,n,r){r&&e===void 0||$d(ln(t,"value"),e,n)},$d=function(t,e,n){let r=n instanceof Ne?new HC(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Do(r));if(typeof e=="function")throw new Error(t+"contains a function "+Do(r)+" with contents = "+e.toString());if(Gm(e))throw new Error(t+"contains "+e.toString()+" "+Do(r));if(typeof e=="string"&&e.length>MC/3&&dl(e)>MC)throw new Error(t+"contains a string greater than "+MC+" utf8 bytes "+Do(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Rt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!ey(o)))throw new Error(t+" contains an invalid key ("+o+") "+Do(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);X5(r,o),$d(t,a,r),e6(r)}),i&&s)throw new Error(t+' contains ".value" child '+Do(r)+" in addition to actual children.")}},D8=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Dd(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!ey(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(J5);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&$n(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},pL=function(t,e,n,r){if(r&&e===void 0)return;let i=ln(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];Rt(e,(o,a)=>{let c=new Ne(o);if($d(i,a,Ze(n,c)),BD(c)===".priority"&&!kd(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),D8(i,s)},sb=function(t,e,n){if(!(n&&e===void 0)){if(Gm(e))throw new Error(ln(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!kd(e))throw new Error(ln(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},qd=function(t,e,n,r){if(!(r&&n===void 0)&&!ey(n))throw new Error(ln(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},$c=function(t,e,n,r){if(!(r&&n===void 0)&&!fL(n))throw new Error(ln(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},b8=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),$c(t,e,n,r)},Sn=function(t,e){if(ye(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},gL=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!ey(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!C8(n))throw new Error(ln(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var ED=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function ty(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!$D(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function mL(t,e,n){ty(t,n),yL(t,r=>$D(r,e))}function An(t,e,n){ty(t,n),yL(t,r=>$n(r,e)||$n(e,r))}function yL(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(T8(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function T8(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();To&&xt("event: "+n.toString()),jc(r)}}}var vL="repo_interrupt",S8=25,ID=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ED,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Am(),this.transactionQueueTree_=new Pd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function A8(t,e,n){if(t.stats_=UD(t.repoInfo_),t.forceRestClient_||A5())t.server_=new tD(t.repoInfo_,(r,i,s,o)=>{pF(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>gF(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ht(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new qD(t.repoInfo_,e,(r,i,s,o)=>{pF(t,r,i,s,o)},r=>{gF(t,r)},r=>{x8(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=R5(t.repoInfo_,()=>new oD(t.stats_,t.server_)),t.infoData_=new nD,t.infoSyncTree_=new Lm({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=Ud(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),ob(t,"connected",!1),t.serverSyncTree_=new Lm({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);An(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function _L(t){let n=t.infoData_.getNode(new Ne(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Hd(t){return g8({timestamp:_L(t)})}function pF(t,e,n,r,i){t.dataUpdateCount++;let s=new Ne(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=ul(n,u=>Xe(u));o=l8(t.serverSyncTree_,s,c,i)}else{let c=Xe(n);o=oL(t.serverSyncTree_,s,c,i)}else if(r){let c=ul(n,u=>Xe(u));o=o8(t.serverSyncTree_,s,c)}else{let c=Xe(n);o=Ud(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=Lc(t,s)),An(t.eventQueue_,a,o)}function gF(t,e){ob(t,"connected",e),e===!1&&N8(t)}function x8(t,e){Rt(e,(n,r)=>{ob(t,n,r)})}function ob(t,e,n){let r=new Ne("/.info/"+e),i=Xe(n);t.infoData_.updateSnapshot(r,i);let s=Ud(t.infoSyncTree_,r,i);An(t.eventQueue_,r,s)}function ny(t){return t.nextWriteId_++}function R8(t,e,n){let r=u8(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Xe(i).withIndex(e._queryParams.getIndex());yD(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=Ud(t.serverSyncTree_,e._path,s);else{let a=Nd(t.serverSyncTree_,e);o=oL(t.serverSyncTree_,e._path,s,a)}return An(t.eventQueue_,e._path,o),Vm(t.serverSyncTree_,e,n,null,!0),s},i=>(qc(t,"get for query "+ht(e)+" failed: "+i),Promise.reject(new Error(i))))}function ab(t,e,n,r,i){qc(t,"set",{path:e.toString(),value:n,priority:r});let s=Hd(t),o=Xe(n,r),a=Ym(t.serverSyncTree_,e),c=nb(o,a,s),u=ny(t),d=JD(t.serverSyncTree_,e,c,u,!0);ty(t.eventQueue_,d),t.server_.put(e.toString(),o.val(!0),(g,y)=>{let E=g==="ok";E||Wt("set at "+e+" failed: "+g);let D=ps(t.serverSyncTree_,u,!E);An(t.eventQueue_,e,D),ws(t,i,g,y)});let h=lb(t,e);Lc(t,h),An(t.eventQueue_,h,[])}function M8(t,e,n,r){qc(t,"update",{path:e.toString(),value:n});let i=!0,s=Hd(t),o={};if(Rt(n,(a,c)=>{i=!1,o[a]=uL(Ze(e,a),Xe(c),t.serverSyncTree_,s)}),i)xt("update() called with empty data.  Don't do anything."),ws(t,r,"ok",void 0);else{let a=ny(t),c=s8(t.serverSyncTree_,e,o,a);ty(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,d)=>{let h=u==="ok";h||Wt("update at "+e+" failed: "+u);let g=ps(t.serverSyncTree_,a,!h),y=g.length>0?Lc(t,e):e;An(t.eventQueue_,y,g),ws(t,r,u,d)}),Rt(n,u=>{let d=lb(t,Ze(e,u));Lc(t,d)}),An(t.eventQueue_,e,[])}}function N8(t){qc(t,"onDisconnectEvents");let e=Hd(t),n=Am();iD(t.onDisconnect_,Me(),(i,s)=>{let o=uL(i,s,t.serverSyncTree_,e);Uc(n,i,o)});let r=[];iD(n,Me(),(i,s)=>{r=r.concat(Ud(t.serverSyncTree_,i,s));let o=lb(t,i);Lc(t,o)}),t.onDisconnect_=Am(),An(t.eventQueue_,Me(),r)}function P8(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&rD(t.onDisconnect_,e),ws(t,n,r,i)})}function mF(t,e,n,r){let i=Xe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Uc(t.onDisconnect_,e,i),ws(t,r,s,o)})}function k8(t,e,n,r,i){let s=Xe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Uc(t.onDisconnect_,e,s),ws(t,i,o,a)})}function O8(t,e,n,r){if(mh(n)){xt("onDisconnect().update() called with empty data.  Don't do anything."),ws(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&Rt(n,(o,a)=>{let c=Xe(a);Uc(t.onDisconnect_,Ze(e,o),c)}),ws(t,r,i,s)})}function F8(t,e,n){let r;ye(e._path)===".info"?r=yD(t.infoSyncTree_,e,n):r=yD(t.serverSyncTree_,e,n),mL(t.eventQueue_,e._path,r)}function CD(t,e,n){let r;ye(e._path)===".info"?r=Vm(t.infoSyncTree_,e,n):r=Vm(t.serverSyncTree_,e,n),mL(t.eventQueue_,e._path,r)}function wL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(vL)}function L8(t){t.persistentConnection_&&t.persistentConnection_.resume(vL)}function qc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),xt(n,...e)}function ws(t,e,n,r){e&&jc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function V8(t,e,n,r,i,s){qc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:_F(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=cb(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{$d("transaction failed: Data returned ",c,o.path),o.status=0;let u=Jm(t.transactionQueueTree_,e),d=Ro(u)||[];d.push(o),ib(u,d);let h;typeof c=="object"&&c!==null&&Mn(c,".priority")?(h=Ii(c,".priority"),j(kd(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Ym(t.serverSyncTree_,e)||de.EMPTY_NODE).getPriority().val();let g=Hd(t),y=Xe(c,h),E=nb(y,a,g);o.currentOutputSnapshotRaw=y,o.currentOutputSnapshotResolved=E,o.currentWriteId=ny(t);let D=JD(t.serverSyncTree_,e,E,o.currentWriteId,o.applyLocally);An(t.eventQueue_,e,D),ry(t,t.transactionQueueTree_)}}function cb(t,e,n){return Ym(t.serverSyncTree_,e,n)||de.EMPTY_NODE}function ry(t,e=t.transactionQueueTree_){if(e||iy(t,e),Ro(e)){let n=IL(t,e);j(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&j8(t,Bd(e),n)}else dL(e)&&Xm(e,n=>{ry(t,n)})}function j8(t,e,n){let r=n.map(u=>u.currentWriteId),i=cb(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let d=n[u];j(d.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;let h=on(e,d.path);s=s.updateChild(h,d.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{qc(t,"transaction put response",{path:c.toString(),status:u});let d=[];if(u==="ok"){let h=[];for(let g=0;g<n.length;g++)n[g].status=2,d=d.concat(ps(t.serverSyncTree_,n[g].currentWriteId)),n[g].onComplete&&h.push(()=>n[g].onComplete(null,!0,n[g].currentOutputSnapshotResolved)),n[g].unwatcher();iy(t,Jm(t.transactionQueueTree_,e)),ry(t,t.transactionQueueTree_),An(t.eventQueue_,e,d);for(let g=0;g<h.length;g++)jc(h[g])}else{if(u==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{Wt("transaction at "+c.toString()+" failed: "+u);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=u}Lc(t,e)}},o)}function Lc(t,e){let n=EL(t,e),r=Bd(n),i=IL(t,n);return U8(t,i,r),r}function U8(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=on(n,c.path),d=!1,h;if(j(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)d=!0,h=c.abortReason,i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=S8)d=!0,h="maxretry",i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0));else{let g=cb(t,c.path,o);c.currentInputSnapshot=g;let y=e[a].update(g.val());if(y!==void 0){$d("transaction failed: Data returned ",y,c.path);let E=Xe(y);typeof y=="object"&&y!=null&&Mn(y,".priority")||(E=E.updatePriority(g.getPriority()));let S=c.currentWriteId,k=Hd(t),q=nb(E,g,k);c.currentOutputSnapshotRaw=E,c.currentOutputSnapshotResolved=q,c.currentWriteId=ny(t),o.splice(o.indexOf(S),1),i=i.concat(JD(t.serverSyncTree_,c.path,q,c.currentWriteId,c.applyLocally)),i=i.concat(ps(t.serverSyncTree_,S,!0))}else d=!0,h="nodata",i=i.concat(ps(t.serverSyncTree_,c.currentWriteId,!0))}An(t.eventQueue_,n,i),i=[],d&&(e[a].status=2,function(g){setTimeout(g,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(h),!1,null))))}iy(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)jc(r[a]);ry(t,t.transactionQueueTree_)}function EL(t,e){let n,r=t.transactionQueueTree_;for(n=ye(e);n!==null&&Ro(r)===void 0;)r=Jm(r,n),e=Be(e),n=ye(e);return r}function IL(t,e){let n=[];return CL(t,e,n),n.sort((r,i)=>r.order-i.order),n}function CL(t,e,n){let r=Ro(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);Xm(e,i=>{CL(t,i,n)})}function iy(t,e){let n=Ro(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,ib(e,n.length>0?n:void 0)}Xm(e,r=>{iy(t,r)})}function lb(t,e){let n=Bd(EL(t,e)),r=Jm(t.transactionQueueTree_,e);return _8(r,i=>{NC(t,i)}),NC(t,r),hL(r,i=>{NC(t,i)}),n}function NC(t,e){let n=Ro(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(j(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(j(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(ps(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?ib(e,void 0):n.length=s+1,An(t.eventQueue_,Bd(e),i);for(let o=0;o<r.length;o++)jc(r[o])}}function B8(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function $8(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Wt(`Invalid query segment '${n}' in query '${t}'`)}return e}var DD=function(t,e){let n=q8(t),r=n.namespace;n.domain==="firebase.com"&&Ur(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Ur("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||_5();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new wm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new Ne(n.pathString)}},q8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let d=t.indexOf("/");d===-1&&(d=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(d,h)),d<h&&(i=B8(t.substring(d,h)));let g=$8(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let y=e.slice(0,u);if(y.toLowerCase()==="localhost")n="localhost";else if(y.split(".").length<=2)n=y;else{let E=e.indexOf(".");r=e.substring(0,E).toLowerCase(),n=e.substring(E+1),s=r}"ns"in g&&(s=g.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var yF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",H8=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=yF.charAt(n%64),n=Math.floor(n/64);j(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=yF.charAt(e[i]);return j(o.length===20,"nextPushId: Length should be 20."),o}}();var jm=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ht(this.snapshot.exportVal())}},Um=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Od=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return j(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Bm=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new It;return P8(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){Sn("OnDisconnect.remove",this._path);let e=new It;return mF(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){Sn("OnDisconnect.set",this._path),$r("OnDisconnect.set",e,this._path,!1);let n=new It;return mF(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){Sn("OnDisconnect.setWithPriority",this._path),$r("OnDisconnect.setWithPriority",e,this._path,!1),sb("OnDisconnect.setWithPriority",n,!1);let r=new It;return k8(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){Sn("OnDisconnect.update",this._path),pL("OnDisconnect.update",e,this._path,!1);let n=new It;return O8(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var cn=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ve(this._path)?null:BD(this._path)}get ref(){return new xn(this._repo,this._path)}get _queryIdentifier(){let e=rF(this._queryParams),n=jD(e);return n==="{}"?"default":n}get _queryObject(){return rF(this._queryParams)}isEqual(e){if(e=Ee(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=$D(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Z5(this._path)}};function sy(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Is(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===jr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ys)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==mi)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===He){if(e!=null&&!kd(e)||n!=null&&!kd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(j(t.getIndex()instanceof bd||t.getIndex()===GD,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function oy(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var xn=class t extends cn{constructor(e,n){super(e,n,new xd,!1)}get parent(){let e=UF(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},Vc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new Ne(e),r=Es(this.ref,e);return new t(this._node.getChild(n),r,He)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Es(this.ref,r),He)))}hasChild(e){let n=new Ne(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function ub(t,e){return t=Ee(t),t._checkNotDeleted("ref"),e!==void 0?Es(t._root,e):t._root}function db(t,e){t=Ee(t),t._checkNotDeleted("refFromURL");let n=DD(e,t._repo.repoInfo_.nodeAdmin);gL("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Ur("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),ub(t,n.path.toString())}function Es(t,e){return t=Ee(t),ye(t._path)===null?b8("child","path",e,!1):$c("child","path",e,!1),new xn(t._repo,Ze(t._path,e))}function DL(t,e){t=Ee(t),Sn("push",t._path),$r("push",e,t._path,!0);let n=_L(t._repo),r=H8(n),i=Es(t,r),s=Es(t,r),o;return e!=null?o=ay(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function bL(t){return Sn("remove",t._path),ay(t,null)}function ay(t,e){t=Ee(t),Sn("set",t._path),$r("set",e,t._path,!1);let n=new It;return ab(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function TL(t,e){t=Ee(t),Sn("setPriority",t._path),sb("setPriority",e,!1);let n=new It;return ab(t._repo,Ze(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function SL(t,e,n){if(Sn("setWithPriority",t._path),$r("setWithPriority",e,t._path,!1),sb("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new It;return ab(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function AL(t,e){pL("update",e,t._path,!1);let n=new It;return M8(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function xL(t){t=Ee(t);let e=new Od(()=>{}),n=new Fd(e);return R8(t._repo,t,n).then(r=>new Vc(r,new xn(t._repo,t._path),t._queryParams.getIndex()))}var Fd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new jm("value",this,new Vc(e.snapshotNode,new xn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Um(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},$m=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new Um(this,e,n):null}createEvent(e,n){j(e.childName!=null,"Child events should have a childName.");let r=Es(new xn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new jm(e.type,this,new Vc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function Gd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(d,h)=>{CD(t._repo,t,a),c(d,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new Od(n,s||void 0),a=e==="value"?new Fd(o):new $m(e,o);return F8(t._repo,t,a),()=>CD(t._repo,t,a)}function cy(t,e,n,r){return Gd(t,"value",e,n,r)}function hb(t,e,n,r){return Gd(t,"child_added",e,n,r)}function fb(t,e,n,r){return Gd(t,"child_changed",e,n,r)}function pb(t,e,n,r){return Gd(t,"child_moved",e,n,r)}function gb(t,e,n,r){return Gd(t,"child_removed",e,n,r)}function mb(t,e,n){let r=null,i=n?new Od(n):null;e==="value"?r=new Fd(i):e&&(r=new $m(e,i)),CD(t._repo,t,r)}var Rn=class{},qm=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){$r("endAt",this._value,e._path,!0);let n=eD(e._queryParams,this._value,this._key);if(oy(n),Is(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new cn(e._repo,e._path,n,e._orderByCalled)}};function RL(t,e){return qd("endAt","key",e,!0),new qm(t,e)}var bD=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){$r("endBefore",this._value,e._path,!1);let n=m6(e._queryParams,this._value,this._key);if(oy(n),Is(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new cn(e._repo,e._path,n,e._orderByCalled)}};function ML(t,e){return qd("endBefore","key",e,!0),new bD(t,e)}var Hm=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){$r("startAt",this._value,e._path,!0);let n=XC(e._queryParams,this._value,this._key);if(oy(n),Is(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new cn(e._repo,e._path,n,e._orderByCalled)}};function NL(t=null,e){return qd("startAt","key",e,!0),new Hm(t,e)}var TD=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){$r("startAfter",this._value,e._path,!1);let n=g6(e._queryParams,this._value,this._key);if(oy(n),Is(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new cn(e._repo,e._path,n,e._orderByCalled)}};function PL(t,e){return qd("startAfter","key",e,!0),new TD(t,e)}var SD=class extends Rn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new cn(e._repo,e._path,f6(e._queryParams,this._limit),e._orderByCalled)}};function kL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new SD(t)}var AD=class extends Rn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new cn(e._repo,e._path,p6(e._queryParams,this._limit),e._orderByCalled)}};function OL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new AD(t)}var xD=class extends Rn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){sy(e,"orderByChild");let n=new Ne(this._path);if(ve(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new bd(n),i=zm(e._queryParams,r);return Is(i),new cn(e._repo,e._path,i,!0)}};function FL(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $c("orderByChild","path",t,!1),new xD(t)}var RD=class extends Rn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){sy(e,"orderByKey");let n=zm(e._queryParams,jr);return Is(n),new cn(e._repo,e._path,n,!0)}};function LL(){return new RD}var MD=class extends Rn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){sy(e,"orderByPriority");let n=zm(e._queryParams,He);return Is(n),new cn(e._repo,e._path,n,!0)}};function VL(){return new MD}var ND=class extends Rn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){sy(e,"orderByValue");let n=zm(e._queryParams,GD);return Is(n),new cn(e._repo,e._path,n,!0)}};function jL(){return new ND}var PD=class extends Rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if($r("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new qm(this._value,this._key)._apply(new Hm(this._value,this._key)._apply(e))}};function UL(t,e){return qd("equalTo","key",e,!0),new PD(t,e)}function Hn(t,...e){let n=Ee(t);for(let r of e)n=r._apply(n);return n}Z6(xn);n8(xn);var G8="FIREBASE_DATABASE_EMULATOR_HOST",kD={},z8=!1;function W8(t,e,n,r){t.repoInfo_=new wm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function yb(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Ur("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),xt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=DD(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[G8]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=DD(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let d=i&&c?new _d(_d.OWNER):new VC(t.name,t.options,e);gL("Invalid Firebase Database URL",o),ve(o.path)||Ur("Database URL must point to the root of a Firebase Database (not including a child path).");let h=Q8(a,t,d,new LC(t.name,n));return new OD(h,t)}function K8(t,e){let n=kD[e];(!n||n[t.key]!==t)&&Ur(`Database ${e}(${t.repoInfo_}) has already been deleted.`),wL(t),delete n[t.key]}function Q8(t,e,n,r){let i=kD[e.name];i||(i={},kD[e.name]=i);let s=i[t.toURLString()];return s&&Ur("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new ID(t,z8,n,r),i[t.toURLString()]=s,s}var OD=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(A8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new xn(this._repo,Me())),this._rootInternal}_delete(){return this._rootInternal!==null&&(K8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Ur("Cannot call "+e+" on a deleted database.")}};function BL(){jF.IS_TRANSPORT_INITIALIZED&&Wt("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function $L(){BL(),Cd.forceDisallow()}function qL(){BL(),Ac.forceDisallow(),Cd.forceAllow()}function HL(t,e,n,r={}){t=Ee(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Ur("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Ur('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new _d(_d.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:fh(r.mockUserToken,t.app.options.projectId);s=new _d(o)}W8(i,e,n,s)}function GL(t){t=Ee(t),t._checkNotDeleted("goOffline"),wL(t._repo)}function zL(t){t=Ee(t),t._checkNotDeleted("goOnline"),L8(t._repo)}function WL(t,e){EF(t,e)}function Y8(t){VD(vh),Ss(new pn("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return yb(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),zn(UO,BO,t),zn(UO,BO,"esm2017")}var Z8={".sv":"timestamp"};function KL(){return Z8}function QL(t){return{".sv":{increment:t}}}var FD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function YL(t,e,n){var r;if(t=Ee(t),Sn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new It,o=(c,u,d)=>{let h=null;c?s.reject(c):(h=new Vc(d,new xn(t._repo,t._path),He),s.resolve(new FD(u,h)))},a=cy(t,()=>{});return V8(t._repo,t._path,e,o,a,i),s.promise}qD.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};qD.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Y8();var J8="@firebase/database-compat",X8="1.0.5";var eW=new Ci("@firebase/database-compat"),ZL=function(t){let e="FIREBASE WARNING: "+t;eW.warn(e)};var tW=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(ln(t,e)+"must be a boolean.")},nW=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ln(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var vb=class{constructor(e){this._delegate=e}cancel(e){se("OnDisconnect.cancel",0,1,arguments.length),_t("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){se("OnDisconnect.remove",0,1,arguments.length),_t("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){se("OnDisconnect.set",1,2,arguments.length),_t("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){se("OnDisconnect.setWithPriority",2,3,arguments.length),_t("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(se("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZL("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var _b=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return se("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var Mo=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return se("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return se("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return se("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return se("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return se("DataSnapshot.child",0,1,arguments.length),e=String(e),$c("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return se("DataSnapshot.hasChild",1,1,arguments.length),$c("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return se("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return se("DataSnapshot.forEach",1,1,arguments.length),_t("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return se("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return se("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return se("DataSnapshot.ref",0,0,arguments.length),new yi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},ly=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;se("Query.on",2,4,arguments.length),_t("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,d)=>{n.call(o.context,new Mo(this.database,u),d)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return cy(this._delegate,a,c),n;case"child_added":return hb(this._delegate,a,c),n;case"child_removed":return gb(this._delegate,a,c),n;case"child_changed":return fb(this._delegate,a,c),n;case"child_moved":return pb(this._delegate,a,c),n;default:throw new Error(ln("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(se("Query.off",0,3,arguments.length),nW("Query.off",e,!0),_t("Query.off","callback",n,!0),jy("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,mb(this._delegate,e,i)}else mb(this._delegate,e)}get(){return xL(this._delegate).then(e=>new Mo(this.database,e))}once(e,n,r,i){se("Query.once",1,4,arguments.length),_t("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new It,a=(u,d)=>{let h=new Mo(this.database,u);n&&n.call(s.context,h,d),o.resolve(h)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":cy(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":hb(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":gb(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":fb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":pb(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(ln("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return se("Query.limitToFirst",1,1,arguments.length),new t(this.database,Hn(this._delegate,kL(e)))}limitToLast(e){return se("Query.limitToLast",1,1,arguments.length),new t(this.database,Hn(this._delegate,OL(e)))}orderByChild(e){return se("Query.orderByChild",1,1,arguments.length),new t(this.database,Hn(this._delegate,FL(e)))}orderByKey(){return se("Query.orderByKey",0,0,arguments.length),new t(this.database,Hn(this._delegate,LL()))}orderByPriority(){return se("Query.orderByPriority",0,0,arguments.length),new t(this.database,Hn(this._delegate,VL()))}orderByValue(){return se("Query.orderByValue",0,0,arguments.length),new t(this.database,Hn(this._delegate,jL()))}startAt(e=null,n){return se("Query.startAt",0,2,arguments.length),new t(this.database,Hn(this._delegate,NL(e,n)))}startAfter(e=null,n){return se("Query.startAfter",0,2,arguments.length),new t(this.database,Hn(this._delegate,PL(e,n)))}endAt(e=null,n){return se("Query.endAt",0,2,arguments.length),new t(this.database,Hn(this._delegate,RL(e,n)))}endBefore(e=null,n){return se("Query.endBefore",0,2,arguments.length),new t(this.database,Hn(this._delegate,ML(e,n)))}equalTo(e,n){return se("Query.equalTo",1,2,arguments.length),new t(this.database,Hn(this._delegate,UL(e,n)))}toString(){return se("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return se("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(se("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,_t(e,"cancel",i.cancel,!0),i.context=r,jy(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(ln(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new yi(this.database,new xn(this._delegate._repo,this._delegate._path))}},yi=class t extends ly{constructor(e,n){super(e,new cn(n._repo,n._path,new xd,!1)),this.database=e,this._delegate=n}getKey(){return se("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return se("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Es(this._delegate,e))}getParent(){se("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return se("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){se("Reference.set",1,2,arguments.length),_t("Reference.set","onComplete",n,!0);let r=ay(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(se("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,ZL("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Sn("Reference.update",this._delegate._path),_t("Reference.update","onComplete",n,!0);let r=AL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){se("Reference.setWithPriority",2,3,arguments.length),_t("Reference.setWithPriority","onComplete",r,!0);let i=SL(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){se("Reference.remove",0,1,arguments.length),_t("Reference.remove","onComplete",e,!0);let n=bL(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){se("Reference.transaction",1,3,arguments.length),_t("Reference.transaction","transactionUpdate",e,!1),_t("Reference.transaction","onComplete",n,!0),tW("Reference.transaction","applyLocally",r,!0);let i=YL(this._delegate,e,{applyLocally:r}).then(s=>new _b(s.committed,new Mo(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){se("Reference.setPriority",1,2,arguments.length),_t("Reference.setPriority","onComplete",n,!0);let r=TL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){se("Reference.push",0,2,arguments.length),_t("Reference.push","onComplete",n,!0);let r=DL(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return Sn("Reference.onDisconnect",this._delegate._path),new vb(new Bm(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var No=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:$L,forceLongPolling:qL}}useEmulator(e,n,r={}){HL(this._delegate,e,n,r)}ref(e){if(se("database.ref",0,1,arguments.length),e instanceof yi){let n=db(this._delegate,e.toString());return new yi(this,n)}else{let n=ub(this._delegate,e);return new yi(this,n)}}refFromURL(e){se("database.refFromURL",1,1,arguments.length);let r=db(this._delegate,e);return new yi(this,r)}goOffline(){return se("database.goOffline",0,0,arguments.length),GL(this._delegate)}goOnline(){return se("database.goOnline",0,0,arguments.length),zL(this._delegate)}};No.ServerValue={TIMESTAMP:KL(),increment:t=>QL(t)};function rW({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){VD(n);let a=new Uy("database-standalone"),c=new yh("auth-internal",a);c.setComponent(new pn("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new yh("app-check-internal",a),u.setComponent(new pn("app-check-internal",()=>i,"PRIVATE"))),{instance:new No(yb(t,c,u,e,o),t),namespace:s}}var iW=Object.freeze({__proto__:null,initStandalone:rW});var sW=No.ServerValue;function oW(t){t.INTERNAL.registerComponent(new pn("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new No(i,r)},"PUBLIC").setServiceProps({Reference:yi,Query:ly,Database:No,DataSnapshot:Mo,enableLogging:WL,INTERNAL:iW,ServerValue:sW}).setMultipleInstances(!0)),t.registerVersion(J8,X8)}oW(Ct);function zd(t,e,n="on",r=Ns){return new pe(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(J(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),yl())}function aW(t){return typeof t=="string"}function cW(t){return typeof t.exportVal=="function"}function nV(t){return t==null}function rV(t){return typeof t.set=="function"}function JL(t,e){return rV(e)?e:t.ref(e)}function iV(t,e){if(aW(t))return e.stringCase();if(rV(t))return e.firebaseCase();if(cW(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function sV(t){return(nV(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function oV(t,e,n){e=sV(e);let r=e.map(i=>zd(t,i,"on",n));return Yo(...r)}function lW(t,e,n){let r=oV(t,e).pipe(hr((i,s)=>[...i,s],[]));return dW(t,r,n)}function uW(t,e){return zd(t,"value","on",e).pipe(J(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function dW(t,e,n){return uW(t,n).pipe(cv(e),J(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),av(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),J(i=>i.actions))}function XL(t,e){return function(r,i){return iV(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function hW(t){return function(n){return n?iV(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function fW(t,e,n){return zd(t,"value","once",n).pipe(ze(r=>{let i=[ee(r)];return e.forEach(s=>i.push(zd(t,s,"on",n))),Yo(...i).pipe(hr(gW,[]))}),gl())}function aV(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function pW(t,e){if(nV(e))return 0;{let n=aV(t,e);return n===-1?t.length:n+1}}function gW(t,e){let{payload:n,prevKey:r,key:i}=e,s=aV(t,i),o=pW(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function eV(t,e,n){return e=sV(e),fW(t,e,n)}function mW(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:XL(r,"update"),set:XL(r,"set"),push:i=>r.push(i),remove:hW(r),snapshotChanges(i){return eV(t,i,n).pipe(ct)},stateChanges(i){return oV(t,i,n).pipe(ct)},auditTrail(i){return lW(t,i,n).pipe(ct)},valueChanges(i,s){return eV(t,i,n).pipe(J(a=>a.map(c=>s&&s.idField?xe(B({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),ct)}}}function tV(t,e){return function(){return zd(t,"value","on",e)}}function yW(t,e){return{query:t,snapshotChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(ct)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return tV(t,e.schedulers.outsideAngular)().pipe(ct,J(r=>r.payload.exists()?r.payload.val():null))}}}var vW=new W("angularfire2.realtimeDatabaseURL"),_W=new W("angularfire2.database.use-emulator"),wW=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,d,h,g,y,E,D,S){this.schedulers=a;let k=c,q=Ys(n,o,r);u&&bu(q,o,d,g,y,E,h,D),this.database=ja(`${q.name}.database.${i}`,"AngularFireDatabase",q.name,()=>{let F=o.runOutsideAngular(()=>q.database(i||void 0));return k&&F.useEmulator(...k),F},[k])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>JL(this.database,n)),s=i;return r&&(s=r(i)),mW(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>JL(this.database,n));return yW(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(L(zi),L(Wi,8),L(vW,8),L(st),L(be),L(Va),L(_W,8),L(Kp,8),L(_u,8),L(wu,8),L(Eu,8),L(Iu,8),L(Cu,8),L(Du,8),L(si,8))};static \u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),cV=(()=>{class t{constructor(){Ct.registerVersion("angularfire",Hi.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=en({type:t});static \u0275inj=Xt({providers:[wW]})}return t})();var lV={providers:[BM(jO),eM(),g_([ZN.initializeApp(La.firebase),cV,kO])]};var uV=()=>["/"],Wd=t=>({"font-bold":t}),EW=()=>["/about"],IW=()=>["/work"],CW=()=>["/contact"],dV=(()=>{let e=class e{constructor(r,i,s){this.document=r,this.platformId=i,this.router=s,this.$unsubscribe=new Ke,this.activeRoute="",this.isBrowser=!1}ngOnInit(){this.isBrowser=uw(this.platformId),this.router.events.pipe(Xo(this.$unsubscribe),$e(r=>this.activeRoute=r?.url),$e(()=>{let r=this.document.querySelector(".navigation-menu"),i=this.document.querySelector(".mobile-menu-cross"),s=this.document.querySelector(".mobile-menu-button");r?.classList.add("hidden"),i?.classList.add("hidden"),s?.classList.remove("hidden")}),$e(()=>{this.isBrowser&&window.scrollTo(0,0)})).subscribe()}toggleNav(){let r=this.document.querySelector(".mobile-menu-cross"),i=this.document.querySelector(".mobile-menu-button"),s=this.document.querySelector(".navigation-menu");i?.classList.toggle("hidden"),s?.classList.toggle("hidden"),r?.classList.toggle("hidden")}ngOnDestroy(){this.$unsubscribe.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)(me(Ft),me(st),me(Dn))},e.\u0275cmp=qt({type:e,selectors:[["app-navbar"]],standalone:!0,features:[Ht],decls:28,vars:25,consts:[[1,"bg-[#fff]","z-[30]","px-3","p-3","text-gray-700","border-b","sticky","top-0"],[1,"container","mx-auto","px-4","md:flex","md:","justify-between","items-center","gap-6"],[1,"flex","items-center","justify-between","md:w-auto","w-full"],["href","javascript:void(0)",1,"flex","items-center","py-5","px-2","text-gray-700","flex-1",3,"routerLink"],[1,"font-semibold","text-xl","lg:text-2xl"],[1,"text-orange-600"],[1,"md:hidden","flex","items-center"],[3,"click"],[1,"mobile-menu-button"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24"],["fill","none"],["d","M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25H12","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],[1,"mobile-menu-cross","hidden"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 50 50","width","23","height","23"],["d","M 7.71875 6.28125 L 6.28125 7.71875 L 23.5625 25 L 6.28125 42.28125 L 7.71875 43.71875 L 25 26.4375 L 42.28125 43.71875 L 43.71875 42.28125 L 26.4375 25 L 43.71875 7.71875 L 42.28125 6.28125 L 25 23.5625 Z"],[1,"hidden","md:flex","md:flex-row","flex-col","items-start","justify-center","md:space-x-1","navigation-menu","pb-3","md:pb-0","navigation-menu"],["href","javascript:void(0)",1,"py-2","px-3","block","hover:text-gray-500",3,"routerLink","ngClass"],["href","https://thedeepend.vercel.app","target","_blank",1,"py-2","px-3","block","hover:text-gray-500",3,"ngClass"]],template:function(i,s){i&1&&(V(0,"nav",0)(1,"div",1)(2,"div",2)(3,"a",3)(4,"span",4)(5,"span",5),Q(6,"Stranger."),$(),Q(7," Mushwana"),$()(),V(8,"div",6)(9,"button",7),Cr("click",function(){return s.toggleNav()}),V(10,"div",8),_r(),V(11,"svg",9)(12,"g",10),ke(13,"path",11),$()()(),wr(),V(14,"div",12),_r(),V(15,"svg",13),ke(16,"path",14),$()()()()(),wr(),V(17,"div",15)(18,"a",16),Q(19,"Home"),$(),V(20,"a",16),Q(21,"About"),$(),V(22,"a",16),Q(23,"Work"),$(),V(24,"a",17),Q(25,"Blog"),$(),V(26,"a",16),Q(27,"Contact"),$()()()()),i&2&&(wt(3),ot("routerLink",Dr(10,uV)),wt(15),ot("routerLink",Dr(11,uV))("ngClass",_a(12,Wd,s.activeRoute==="/")),wt(2),ot("routerLink",Dr(14,EW))("ngClass",_a(15,Wd,s.activeRoute==="/about")),wt(2),ot("routerLink",Dr(17,IW))("ngClass",_a(18,Wd,s.activeRoute==="/work")),wt(2),ot("ngClass",_a(20,Wd,s.activeRoute==="/blog")),wt(2),ot("routerLink",Dr(22,CW))("ngClass",_a(23,Wd,s.activeRoute==="/contact")))},dependencies:[Pa,Na,ri,NR]});let t=e;return t})();var hV=(()=>{let e=class e{constructor(r){this.router=r}};e.\u0275fac=function(i){return new(i||e)(me(Dn))},e.\u0275cmp=qt({type:e,selectors:[["app-root"]],standalone:!0,features:[Ht],decls:11,vars:0,consts:[[1,"bg-gray-600"],[1,"flex","flex-col","justify-end","text-white","py-3","space-y-1","md:flex-row","md:space-y-0","md:space-x-2"],[1,"flex","items-center","mx-auto","space-x-4"],["href","https://github.com/strangermushwana","target","_blank"],["src","../../assets/github.svg","alt","Github link",1,"w-8","cursor-pointer"],["href","https://www.linkedin.com/in/strangermushwana","target","_blank"],["src","../../assets/linkedin.svg","alt","LinkedIn link",1,"w-8","cursor-pointer"],["href","https://www.credly.com/users/stranger/badges","target","_blank"],["src","../../assets/credly.svg","alt","Twitter link",1,"w-8","cursor-pointer"]],template:function(i,s){i&1&&(V(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),ke(4,"img",4),$(),V(5,"a",5),ke(6,"img",6),$(),V(7,"a",7),ke(8,"img",8),$()()()(),ke(9,"app-navbar")(10,"router-outlet"))},dependencies:[Xw,ri,dV]});let t=e;return t})();JR(hV,lV).catch(t=>console.error(t));
